/************************************************************************************************
 * 專案名稱：twbobibobi
 * 檔案名稱：LightDAC.cs
 * 類別說明：處理「點燈」相關資料存取作業（建立、查詢、更新、刪除）
 * 建立日期：2025-11-14
 * 建立人員：Rooney
 * 修改記錄：2025-11-14 全面改用 DatabaseAdapter.ExecuteSql / ExecuteScalar，移除 Fill + Update；依新版 DatabaseAdapter 重構，加入錯誤記錄與分區結構
 * 目前維護人員：Rooney
 ************************************************************************************************/

using Read.data;
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Linq;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;
using System.Text.RegularExpressions;
using Temple.data;
using Temple.FET.APITEST;
using Temple.Temples;
using twbobibobi.Data;
using twbobibobi.Helpers;
using twbobibobi.Model;
using ZXing;

namespace twbobibobi.Data
{
    /// <summary>
    /// LightDAC： 負責處理「宮廟服務」相關資料存取作業。包含建立、查詢、更新與刪除等資料庫操作。
    /// </summary>
    public class LightDAC : SqlClientBase
    {
        private static object _thisLock = new object();

        /// <summary>
        /// 建構子：初始化資料庫連線來源。
        /// </summary>
        /// <param name="basePage">BasePage 實例（含 DBSource）。</param>
        public LightDAC(BasePage basePage) : base(basePage) { }


        //==================================================
        #region 共用(Common)
        //==================================================

        /// <summary>
        /// 將整數 num 轉成 4 碼字串：1 → "0001"， 12 → "0012"， 123 → "0123"， 1234 → "1234"（本方法由使用者提供）
        /// </summary>
        public string Num2String(int num)
        {
            string result = string.Empty;
            if (num.ToString().Length == 1)
            {
                result = "000" + num;
            }
            else if (num.ToString().Length == 2)
            {
                result = "00" + num;
            }
            else if (num.ToString().Length == 3)
            {
                result = "0" + num;
            }
            else
            {
                result = num.ToString();
            }
            return result;
        }

        #endregion


        //==================================================
        #region 建立 (Create)
        //==================================================

        /// <summary>
        /// 新增驗證碼 (Add new CAPTCHA code)
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="CodeType">驗證碼方式 0-sms 1-email。</param>
        /// <param name="Code">驗證碼。</param>
        /// <param name="AppMobile">購買人電話。</param>
        /// <param name="Year">資料年份。</param>
        /// <returns>新增成功回傳 true，否則 false。</returns>
        public bool AddCAPTCHACode(
            int ApplicantID, 
            int AdminID, 
            int Kind,
            int CodeType,
            string Code, 
            string AppMobile, 
            string Year)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                    INSERT INTO Temple_{Year}..CAPTCHACode
                    (ApplicantID, AdminID, Kind, CodeType, Code, AppMobile, ExpirationDate, ExpirationDateString, Status, CreateDate, CreateDateString)
                    VALUES (@ApplicantID, @AdminID, @Kind, @CodeType, @Code, @AppMobile, @ExpirationDate, @ExpirationDateString, @Status, @CreateDate, @CreateDateString);
                    SELECT CAST(SCOPE_IDENTITY() AS INT);";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);
                    adapter.AddParameterToSelectCommand("@CodeType", CodeType);
                    adapter.AddParameterToSelectCommand("@Code", Code);
                    adapter.AddParameterToSelectCommand("@AppMobile", AppMobile);
                    adapter.AddParameterToSelectCommand("@Status", 0); // 0-未使用 1-已使用 -1-錯誤
                    adapter.AddParameterToSelectCommand("@ExpirationDate", dtNow.AddSeconds(180).ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@ExpirationDateString", dtNow.AddSeconds(180).ToString("yyyy-MM-dd"));
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    object id = adapter.ExecuteScalar();
                    if (Convert.ToInt32(id) > 0)
                        result = true;
                }

                return result;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddCAPTCHACode：\r\n" + detailedError);
                throw;
            }
        }

        /// <summary>
        /// 新增發票資料 (Add new invoice detail)
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="InvoiceType">發票類型（0-二聯、1-三聯、2-載具）。</param>
        /// <param name="CarrierCode">載具代碼。</param>
        /// <param name="InvoiceCode">發票號碼。</param>
        /// <param name="InvoiceName">公司統編。</param>
        /// <param name="Year">資料年份。</param>
        /// <returns>回傳新增的自動編號 (Identity)。</returns>
        public int AddInvoiceDetail(
            int ApplicantID, 
            int AdminID, 
            int Kind, 
            int InvoiceType, 
            string CarrierCode, 
            string InvoiceCode, 
            string InvoiceName, 
            string Year)
        {
            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                    INSERT INTO Temple_{Year}..InvoiceDetail
                    (ApplicantID, AdminID, Kind, InvoiceType, CarrierCode, BuyerIdentifier, BuyerName, Status, CreateDate)
                    VALUES (@ApplicantID, @AdminID, @Kind, @InvoiceType, @CarrierCode, @BuyerIdentifier, @BuyerName, @Status, @CreateDate);
                    SELECT CAST(SCOPE_IDENTITY() AS INT);";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);
                    adapter.AddParameterToSelectCommand("@InvoiceType", InvoiceType);
                    adapter.AddParameterToSelectCommand("@CarrierCode", CarrierCode);
                    adapter.AddParameterToSelectCommand("@BuyerIdentifier", InvoiceCode);
                    adapter.AddParameterToSelectCommand("@BuyerName", InvoiceName);
                    adapter.AddParameterToSelectCommand("@Status", 0); // 0-未使用 1-已使用 -1-錯誤
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    object id = adapter.ExecuteScalar();
                    return Convert.ToInt32(id);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddInvoiceDetail：\r\n" + detailedError);
                throw;
            }
        }


        #region 點燈資料建立 (Lights)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立購買人資料 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_da(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_da_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_h(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_h_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_wu(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wu_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_Fu(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fu_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_Luer(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Luer_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_ty(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_Fw(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fw_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_dh(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_dh_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_Hs(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Hs_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_Hs：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_Lk(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Lk_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_ma(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ma_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_jb(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_jb_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_wjsan(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wjsan_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ShippingFee">運費。預設:0</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_ld(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ShippingFee,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ld_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ShippingFee, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ShippingFee, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ShippingFee", ShippingFee);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_wh(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wh_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_wh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_st(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_st_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_bj(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_bj_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_bj：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_sbbt(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_sbbt_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_sbbt：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_bpy(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_bpy_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_bpy：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_ssy(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ssy_Lights
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_ssy：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 祈福人資料建立 (LightsInfo)

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_da(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(3, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_da_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 3); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_h(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(4, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_h_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 4); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_wu(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(6, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_wu_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 6); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_Fu(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(8, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_Fu_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 8); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人/飼主姓名。</param>
        /// <param name="Mobile">祈福人/飼主電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人/飼主信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人/飼主地址部分地址。</param>
        /// <param name="County">祈福人/飼主地址縣市。</param>
        /// <param name="Dist">祈福人/飼主地址區域。</param>
        /// <param name="ZipCode">祈福人/飼主地址郵遞區號。</param>
        /// <param name="Msg">祈福小語。</param>
        /// <param name="PetName">寵物姓名。</param>
        /// <param name="PetType">寵物品種。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_Luer(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Msg,
            string PetName,
            string PetType,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(10, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_Luer_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, Msg, PetName, PetType, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @Msg, @PetName, @PetType, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 10); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Msg", Msg);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(14, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人/飼主姓名。</param>
        /// <param name="Mobile">祈福人/飼主電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人/飼主信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人/飼主地址部分地址。</param>
        /// <param name="County">祈福人/飼主地址縣市。</param>
        /// <param name="Dist">祈福人/飼主地址區域。</param>
        /// <param name="ZipCode">祈福人/飼主地址郵遞區號。</param>
        /// <param name="PetName">寵物姓名。</param>
        /// <param name="PetType">寵物品種。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_Fw(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string PetName,
            string PetType,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(15, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_Fw_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, PetName, PetType, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @PetName, @PetType, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 15); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_dh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(16, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_dh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 16); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_Hs(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(17, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_Hs_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 17); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_Hs：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Sendback">贈品處理方式 (是-Y，否-N)。</param>
        /// <param name="rName">收件人姓名。</param>
        /// <param name="rMobile">收件人電話。</param>
        /// <param name="rAddr">收件人地址部分地址。</param>
        /// <param name="rCounty">收件人地址縣市。</param>
        /// <param name="rDist">收件人地址區域。</param>
        /// <param name="rZipCode">收件人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_Lk(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Sendback,
            string rName,
            string rMobile,
            string rAddr,
            string rCounty,
            string rDist,
            string rZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;
                string fullrAddress = rCounty + (rDist == "*" ? "" : rDist) + rAddr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(21, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_Lk_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, 
                        Sendback, rName, rMobile, rAddress, rAddr, rCounty, rdist, rZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, 
                        @Sendback, @rName, @rMobile, @rAddress, @rAddr, @rCounty, @rdist, @rZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 21); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@rName", rName);
                    adapter.AddParameterToSelectCommand("@rMobile", rMobile);
                    adapter.AddParameterToSelectCommand("@rAddress", fullrAddress);
                    adapter.AddParameterToSelectCommand("@rAddr", rAddr);
                    adapter.AddParameterToSelectCommand("@rCounty", rCounty);
                    adapter.AddParameterToSelectCommand("@rdist", rDist);
                    adapter.AddParameterToSelectCommand("@rZipCode", rZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_ma(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(23, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_ma_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 23); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人/飼主姓名。</param>
        /// <param name="Mobile">祈福人/飼主電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人/飼主信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人/飼主地址部分地址。</param>
        /// <param name="County">祈福人/飼主地址縣市。</param>
        /// <param name="Dist">祈福人/飼主地址區域。</param>
        /// <param name="ZipCode">祈福人/飼主地址郵遞區號。</param>
        /// <param name="PetName">寵物姓名。</param>
        /// <param name="PetType">寵物品種。</param>
        /// <param name="PetSex">寵物性別 (M-公，F-母)。</param>
        /// <param name="PetBirth">寵物國曆生日。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_jb(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string PetName,
            string PetType,
            string PetSex,
            string PetBirth,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(29, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_jb_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, PetName, PetType, PetSex, PetBirth, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @PetName, @PetType, @PetSex, @PetBirth, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 29); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@PetSex", PetSex);
                    adapter.AddParameterToSelectCommand("@PetBirth", PetBirth);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_wjsan(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(31, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_wjsan_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 31); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_ld(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(32, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_ld_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 32); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="PetName">寵物姓名。</param>
        /// <param name="PetType">寵物品種。</param>
        /// <param name="PetSex">寵物性別 (M-公，F-母)。</param>
        /// <param name="PetBirth">寵物國曆生日。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_wh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string PetName,
            string PetType,
            string PetSex,
            string PetBirth,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(34, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_wh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, PetName, PetType, PetSex, PetBirth, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @PetName, @PetType, @PetSex, @PetBirth, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 34); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@PetSex", PetSex);
                    adapter.AddParameterToSelectCommand("@PetBirth", PetBirth);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_wh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_st(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(35, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_st_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 35); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_bj(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(38, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_bj_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 38); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_bj：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_sbbt(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(39, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_sbbt_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 39); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_sbbt：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_bpy(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(40, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_bpy_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 40); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_bpy：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_ssy(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(41, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_ssy_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 41); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_ssy：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_da(
            string OrderID, 
            int ApplicantID, 
            int Amount, 
            string ChargeType, 
            int Status, 
            string Description, 
            string Comment, 
            string PayChannelLog, 
            string IP, 
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_da_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_h(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_h_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_wu(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wu_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_Fu(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fu_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_Luer(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Luer_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_Fw(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fw_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_dh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_dh_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_Hs(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Hs_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_Hs：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_Lk(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Lk_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_ma(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ma_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_jb(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_jb_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_wjsan(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wjsan_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_ld(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ld_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_wh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wh_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_wh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_st(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_st_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_bj(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_bj_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_bj：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_sbbt(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_sbbt_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_sbbt：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_bpy(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_bpy_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_bpy：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_ssy(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ssy_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_ssy：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #region 普度資料建立 (Purdue)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立購買人資料 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_da(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_da_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_h(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_h_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_wu(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wu_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_Fu(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fu_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_Luer(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Luer_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_ty(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_Fw(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fw_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_dh(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_dh_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_Lk(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Lk_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);
                    adapter.Update(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_ma(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ma_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 進寶財神廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_jb(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_jb_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_wjsan(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wjsan_Purdue
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address,
                        Sendback, ReceiptName, ReceiptMobile, Email,
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address,
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email,
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 桃園龍德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_ld(
            string Name,
            string Mobile,
            string Cost,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ld_Purdue
                    (
                        Name, Mobile, Cost, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 普度 - 基隆悟玄宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="County">購買人縣市。</param>
        /// <param name="Dist">購買人鄉鎮市區。</param>
        /// <param name="Addr">購買人部分地址。</param>
        /// <param name="ZipCode">購買人郵遞區號。</param>
        /// <param name="Sendback">是否寄回（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態（0=未付款、1=付款中、2=已付款、-2=已退款）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_purdue_wh(
            string Name,
            string Mobile,
            string Cost,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wh_Purdue
                    (
                        Name, Mobile, Cost, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_purdue_wh：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 祈福人資料建立 (PurdueInfo)

        /// <summary>
        /// 建立祈福人資料 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Name2">祈福人姓名2。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Sendback">寄送方式 0-不寄回(會轉送給弱勢團體) 1-寄回(加收運費250元)</param>
        /// <param name="rName">收件人姓名。</param>
        /// <param name="rMobile">收件人電話。</param>
        /// <param name="rAddr">收件人部分地址。</param>
        /// <param name="rCounty">收件人縣市。</param>
        /// <param name="rDist">收件人區域。</param>
        /// <param name="rZipCode">收件人郵遞區號。</param>
        /// <param name="DeathName">亡者姓名。</param>
        /// <param name="Birthday">亡者農曆生日。</param>
        /// <param name="DeathLeapMonth">亡者是否閏月（Y=是、N=否）。</param>
        /// <param name="DeathBirthTime">亡者農曆時辰。</param>
        /// <param name="Deathday">亡者往生日期。</param>
        /// <param name="DeathAge">亡者年齡。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_da(
            int ApplicantID,
            string Name,
            string Name2,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Sendback,
            string rName,
            string rMobile,
            string rAddr,
            string rCounty,
            string rDist,
            string rZipCode,
            string DeathName,
            string Birthday,
            string DeathLeapMonth,
            string DeathBirthTime,
            string Deathday,
            string DeathAge,
            string FirstName,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(3, PurdueType);
                //Cost += Sendback == "1" ? 250 : 0;

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_da_info
                    (
                        ApplicantID, AdminID, Name, Name2, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Remark,
                        Address, Addr, County, dist, ZipCode, Sendback,
                        rName, rMobile, rAddress, rAddr, rCounty, rdist, rZipCode,
                        DeathName, Birthday, DeathLeapMonth, DeathBirthTime,
                        Deathday, DeathAge, FirstName, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Name2, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @Sendback,
                        @rName, @rMobile, @rAddress, @rAddr, @rCounty, @rdist, @rZipCode,
                        @DeathName, @Birthday, @DeathLeapMonth, @DeathBirthTime,
                        @Deathday, @DeathAge, @FirstName, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 3);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Name2", Name2);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@rName", rName);
                    adapter.AddParameterToSelectCommand("@rMobile", rMobile);
                    adapter.AddParameterToSelectCommand("@rAddress", rCounty + rDist + rAddr);
                    adapter.AddParameterToSelectCommand("@rAddr", rAddr);
                    adapter.AddParameterToSelectCommand("@rCounty", rCounty);
                    adapter.AddParameterToSelectCommand("@rdist", rDist);
                    adapter.AddParameterToSelectCommand("@rZipCode", rZipCode);

                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@Birthday", Birthday);
                    adapter.AddParameterToSelectCommand("@DeathLeapMonth", DeathLeapMonth);
                    adapter.AddParameterToSelectCommand("@DeathBirthTime", DeathBirthTime);
                    adapter.AddParameterToSelectCommand("@Deathday", Deathday);
                    adapter.AddParameterToSelectCommand("@DeathAge", DeathAge);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Merit">功德主。</param>
        /// <param name="MeritText">功德主內容。</param>
        /// <param name="Life">祝燈延壽消災。</param>
        /// <param name="Redress">四十九愿解冤釋結。</param>
        /// <param name="Creditor">冤親債主。</param>
        /// <param name="Ancestor">九玄七祖。</param>
        /// <param name="AncestorLastname">超度亡者姓氏。</param>
        /// <param name="AncestorAddress">祖先牌位地址。</param>
        /// <param name="AncestorCounty">祖先牌位地址縣市。</param>
        /// <param name="AncestorDist">祖先牌位地址區域。</param>
        /// <param name="AncestorAddr">祖先牌位地址部分地址。</param>
        /// <param name="AncestorZipCode">祖先牌位地址郵遞區號。</param>
        /// <param name="Deceased">功德迴向往生者。</param>
        /// <param name="DeceasedName">超度亡者姓名。</param>
        /// <param name="DeceasedAddress">亡者牌位地址。</param>
        /// <param name="DeceasedCounty">亡者牌位地址縣市。</param>
        /// <param name="DeceasedDist">亡者牌位地址區域。</param>
        /// <param name="DeceasedAddr">亡者牌位地址部分地址。</param>
        /// <param name="DeceasedZipCode">亡者牌位地址郵遞區號。</param>
        /// <param name="Landlord">地祇主。</param>
        /// <param name="LandlordNum">地祇主數量。</param>
        /// <param name="Baby">嬰靈。</param>
        /// <param name="BabyNum">嬰靈數量。</param>
        /// <param name="Animal">動物靈。</param>
        /// <param name="AnimalNum">動物靈數量。</param>
        /// <param name="PurdueType">普度項目。</param>
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// <param name="PurdueString">普度項目文字。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別。( 善男/信女)</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="PurdueNum">普度品數量。</param>
        /// <param name="RiceNum">白米數量。</param>
        /// <param name="mMoneyNum">金紙數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Year">資料年度。</param>
        /// <returns>新建立的主鍵編號。</returns>
        public int Addpurdue_h(
            int ApplicantID,
            string AdminID,
            string Merit,
            string MeritText,
            string Life,
            string Redress,
            string Creditor,
            string Ancestor,
            string AncestorLastname,
            string AncestorAddress,
            string AncestorCounty,
            string AncestorDist,
            string AncestorAddr,
            string AncestorZipCode,
            string Deceased,
            string DeceasedName,
            string DeceasedAddress,
            string DeceasedCounty,
            string DeceasedDist,
            string DeceasedAddr,
            string DeceasedZipCode,
            string Landlord,
            string LandlordNum,
            string Baby,
            string BabyNum,
            string Animal,
            string AnimalNum,
            string PurdueType,
            string PurdueString,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Oversea,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            int PurdueNum,
            int RiceNum,
            int mMoneyNum,
            string Remark,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 動態金額計算
                //int cost = GetTotal_h(
                //    Merit: Merit, 
                //    Life: Life, 
                //    Redress: Redress, 
                //    Creditor: Creditor, 
                //    Ancestor: Ancestor, 
                //    Deceased: Deceased, 
                //    Landlord: Landlord,
                //    LandlordNum: LandlordNum, 
                //    Baby: Baby, 
                //    BabyNum: BabyNum, 
                //    Animal: Animal, 
                //    AnimalNum: AnimalNum,
                //    PurdueNum: PurdueNum.ToString(), 
                //    RiceNum: RiceNum.ToString(), 
                //    mMoneyNum: mMoneyNum.ToString());

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_h_info(
                        ApplicantID, AdminID, Merit, MeritText, Life, Redress, Creditor,
                        Ancestor, AncestorLastname, AncestorAddress, AncestorCounty, Ancestordist,
                        AncestorAddr, AncestorZipCode, Deceased, DeceasedName, DeceasedAddress,
                        DeceasedCounty, Deceaseddist, DeceasedAddr, DeceasedZipCode, Landlord,
                        LandlordNum, Baby, BabyNum, Animal, AnimalNum, PurdueType, PurdueString,
                        Name, Mobile, Sex, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth,
                        oversea, Address, Addr, County, dist, ZipCode, PurdueNum, RiceNum, mMoneyNum, Cost,
                        Remark, CreateDate
                    )
                    VALUES (
                        @ApplicantID, @AdminID, @Merit, @MeritText, @Life, @Redress, @Creditor,
                        @Ancestor, @AncestorLastname, @AncestorAddress, @AncestorCounty, @Ancestordist,
                        @AncestorAddr, @AncestorZipCode, @Deceased, @DeceasedName, @DeceasedAddress,
                        @DeceasedCounty, @Deceaseddist, @DeceasedAddr, @DeceasedZipCode, @Landlord,
                        @LandlordNum, @Baby, @BabyNum, @Animal, @AnimalNum, @PurdueType, @PurdueString,
                        @Name, @Mobile, @Sex, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth,
                        @oversea, @Address, @Addr, @County, @dist, @ZipCode, @PurdueNum, @RiceNum, @mMoneyNum, @Cost,
                        @Remark, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Merit", Merit);
                    adapter.AddParameterToSelectCommand("@MeritText", MeritText);
                    adapter.AddParameterToSelectCommand("@Life", Life);
                    adapter.AddParameterToSelectCommand("@Redress", Redress);
                    adapter.AddParameterToSelectCommand("@Creditor", Creditor);
                    adapter.AddParameterToSelectCommand("@Ancestor", Ancestor);
                    adapter.AddParameterToSelectCommand("@AncestorLastname", AncestorLastname);
                    adapter.AddParameterToSelectCommand("@AncestorAddress", AncestorAddress);
                    adapter.AddParameterToSelectCommand("@AncestorAddr", AncestorAddr);
                    adapter.AddParameterToSelectCommand("@AncestorCounty", AncestorCounty);
                    adapter.AddParameterToSelectCommand("@Ancestordist", AncestorDist);
                    adapter.AddParameterToSelectCommand("@AncestorZipCode", AncestorZipCode);
                    adapter.AddParameterToSelectCommand("@Deceased", Deceased);
                    adapter.AddParameterToSelectCommand("@DeceasedName", DeceasedName);
                    adapter.AddParameterToSelectCommand("@DeceasedAddress", DeceasedAddress);
                    adapter.AddParameterToSelectCommand("@DeceasedAddr", DeceasedAddr);
                    adapter.AddParameterToSelectCommand("@DeceasedCounty", DeceasedCounty);
                    adapter.AddParameterToSelectCommand("@Deceaseddist", DeceasedDist);
                    adapter.AddParameterToSelectCommand("@DeceasedZipCode", DeceasedZipCode);
                    adapter.AddParameterToSelectCommand("@Landlord", Landlord);
                    adapter.AddParameterToSelectCommand("@LandlordNum", LandlordNum);
                    adapter.AddParameterToSelectCommand("@Baby", Baby);
                    adapter.AddParameterToSelectCommand("@BabyNum", BabyNum);
                    adapter.AddParameterToSelectCommand("@Animal", Animal);
                    adapter.AddParameterToSelectCommand("@AnimalNum", AnimalNum);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@PurdueNum", PurdueNum);
                    adapter.AddParameterToSelectCommand("@RiceNum", RiceNum);
                    adapter.AddParameterToSelectCommand("@mMoneyNum", mMoneyNum);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_wu(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string HomeNum,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(6, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_wu_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, HomeNum, Email, Count, Remark,
                        Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @HomeNum, @Email, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 6);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Name2">祈福人姓名2。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="GoldPaperCount">金紙數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="DeathName">亡者姓名。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_Fu(
            int ApplicantID,
            string Name,
            string Name2,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            int GoldPaperCount,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string FirstName,
            string DeathName,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(8, PurdueType);

                //if (PurdueType == "1")
                //{
                //    int c = 1;
                //    int.TryParse(Count, out c);
                //    cost = cost * c;
                //}
                //else
                //{
                //    int c = 0;
                //    int.TryParse(Count, out c);

                //    int gc = 0;
                //    int.TryParse(GoldPaperCount, out gc);

                //    cost += 1500 * c; //加購普品
                //    cost += 300 * gc; //加購金紙
                //}

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_Fu_info
                    (
                        ApplicantID, AdminID, Name, Name2, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, GoldPaperCount, Remark,
                        Address, Addr, County, dist, ZipCode, 
                        FirstName, DeathName, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Name2, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @GoldPaperCount, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, 
                        @FirstName, @DeathName, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 8);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Name2", Name2);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@GoldPaperCount", GoldPaperCount);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Name2">祈福人姓名2。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_Luer(
            int ApplicantID,
            string Name,
            string Name2,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(3, PurdueType);
                //Cost += Sendback == "1" ? 250 : 0;

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_Luer_info
                    (
                        ApplicantID, AdminID, Name, Name2, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, Count, Remark,
                        Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Name2, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 10);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Name2", Name2);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Count_3rice">普度白米3台斤數量</param>
        /// <param name="Count_50rice">普度白米50台斤數量</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>        /// 
        /// <param name="PurdueItem">超拔項目</param>
        /// <param name="DeathName">名字(府君、夫人、無緣子女、寵物姓名)</param>
        /// <param name="FirstName">姓氏(顯考-公、本姓-氏、姓氏-氏</param>
        /// <param name="MomName">夫姓(母)</param>
        /// <param name="LastName">名字(府君、夫人、無緣子女、寵物姓名)</param>
        /// <param name="Reason">超薦事由</param>
        /// <param name="LicenseNum">車牌號碼</param>
        /// <param name="DeathAddr">被超薦者地址(部分)</param>
        /// <param name="DeathCounty">被超薦者縣市</param>
        /// <param name="DeathDist">被超薦者區域</param>
        /// <param name="DeathZipCode">被超薦者郵遞區號</param>
        /// <param name="PurdueItem1">超拔項目</param>
        /// <param name="DeathName1">名字(府君、夫人、無緣子女、寵物姓名)</param>
        /// <param name="FirstName1">姓氏(顯考-公、本姓-氏、姓氏-氏</param>
        /// <param name="MomName1">夫姓(母)</param>
        /// <param name="LastName1">名字(府君、夫人、無緣子女、寵物姓名)</param>
        /// <param name="Reason1">超薦事由</param>
        /// <param name="LicenseNum1">車牌號碼</param>
        /// <param name="DeathAddr1">被超薦者地址(部分)</param>
        /// <param name="DeathCounty1">被超薦者縣市</param>
        /// <param name="DeathDist1">被超薦者區域</param>
        /// <param name="DeathZipCode1">被超薦者郵遞區號</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            int Count_3rice, 
            int Count_50rice,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string PurdueItem, 
            string DeathName, 
            string FirstName, 
            string MomName, 
            string LastName, 
            string Reason, 
            string LicenseNum, 
            string DeathAddr,
            string DeathCounty, 
            string DeathDist, 
            string DeathZipCode, 
            string PurdueItem1,
            string DeathName1, 
            string FirstName1, 
            string MomName1, 
            string LastName1, 
            string Reason1,
            string LicenseNum1, 
            string DeathAddr1, 
            string DeathCounty1, 
            string DeathDist1, 
            string DeathZipCode1,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(14, PurdueType);
                //switch (PurdueType)
                //{
                //    case "1":
                //        //贊普
                //        Cost = Cost * Count;
                //        break;
                //    case "14":
                //        //孝道功德主 兩項普渡項目$3000/2
                //        Cost = Cost * Count;
                //        break;
                //    case "15":
                //        //光明功德主
                //        Cost = Cost * Count;
                //        break;
                //    case "16":
                //        //發心功德主
                //        Cost = Cost * Count;
                //        break;
                //    case "18":
                //        //白米50台斤
                //        Cost = Cost * Count_50rice;
                //        break;
                //    case "19":
                //        //白米3台斤
                //        Cost = Cost * Count_3rice;
                //        break;
                //}


                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Count_3rice, Count_50rice, Remark,
                        Address, Addr, County, dist, ZipCode, PurdueItem, DeathName, FirstName, MomName, LastName, 
                        Reason, LicenseNum, DeathAddress, DeathAddr, DeathCounty, Deathdist, DeathZipCode, 
                        PurdueItem1, DeathName1, FirstName1, MomName1, LastName1, Reason1, LicenseNum1, 
                        DeathAddress1, DeathAddr1, DeathCounty1, Deathdist1, DeathZipCode1, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, Count_3rice, Count_50rice, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @PurdueItem, @DeathName, @FirstName, @MomName, @LastName, 
                        @Reason, @LicenseNum, @DeathAddress, @DeathAddr, @DeathCounty, 2Deathdist, @DeathZipCode, 
                        @PurdueItem1, @DeathName1, @FirstName1, MomName1, LastName1, Reason1, LicenseNum1, 
                        @DeathAddress1, @DeathAddr1, @DeathCounty1, @Deathdist1, @DeathZipCode1, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Count_3rice", Count_3rice);
                    adapter.AddParameterToSelectCommand("@Count_50rice", Count_50rice);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@PurdueItem", PurdueItem);
                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@MomName", MomName);
                    adapter.AddParameterToSelectCommand("@LastName", LastName);
                    adapter.AddParameterToSelectCommand("@Reason", Reason);
                    adapter.AddParameterToSelectCommand("@LicenseNum", LicenseNum);
                    adapter.AddParameterToSelectCommand("@DeathAddress", DeathCounty + DeathDist + DeathAddr);
                    adapter.AddParameterToSelectCommand("@DeathAddr", DeathAddr);
                    adapter.AddParameterToSelectCommand("@DeathCounty", DeathCounty);
                    adapter.AddParameterToSelectCommand("@Deathdist", DeathDist);
                    adapter.AddParameterToSelectCommand("@DeathZipCode", DeathZipCode);

                    adapter.AddParameterToSelectCommand("@PurdueItem1", PurdueItem1);
                    adapter.AddParameterToSelectCommand("@DeathName1", DeathName1);
                    adapter.AddParameterToSelectCommand("@FirstName1", FirstName1);
                    adapter.AddParameterToSelectCommand("@MomName1", MomName1);
                    adapter.AddParameterToSelectCommand("@LastName1", LastName1);
                    adapter.AddParameterToSelectCommand("@Reason1", Reason1);
                    adapter.AddParameterToSelectCommand("@LicenseNum1", LicenseNum1);
                    adapter.AddParameterToSelectCommand("@DeathAddress1", DeathCounty1 + DeathDist1 + DeathAddr1);
                    adapter.AddParameterToSelectCommand("@DeathAddr1", DeathAddr1);
                    adapter.AddParameterToSelectCommand("@DeathCounty1", DeathCounty1);
                    adapter.AddParameterToSelectCommand("@Deathdist1", DeathDist1);
                    adapter.AddParameterToSelectCommand("@DeathZipCode1", DeathZipCode1);

                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Count_rice">捐獻白米數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_Fw(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            int Count_rice,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(15, PurdueType);
                //if (Count_rice > 0)
                //{
                //    cost += Count_rice * 200;
                //}

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_Fw_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Count_rice, Remark,
                        Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @Count_rice, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 15);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Count_rice", Count_rice);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="DeathName">亡者姓名。</param>
        /// <param name="Deathday">亡者往生日期。</param>
        /// <param name="DeathBirth">亡者農曆生日。</param>
        /// <param name="DeathLeapMonth">亡者是否閏月（Y=是、N=否）。</param>
        /// <param name="DeathBirthTime">亡者農曆時辰。</param>
        /// <param name="DeathBirthMonth">亡者農曆月份。</param>
        /// <param name="DeathAge">亡者年齡。</param>
        /// <param name="DeathZodiac">亡者生肖</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="DeathAddr">牌位地址(部分)</param>
        /// <param name="DeathCounty">牌位地址縣市</param>
        /// <param name="DeathDist">牌位地址區域</param>
        /// <param name="DeathZipCode">牌位地址郵遞區號</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_dh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string DeathName,
            string Deathday,
            string DeathBirth,
            string DeathLeapMonth,
            string DeathBirthTime,
            string DeathBirthMonth,
            string DeathAge,
            string DeathZodiac,
            string FirstName,
            string DeathAddr,
            string DeathCounty, 
            string DeathDist, 
            string DeathZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;
                string fullDeathAddress = DeathCounty + (DeathDist == "*" ? "" : DeathDist) + DeathAddr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(16, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_dh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Remark,
                        Address, Addr, County, dist, ZipCode, 
                        DeathName, Deathday, DeathBirth, DeathLeapMonth, DeathBirthTime,
                        DeathBirthMonth, DeathAge, DeathZodiac, FirstName, DeathAddress, 
                        DeathAddr, DeathCounty, Deathdist, DeathZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, 
                        @DeathName, @Deathday, @DeathBirth, @DeathLeapMonth, @DeathBirthTime,
                        @DeathBirthMonth, @DeathAge, @DeathZodiac, @FirstName, @DeathAddress, 
                        @DeathAddr, @DeathCounty, @Deathdist, @DeathZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 16);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@Deathday", Deathday);
                    adapter.AddParameterToSelectCommand("@DeathBirth", DeathBirth);
                    adapter.AddParameterToSelectCommand("@DeathLeapMonth", DeathLeapMonth);
                    adapter.AddParameterToSelectCommand("@DeathBirthTime", DeathBirthTime);
                    adapter.AddParameterToSelectCommand("@DeathBirthMonth", DeathBirthMonth);
                    adapter.AddParameterToSelectCommand("@DeathAge", DeathAge);
                    adapter.AddParameterToSelectCommand("@DeathZodiac", DeathZodiac);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@DeathAddress", fullDeathAddress);
                    adapter.AddParameterToSelectCommand("@DeathAddr", DeathAddr);
                    adapter.AddParameterToSelectCommand("@DeathCounty", DeathCounty);
                    adapter.AddParameterToSelectCommand("@Deathdist", DeathDist);
                    adapter.AddParameterToSelectCommand("@DeathZipCode", DeathZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="HomeNum">祈福人市話(選填)</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_Lk(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth, 
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(21, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_Lk_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, HomeNum, Count, Remark,
                        Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @HomeNum, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 21);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_ma(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string FirstName,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(23, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_ma_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, Count, Remark,
                        Address, Addr, County, dist, ZipCode, FirstName, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @FirstName, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 23);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="Sendback">寄送方式 0-不寄回(會轉送給弱勢團體) 1-寄回(加收運費150元)</param>
        /// <param name="rName">收件人姓名。</param>
        /// <param name="rMobile">收件人電話。</param>
        /// <param name="rAddr">收件人部分地址。</param>
        /// <param name="rCounty">收件人縣市。</param>
        /// <param name="rDist">收件人區域。</param>
        /// <param name="rZipCode">收件人郵遞區號。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_jb(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Sendback,
            string rName,
            string rMobile,
            string rAddr,
            string rCounty,
            string rDist,
            string rZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;
                string fullrAddress = rCounty + (rDist == "*" ? "" : rDist) + rAddr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(29, PurdueType);
                //cost += Sendback == "1" ? 150 : 0;

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_jb_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Remark,
                        Address, Addr, County, dist, ZipCode, Sendback,
                        rName, rMobile, rAddress, rAddr, rCounty, rdist, rZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @Sendback,
                        @rName, @rMobile, @rAddress, @rAddr, @rCounty, @rdist, @rZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 29);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@rName", rName);
                    adapter.AddParameterToSelectCommand("@rMobile", rMobile);
                    adapter.AddParameterToSelectCommand("@rAddress", fullrAddress);
                    adapter.AddParameterToSelectCommand("@rAddr", rAddr);
                    adapter.AddParameterToSelectCommand("@rCounty", rCounty);
                    adapter.AddParameterToSelectCommand("@rdist", rDist);
                    adapter.AddParameterToSelectCommand("@rZipCode", rZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_wjsan(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string FirstName,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(31, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_wjsan_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, Remark,
                        Address, Addr, County, dist, ZipCode, FirstName, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @FirstName, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 31);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Name2">祈福人姓名2。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="CompanyName">公司名稱。</param>
        /// <param name="DeathName">亡者姓名。</param>
        /// <param name="DeathBirth">亡者農曆生日。</param>
        /// <param name="DeathLeapMonth">亡者是否閏月（Y=是、N=否）。</param>
        /// <param name="DeathBirthTime">亡者農曆時辰。</param>
        /// <param name="Deathday">亡者往生日期。</param>
        /// <param name="DeathAge">亡者年齡。</param>
        /// <param name="DeathAddr">牌位地址(部分)</param>
        /// <param name="DeathCounty">牌位地址縣市</param>
        /// <param name="DeathDist">牌位地址區域</param>
        /// <param name="DeathZipCode">牌位地址郵遞區號</param>
        /// <param name="PetName">寵物姓名</param>
        /// <param name="PetType">寵物品種</param>
        /// <param name="Petdeathday">寵物死亡日期</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_ld(
            int ApplicantID,
            string Name,
            string Name2,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string FirstName,
            string CompanyName,
            string DeathName,
            string DeathBirth,
            string DeathLeapMonth,
            string DeathBirthTime,
            string Deathday,
            string DeathAge,
            string DeathAddr, 
            string DeathCounty, 
            string DeathDist, 
            string DeathZipCode,
            string PetName, 
            string PetType, 
            string Petdeathday,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;
                string fullDeathAddress = DeathCounty + (DeathDist == "*" ? "" : DeathDist) + DeathAddr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(32, PurdueType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_ld_info
                    (
                        ApplicantID, AdminID, Name, Name2, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, Count, Remark,
                        Address, Addr, County, dist, ZipCode, 
                        FirstName, CompanyName, DeathName, DeathBirth, DeathLeapMonth, DeathBirthTime,
                        Deathday, DeathAge, DeathAddress, DeathAddr, DeathCounty, Deathdist, DeathZipCode, 
                        PetName, PetType, Petdeathday, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Name2, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, @Count, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, 
                        @FirstName, @CompanyName, @DeathName, @DeathBirth, @DeathLeapMonth, @DeathBirthTime,
                        @Deathday, @DeathAge, @DeathAddress, @DeathAddr, @DeathCounty, @Deathdist, @DeathZipCode, 
                        @PetName, @PetType, @Petdeathday, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 32);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Name2", Name2);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@CompanyName", CompanyName);
                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@DeathBirth", DeathBirth);
                    adapter.AddParameterToSelectCommand("@DeathLeapMonth", DeathLeapMonth);
                    adapter.AddParameterToSelectCommand("@DeathBirthTime", DeathBirthTime);
                    adapter.AddParameterToSelectCommand("@Deathday", Deathday);
                    adapter.AddParameterToSelectCommand("@DeathAge", DeathAge);
                    adapter.AddParameterToSelectCommand("@DeathAddress", fullDeathAddress);
                    adapter.AddParameterToSelectCommand("@DeathAddr", DeathAddr);
                    adapter.AddParameterToSelectCommand("@DeathCounty", DeathCounty);
                    adapter.AddParameterToSelectCommand("@Deathdist", DeathDist);
                    adapter.AddParameterToSelectCommand("@DeathZipCode", DeathZipCode);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@Petdeathday", Petdeathday);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 普度 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">祈福人性別（善男／信女）。</param>
        /// <param name="PurdueType">
        /// 普度項目：
        /// 1-贊普
        /// 2-九玄七祖
        /// 3-指名亡者
        /// 4-本境地基主
        /// 5-冤親債主
        /// 6-嬰靈
        /// 7-為國捐軀三軍將士英靈
        /// 8-鐵公路車傷死亡眾魂
        /// 9-本境水難傷亡諸魂
        /// 10-本境男女無嗣孤魂等眾
        /// 11-六畜往生
        /// 12-法船
        /// 13-壽生錢
        /// 14-孝道功德主
        /// 15-光明功德主
        /// 16-發心功德主
        /// 17-誦經迴向
        /// 18-白米50台斤
        /// 19-白米3台斤
        /// 20-寵物普度(毛小孩)
        /// 21-寵物普度(喵星人)
        /// </param>
        /// <param name="PurdueString">普度項目字串。</param>
        /// <param name="Oversea">是否國外（1=國內、2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是、N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="GoldPaperCount">金紙數量 defult:0。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人部分地址。</param>
        /// <param name="County">祈福人縣市。</param>
        /// <param name="Dist">祈福人區域。</param>
        /// <param name="ZipCode">祈福人郵遞區號。</param>
        /// <param name="DeathName">亡者姓名。</param>
        /// <param name="FirstName">姓氏。</param>
        /// <param name="PetName">寵物姓名</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立紀錄的主鍵編號（Identity 值）。</returns>
        public int Addpurdue_wh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string PurdueType,
            string PurdueString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            int GoldPaperCount,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string DeathName,
            string FirstName,
            string PetName,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（含運費）
                //int cost = AjaxBasePage.GetPurdueCost(34, PurdueType);
                //int gc = 0;
                //int.TryParse(GoldPaperCount, out gc);

                //cost += 100 * gc; //加購金紙

                string sql = $@"
                    INSERT INTO Temple_{Year}..Purdue_wh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex,
                        PurdueType, PurdueString, oversea, Birth, LeapMonth,
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Count, GoldPaperCount, Remark,
                        Address, Addr, County, dist, ZipCode, DeathName, FirstName, PetName, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex,
                        @PurdueType, @PurdueString, @oversea, @Birth, @LeapMonth,
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Count, @GoldPaperCount, @Remark,
                        @Address, @Addr, @County, @dist, @ZipCode, @DeathName, @FirstName, @PetName, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 34);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@PurdueType", PurdueType);
                    adapter.AddParameterToSelectCommand("@PurdueString", PurdueString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@GoldPaperCount", GoldPaperCount);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);

                    adapter.AddParameterToSelectCommand("@DeathName", DeathName);
                    adapter.AddParameterToSelectCommand("@FirstName", FirstName);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addpurdue_wh：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_da(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_da_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_h(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_h_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_h：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_wu(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wu_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_Fu(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fu_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_Fu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_Luer(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Luer_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_Luer：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_Fw(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fw_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_dh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_dh_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_Lk(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Lk_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_ma(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ma_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_jb(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_jb_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_wjsan(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wjsan_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 桃園龍德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_ld(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ld_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_ld：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 普度 - 基隆悟玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Purdue_wh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wh_Purdue " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Purdue_wh：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #region 商品小舖資料建立 (Product)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立商品小舖購買人資料。
        /// </summary>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市名稱。</param>
        /// <param name="Dist">鄉鎮區名稱。</param>
        /// <param name="Addr">地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否寄回 Y=是，N=否。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態。</param>
        /// <param name="PostURL">訪問網址（紀錄使用者來源頁面）。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳新增後的 ApplicantID（IDENTITY）。
        /// 若發生錯誤則回傳 -1。
        /// </returns>
        public int Addapplicantinfo_Product(
            string AdminID,
            string Name,
            string Mobile,
            int Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback, 
            string ReceiptName, 
            string ReceiptMobile,
            string Email,
            int Status, 
            string PostURL,
            string Year)
        {
            int newId = -1;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Product
                    (AdminID, Name, Mobile, Cost, County, dist, Addr, Address, ZipCode, Sendback, ReceiptName, ReceiptMobile, Email, Status, postURL, CreateDate, CreateDateString)
                    VALUES (@AdminID, @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, @ZipCode, @Sendback, @ReceiptName, @ReceiptMobile, @Email, @Status, @postURL, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    DataTable dt = new DataTable();
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@postURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dt);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Product：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立錢母擺件商品小舖購買人資料。
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Email">購買人電子郵件。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="County">縣市名稱。</param>
        /// <param name="Dist">鄉鎮區名稱。</param>
        /// <param name="Address">地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="PostURL">訪問網址（紀錄使用者來源頁面）。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳新增後的 ApplicantID（IDENTITY）。
        /// 若發生錯誤則回傳 -1。
        /// </returns>
        public int Addapplicantinfo_Moneymother(
            string Name,
            string Mobile,
            string Email,
            string AdminID,
            string County,
            string Dist,
            string Address,
            string ZipCode,
            string PostURL,
            string Year)
        {
            int newId = -1;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Address;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Moneymother
                    (Name, Mobile, Email, AdminID, County, dist, Addr, Address, ZipCode, postURL, CreateDateString, CreateDate)
                    VALUES (@Name, @Mobile, @Email, @AdminID, @County, @dist, @Addr, @Address, @ZipCode, @postURL, @CreateDateString, @CreateDate)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    DataTable dt = new DataTable();
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Address);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@postURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dt);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddApplicantInfo_MoneyMother：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 購買商品資料建立 (ProductInfo)

        /// <summary>
        /// 建立商品小舖商品資料。
        /// </summary>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="tAID">臨時購買商品編號</param>
        /// <param name="UserID">會員編號</param>
        /// <param name="ProductID">商品編號</param>
        /// <param name="TypeID">商品類別編號</param>
        /// <param name="Cost">Cost=金額</param>
        /// <param name="Count">Count=數量</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳新增後的資料識別碼（IDENTITY）。
        /// 若發生錯誤則回傳 -1。
        /// </returns>
        public int Addproductinfo(
            int AdminID,
            int ApplicantID,
            int tAID, 
            int UserID, 
            int TypeID, 
            int ProductID,
            int Cost,
            int Count,
            string Year)
        {
            int newId = -1;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..ProductInfo " +
                             "(AdminID, ApplicantID, tAID, UserID, TypeID, ProductID, Cost, Count, CreateDate) " +
                             "VALUES (@AdminID, @ApplicantID, @tAID, @UserID, @TypeID, @ProductID, @Cost, @Count, @CreateDate)";

                //int amount = 0, cost = 0, count = 0;

                //int.TryParse(Cost, out cost);
                //int.TryParse(Count, out count);
                //amount = cost * count;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    DataTable dt = new DataTable();
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@tAID", tAID);
                    adapter.AddParameterToSelectCommand("@UserID", UserID);
                    adapter.AddParameterToSelectCommand("@TypeID", TypeID);
                    adapter.AddParameterToSelectCommand("@ProductID", ProductID);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dt);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addproductinfo：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立錢母擺件商品小舖商品資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="name">商品名稱。</param>
        /// <param name="type">商品類型。</param>
        /// <param name="cost">銷售金額。</param>
        /// <param name="price">單價。</param>
        /// <param name="count">數量。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳新增後的資料識別碼（IDENTITY）。
        /// 若發生錯誤則回傳 -1。
        /// </returns>
        public int AddProduct_MoneyMother(
            int ApplicantID,
            string name,
            int type,
            int cost,
            int price,
            int count,
            string Year)
        {
            int newId = -1;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..Product_Moneymother " +
                             "(ApplicantID, Name, Type, Cost, Price, Count, CreateDate) " +
                             "VALUES (@ApplicantID, @Name, @Type, @Cost, @Price, @Count, @CreateDate)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    DataTable dt = new DataTable();
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Name", name);
                    adapter.AddParameterToSelectCommand("@Type", type);
                    adapter.AddParameterToSelectCommand("@Cost", cost);
                    adapter.AddParameterToSelectCommand("@Price", price);
                    adapter.AddParameterToSelectCommand("@Count", count);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dt);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddProduct_MoneyMother：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 商品販賣小舖
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="AdminID">宮廟編號編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Product(
            string OrderID,
            int ApplicantID,
            int AdminID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Product " +
                             "(OrderID, ApplicantID, AdminID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @AdminID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Product：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 商品販賣小舖 - 錢母擺件商品
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Moneymother(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Moneymother " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Moneymother：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #region 法會資料建立 (Supplies)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立購買人資料 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_wu(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wu_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_wu2(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wu_Supplies2
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_wu2：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="NewUser">新舊會員 1-新會員 0-舊會員。</param>
        /// <param name="AddDate">新增訂閱時間 (yyyy-MM-dd HH:mm:ss)。</param>
        /// <param name="AddDateString">新增訂閱時間字串 (yyyy-MM-dd)。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_wu3(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int NewUser, 
            string AddDate, 
            string AddDateString,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wu_Supplies3
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, NewUser, AddDate, AddDateString, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, @NewUser, @AddDate, @AddDateString, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@NewUser", NewUser);
                    adapter.AddParameterToSelectCommand("@AddDate", AddDate);
                    adapter.AddParameterToSelectCommand("@AddDateString", AddDateString);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_wu3：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_Fw(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fw_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_ty(
            string Name,
            string Mobile,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Cost,
            string Email,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_Supplies
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Cost, Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Cost, @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_Supplies2_ty(
            string Name,
            string Mobile,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Cost,
            string Email,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_Supplies2
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Cost, Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Cost, @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies2_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies3_ty(
            string Name,
            string Mobile,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Cost,
            string Email,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_Supplies3
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Cost, Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Cost, @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies3_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_dh(
            string Name,
            string Mobile,
            string Cost,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_dh_Supplies
                    (
                        Name, Mobile, Cost, ZipCode, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @ZipCode, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_Lk(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Lk_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_ma(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ma_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 天赦日祭改 - 進寶財神廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_jb(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_jb_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Supplies_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_sx(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_sx_Supplies
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_supplies_sx：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies2_sx(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_sx_Supplies2
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_supplies2_sx：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 祈安禮斗 - 基隆悟玄宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_supplies_wh(
            string Name,
            string Mobile,
            string Cost,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            string Remark,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wh_Supplies
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Cost, County, dist, Addr, ZipCode, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, Remark, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Cost, @County, @dist, @Addr, @ZipCode, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, @Remark, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_supplies_wh：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 祈福人資料建立 (SuppliesInfo)

        /// <summary>
        /// 建立祈福人資料 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_wu(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(6, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_wu_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 6); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_wu2(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(6, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_wu_info2
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 6); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_wu2：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_wu3(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(6, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_wu_info3
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 6); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_wu3：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(14, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies2_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(14, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies2_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies2_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies3_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(14, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies3_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies3_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_Fw(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(21, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_Fw_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 21); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Count1">數量。</param>
        /// <param name="Count2">數量。</param>
        /// <param name="Count3">數量。</param>
        /// <param name="Count4">數量。</param>
        /// <param name="Count5">數量。</param>
        /// <param name="Count6">數量。</param>
        /// <param name="Count7">數量。</param>
        /// <param name="Count8">數量。</param>
        /// <param name="Count9">數量。</param>
        /// <param name="Count10">數量。</param>
        /// <param name="Count11">數量。</param>
        /// <param name="Count12">數量。</param>
        /// <param name="Count13">數量。</param>
        /// <param name="Count14">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_dh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            int Count1,
            int Count2,
            int Count3,
            int Count4,
            int Count5,
            int Count6,
            int Count7,
            int Count8,
            int Count9,
            int Count10,
            int Count11,
            int Count12,
            int Count13,
            int Count14,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int Cost = 0;
                //Cost += Count1 > 0 ? Count1 * 2388 : 0;
                //Cost += Count2 > 0 ? Count2 * 800 : 0;
                //Cost += Count3 > 0 ? Count3 * 800 : 0;
                //Cost += Count4 > 0 ? Count4 * 700 : 0;
                //Cost += Count5 > 0 ? Count5 * 1000 : 0;
                //Cost += Count6 > 0 ? Count6 * 1000 : 0;
                //Cost += Count7 > 0 ? Count7 * 200 : 0;
                //Cost += Count8 > 0 ? Count8 * 600 : 0;
                //Cost += Count9 > 0 ? Count9 * 600 : 0;
                //Cost += Count10 > 0 ? Count10 * 600 : 0;
                //Cost += Count11 > 0 ? Count11 * 600 : 0;
                //Cost += Count12 > 0 ? Count12 * 600 : 0;
                //Cost += Count13 > 0 ? Count13 * 600 : 0;
                //Cost += Count14 > 0 ? Count14 * 600 : 0;

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_dh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Count1, Count2, Count3, Count4, Count5, Count6, Count7, 
                        Count8, Count9, Count10, Count11, Count12, Count13, Count14, 
                        Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Count1, @Count2, @Count3, @Count4, @Count5, @Count6, 
                        @Count7, @Count8, @Count9, @Count10, @Count11, @Count12, @Count13, @Count14, 
                        @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 16); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Count1", Count1);
                    adapter.AddParameterToSelectCommand("@Count2", Count2);
                    adapter.AddParameterToSelectCommand("@Count3", Count3);
                    adapter.AddParameterToSelectCommand("@Count4", Count4);
                    adapter.AddParameterToSelectCommand("@Count5", Count5);
                    adapter.AddParameterToSelectCommand("@Count6", Count6);
                    adapter.AddParameterToSelectCommand("@Count7", Count7);
                    adapter.AddParameterToSelectCommand("@Count8", Count8);
                    adapter.AddParameterToSelectCommand("@Count9", Count9);
                    adapter.AddParameterToSelectCommand("@Count10", Count10);
                    adapter.AddParameterToSelectCommand("@Count11", Count11);
                    adapter.AddParameterToSelectCommand("@Count12", Count12);
                    adapter.AddParameterToSelectCommand("@Count13", Count13);
                    adapter.AddParameterToSelectCommand("@Count14", Count14);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_Lk(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(21, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_Lk_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 21); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_ma(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(23, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_ma_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 23); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 天赦日祭改 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_jb(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            int Count,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(29, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_jb_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, 
                        Count, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, 
                        @Count, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 29); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_sx(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(33, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_sx_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 33); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies_sx：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="HomeNum">祈福人市話。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies2_sx(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string HomeNum,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(33, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies2_sx_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, HomeNum, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @HomeNum, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 33); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@HomeNum", HomeNum);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addsupplies2_sx：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 祈安禮斗 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="SuppliesType"></param>
        /// <param name="SuppliesString">/param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addsupplies_wh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string SuppliesType,
            string SuppliesString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetSuppliesCost(34, SuppliesType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Supplies_wh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        SuppliesType, SuppliesString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @SuppliesType, @SuppliesString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 34); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@SuppliesType", SuppliesType);
                    adapter.AddParameterToSelectCommand("@SuppliesString", SuppliesString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.addsupplies_wh：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_wu(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wu_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_wu：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_wu2(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wu_Supplies2 " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_wu2：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_wu3(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wu_Supplies3 " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_wu3：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies2_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_Supplies2 " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies2_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies3_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_Supplies3 " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies3_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_Fw(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fw_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_dh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_dh_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_Lk(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Lk_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_Lk：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_ma(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ma_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 天赦日祭改 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_jb(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_jb_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 祈安禮斗 - 基隆悟玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_wh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wh_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_wh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies_sx(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_sx_Supplies " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies_sx：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Supplies2_sx(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_sx_Supplies2 " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Supplies2_sx：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #region 安斗資料建立 (AnDou)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立購買人資料 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_andou_Fw(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_Fw_AnDou
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_andou_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_andou_wjsan(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wjsan_AnDou
                    (
                        Name, Mobile, Cost, County, dist, Addr, Address, 
                        Sendback, ReceiptName, ReceiptMobile, Email, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @Address, 
                        @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_andou_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 祈福人資料建立 (AnDouInfo)

        /// <summary>
        /// 建立祈福人資料 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人/飼主姓名。</param>
        /// <param name="Mobile">祈福人/飼主電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="AnDouType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="AnDouString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人/飼主信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人/飼主地址部分地址。</param>
        /// <param name="County">祈福人/飼主地址縣市。</param>
        /// <param name="Dist">祈福人/飼主地址區域。</param>
        /// <param name="ZipCode">祈福人/飼主地址郵遞區號。</param>
        /// <param name="PetName">寵物姓名。</param>
        /// <param name="PetType">寵物品種。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddAnDou_Fw(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string AnDouType,
            string AnDouString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string PetName,
            string PetType,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(15, AnDouType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..AnDou_Fw_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        AnDouType, AnDouString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, PetName, PetType, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @AnDouType, @AnDouString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @PetName, @PetType, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 15); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@AnDouType", AnDouType);
                    adapter.AddParameterToSelectCommand("@AnDouString", AnDouString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@PetName", PetName);
                    adapter.AddParameterToSelectCommand("@PetType", PetType);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddAnDou_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="AnDouType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="AnDouString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddAnDou_wjsan(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string AnDouType,
            string AnDouString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(31, AnDouType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..AnDou_wjsan_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        AnDouType, AnDouString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @AnDouType, @AnDouString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 31); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@AnDouType", AnDouType);
                    adapter.AddParameterToSelectCommand("@AnDouString", AnDouString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddAnDou_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_AnDou_Fw(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_Fw_AnDou " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_AnDou_Fw：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_AnDou_wjsan(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wjsan_AnDou " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_AnDou_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #region 其他活動資料建立 (Other)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 建立購買人資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_emperorGuansheng_ty(
            string Name,
            string Mobile,
            string Cost,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_EmperorGuansheng
                    (
                        Name, Mobile, Cost, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 代燒金紙 - 進寶財神廟
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_BPO_jb(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_jb_BPO
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, Email, 
                        Status, AdminID, PostURL, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @Status, @AdminID, @PostURL, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_BPO_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_Lingbaolidou_ma(
            string Name,
            string Mobile,
            string Cost,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ma_Lingbaolidou
                    (
                        Name, Mobile, Cost, Email, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @Email, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_TaoistJiaoCeremony_da(
            string Name,
            string Mobile,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string Cost,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_da_TaoistJiaoCeremony
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Cost, ZipCode, County, dist, Addr, Address, Sendback, ReceiptName, ReceiptMobile, 
                        AdminID, PostURL, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Cost, @ZipCode, @County, @dist, @Addr, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @AdminID, @PostURL, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_Lybc_dh(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_dh_Lybc
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, Email, 
                        Status, AdminID, PostURL, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @Status, @AdminID, @PostURL, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_huaguo_wjsan(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_wjsan_Huaguo
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, Email, 
                        Status, AdminID, PostURL, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @Status, @AdminID, @PostURL, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_huaguo_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_lights_ty_mom(
            string Name,
            string Mobile, 
            string Birth, 
            string LeapMonth, 
            string BirthTime, 
            string BirthMonth, 
            string Age,
            string Zodiac,
            string sBirth,
            string Cost,
            string Email,
            string ZipCode,
            string County,
            string Dist,
            string Addr,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_mom_Lights
                    (
                        Name, Mobile, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Cost, Email, ZipCode, County, dist, Addr, Address, Sendback, ReceiptName, ReceiptMobile, 
                        PostURL, AdminID, Status, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Cost, @Email, @ZipCode, @County, @dist, @Addr, @Address, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @PostURL, @AdminID, @Status, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_lights_ty_mom：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_blessing_st(
            string Name,
            string Mobile,
            string Cost,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            string Email,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_st_Blessing
                    (
                        Name, Mobile, Cost, County, dist, Addr, ZipCode, Address, Sendback, ReceiptName, ReceiptMobile, Email, 
                        Status, AdminID, PostURL, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @Name, @Mobile, @Cost, @County, @dist, @Addr, @ZipCode, @Address, @Sendback, @ReceiptName, @ReceiptMobile, @Email, 
                        @Status, @AdminID, @PostURL, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_blessing_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立購買人資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="ZipCode">郵遞區號。</param>
        /// <param name="County">縣市。</param>
        /// <param name="Dist">鄉鎮市區。</param>
        /// <param name="Addr">部分地址。</param>
        /// <param name="Sendback">是否回郵（N=否、Y=是）。</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="Status">狀態碼（0=未付款、1=付款中、2=已付款、-1=已退款等）。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度（例如 "2025"）。</param>
        /// <returns>回傳新建立的購買人資料之自動遞增編號（Identity 值）。</returns>
        public int Addapplicantinfo_qnlight_ty(
            string AdminID,
            string Name,
            string Mobile,
            string Cost,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int Status,
            string PostURL,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                string sql = $@"
                    INSERT INTO Temple_{Year}..ApplicantInfo_ty_QnLight
                    (
                        AdminID, Name, Mobile, Cost, Birth, LeapMonth, BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Address, County, dist, Addr, ZipCode, Sendback, ReceiptName, ReceiptMobile, 
                        Status, PostURL, CreateDate, CreateDateString
                    )
                    VALUES
                    (
                        @AdminID, @Name, @Mobile, @Cost, @Birth, @LeapMonth, @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Address, @County, @dist, @Addr, @ZipCode, @Sendback, @ReceiptName, @ReceiptMobile, 
                        @Status, @PostURL, @CreateDate, @CreateDateString
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@ReceiptName", ReceiptName);
                    adapter.AddParameterToSelectCommand("@ReceiptMobile", ReceiptMobile);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@PostURL", PostURL);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Addapplicantinfo_qnlight_ty：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 祈福人資料建立 (OtherInfo)

        /// <summary>
        /// 建立祈福人資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="EmperorGuanshengType">
        /// 關聖帝君聖誕項目。
        /// 1-忠義狀功德主 
        /// 2-富貴狀功德主 
        /// 3-招財補運 
        /// 4-招財補運紀念版
        /// 5-麒麟狀 祝壽謝恩招財祿位
        /// </param>
        /// <param name="EmperorGuanshengString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int Addemperorguansheng_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string EmperorGuanshengType,
            string EmperorGuanshengString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Remark,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetEmperorGuanshengCost(14, EmperorGuanshengType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..EmperorGuansheng_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        EmperorGuanshengType, EmperorGuanshengString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Address, Addr, County, dist, ZipCode, Remark, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @EmperorGuanshengType, @EmperorGuanshengString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Address, @Addr, @County, @dist, @ZipCode, @Remark, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@EmperorGuanshengType", EmperorGuanshengType);
                    adapter.AddParameterToSelectCommand("@EmperorGuanshengString", EmperorGuanshengString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddEmperorGuansheng_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 代燒金紙 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="BPOType">
        /// BPOType=代燒金紙項目 
        /// 1-代燒-貔貅金紙 
        /// 2-代燒-狐仙金紙 
        /// 3-代燒-夯枷金紙 
        /// 4-代燒-財神金紙</param>
        /// <param name="BPOString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddBPO_jb(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string BPOType,
            string BPOString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Remark,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetBPOCost(29, BPOType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..BPO_jb_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        BPOType, BPOString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Address, Addr, County, dist, ZipCode, Remark, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @BPOType, @BPOString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Address, @Addr, @County, @dist, @ZipCode, @Remark, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 29); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@BPOType", BPOType);
                    adapter.AddParameterToSelectCommand("@BPOString", BPOString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddBPO_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LingbaolidouType">
        /// 靈寶禮斗項目 
        /// 1-靈寶禮斗-功德主 
        /// 2-靈寶禮斗-隨喜功德主 
        /// 3-靈寶禮斗-消災解厄科儀
        /// </param>
        /// <param name="LingbaolidouString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLingbaolidou_ma(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LingbaolidouType,
            string LingbaolidouString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLingbaolidouCost(23, LingbaolidouType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lingbaolidou_ma_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LingbaolidouType, LingbaolidouString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LingbaolidouType, @LingbaolidouString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 23); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LingbaolidouType", LingbaolidouType);
                    adapter.AddParameterToSelectCommand("@LingbaolidouString", LingbaolidouString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLingbaolidou_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Name2">祈福人姓名2。</param>
        /// <param name="Name3">祈福人姓名3。</param>
        /// <param name="Name4">祈福人姓名4。</param>
        /// <param name="Name5">祈福人姓名5。</param>
        /// <param name="Name6">祈福人姓名6。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="TaoistJiaoCeremonyType">七朝清醮項目。</param>
        /// <param name="TaoistJiaoCeremonyString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Sendback">是否寄回 (Y-是，N-否)。</param>
        /// <param name="rName">收件人姓名。</param>
        /// <param name="rMobile">收件人電話。</param>
        /// <param name="rAddr">收件人地址部分地址。</param>
        /// <param name="rCounty">收件人地址縣市。</param>
        /// <param name="rDist">收件人地址區域。</param>
        /// <param name="rZipCode">收件人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddTaoistJiaoCeremony_da(
            int ApplicantID,
            string Name,
            string Name2,
            string Name3,
            string Name4,
            string Name5,
            string Name6,
            string Mobile,
            int Cost,
            string Sex,
            string TaoistJiaoCeremonyType,
            string TaoistJiaoCeremonyString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Sendback,
            string rName,
            string rMobile,
            string rAddr,
            string rCounty,
            string rDist,
            string rZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;
                string fullrAddress = rCounty + (rDist == "*" ? "" : rDist) + rAddr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetTaoistJiaoCeremonyCost(3, TaoistJiaoCeremonyType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..TaoistJiaoCeremony_da_info
                    (
                        ApplicantID, AdminID, Name, Name2, Name3, Name4, Name5, Name6, Mobile, Cost, Sex, 
                        TaoistJiaoCeremonyType, TaoistJiaoCeremonyString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, 
                        Sendback, rName, rMobile, rAddress, rAddr, rCounty, rdist, rZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Name2, @Name3, @Name4, @Name5, @Name6, @Mobile, @Cost, @Sex, 
                        @TaoistJiaoCeremonyType, @TaoistJiaoCeremonyString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, 
                        @Sendback, @rName, @rMobile, @rAddress, @rAddr, @rCounty, @rdist, @rZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 3); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Name2", Name2);
                    adapter.AddParameterToSelectCommand("@Name3", Name3);
                    adapter.AddParameterToSelectCommand("@Name4", Name4);
                    adapter.AddParameterToSelectCommand("@Name5", Name5);
                    adapter.AddParameterToSelectCommand("@Name6", Name6);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@TaoistJiaoCeremonyType", TaoistJiaoCeremonyType);
                    adapter.AddParameterToSelectCommand("@TaoistJiaoCeremonyString", TaoistJiaoCeremonyString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Sendback", Sendback);
                    adapter.AddParameterToSelectCommand("@rName", rName);
                    adapter.AddParameterToSelectCommand("@rMobile", rMobile);
                    adapter.AddParameterToSelectCommand("@rAddress", fullrAddress);
                    adapter.AddParameterToSelectCommand("@rAddr", rAddr);
                    adapter.AddParameterToSelectCommand("@rCounty", rCounty);
                    adapter.AddParameterToSelectCommand("@rdist", rDist);
                    adapter.AddParameterToSelectCommand("@rZipCode", rZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddTaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LybcType">護國息災梁皇大法會項目。</param>
        /// <param name="LybcString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLybc_dh(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LybcType,
            string LybcString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Remark,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLybcCost(16, LybcType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lybc_dh_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LybcType, LybcString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, 
                        Count, Address, Addr, County, dist, ZipCode, Remark, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LybcType, @LybcString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, 
                        @Count, @Address, @Addr, @County, @dist, @ZipCode, @Remark, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 16); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LybcType", LybcType);
                    adapter.AddParameterToSelectCommand("@LybcString", LybcString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLybc_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="HuaguoType">
        /// 供花供果項目。
        /// 1-供花/次 
        /// 2-供果/次 
        /// 3-供花/月 
        /// 4-供果/月 
        /// 5-供花/半年 
        /// 6-供果/半年
        /// </param>
        /// <param name="HuaguoString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddHuaguo_wjsan(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string HuaguoType,
            string HuaguoString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetHuaguoCost(31, HuaguoType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Huaguo_wjsan_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        HuaguoType, HuaguoString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @HuaguoType, @HuaguoString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 31); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@HuaguoType", HuaguoType);
                    adapter.AddParameterToSelectCommand("@HuaguoString", HuaguoString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddHuaguo_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="LightsType">燈種代碼。</param>
        /// <br/>3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// <br/>4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// <br/>5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// <br/>6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// <br/>7-姻緣燈、桃花燈、月老桃花燈
        /// <br/>8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// <br/>9-財利燈 
        /// <br/>10-貴人燈 、特別貴人燈(石壁部堂)
        /// <br/>11-福祿燈、福壽燈 
        /// <br/>12-寵物平安燈 
        /// <br/>13-龍王燈 
        /// <br/>14-虎爺燈 
        /// <br/>15-轉運納福燈 
        /// <br/>16-光明燈上層、玉皇燈(五股賀聖宮)
        /// <br/>17-偏財旺旺燈 
        /// <br/>18-廣進安財庫 
        /// <br/>19-財庫燈 
        /// <br/>20-月老姻緣燈
        /// <br/>21-孝親祈福燈 
        /// <br/>22-事業燈、特別事業燈(石壁部堂)
        /// <br/>23-全家光明燈 
        /// <br/>24-觀音佛祖燈 
        /// <br/>25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// <br/>26-事業斗 
        /// <br/>27-平安斗 
        /// <br/>28-文昌斗 
        /// <br/>29-藥師斗 
        /// <br/>30-元神斗 
        /// <br/>31-福祿壽斗 
        /// <br/>32-觀音斗 
        /// <br/>33-明心智慧燈
        /// <br/>34-發財斗/一個月
        /// <br/>35-姻緣斗/一個月
        /// <br/>36-貴人斗/一個月
        /// <br/>37-消災延壽斗/一個月
        /// <br/>38-財神斗/三個月
        /// <br/>39-發財斗/三個月
        /// <br/>40-姻緣斗/三個月
        /// <br/>41-貴人斗/三個月
        /// <br/>42-消災延壽斗/三個月
        /// <br/>43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// <br/>44-求子燈
        /// <br/>45-護子燈
        /// <br/>46-添丁燈
        /// <br/>47-婚姻燈
        /// <br/>48-安太陰
        /// <br/>49-安太陽
        /// <param name="LightsString">燈種名稱。</param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddLights_ty_mom(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string LightsType,
            string LightsString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetLightsCost(14, LightsType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Lights_ty_mom_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        LightsType, LightsString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Email, Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @LightsType, @LightsString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Email, @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.AddParameterToSelectCommand("@LightsString", LightsString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddLights_ty_mom：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="BlessingType">祈安植福項目。</param>
        /// <param name="BlessingString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Email">祈福人信箱。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddBlessing_st(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string BlessingType,
            string BlessingString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            string Email,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetBlessingCost(35, BlessingType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..Blessing_st_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        BlessingType, BlessingString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, Email, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @BlessingType, @BlessingString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, @Email, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 35); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@BlessingType", BlessingType);
                    adapter.AddParameterToSelectCommand("@BlessingString", BlessingString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddBlessing_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立祈福人資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Name">祈福人姓名。</param>
        /// <param name="Mobile">祈福人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Sex">性別（善男、信女）。</param>
        /// <param name="QnLightType">祈安植福項目。</param>
        /// <param name="QnLightString"></param>
        /// <param name="Oversea">地址是否在國外（1=國內，2=國外）。</param>
        /// <param name="Birth">農曆生日。</param>
        /// <param name="LeapMonth">閏月（Y=是，N=否）。</param>
        /// <param name="BirthTime">農曆時辰。</param>
        /// <param name="BirthMonth">農曆月份。</param>
        /// <param name="Age">年齡。</param>
        /// <param name="Zodiac">生肖。</param>
        /// <param name="sBirth">國曆生日。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Remark">備註。</param>
        /// <param name="Addr">祈福人地址部分地址。</param>
        /// <param name="County">祈福人地址縣市。</param>
        /// <param name="Dist">祈福人地址區域。</param>
        /// <param name="ZipCode">祈福人地址郵遞區號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>回傳建立成功後的主鍵編號（Identity 值）。</returns>
        public int AddQnLight_ty(
            int ApplicantID,
            string Name,
            string Mobile,
            int Cost,
            string Sex,
            string QnLightType,
            string QnLightString,
            string Oversea,
            string Birth,
            string LeapMonth,
            string BirthTime,
            string BirthMonth,
            string Age,
            string Zodiac,
            string sBirth,
            int Count,
            string Remark,
            string Addr,
            string County,
            string Dist,
            string ZipCode,
            string Year)
        {
            int newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string fullAddress = County + (Dist == "*" ? "" : Dist) + Addr;

                // 計算金額（依燈種）
                //int cost = AjaxBasePage.GetQnLightCost(14, QnLightType);

                string sql = $@"
                    INSERT INTO Temple_{Year}..QnLight_ty_info
                    (
                        ApplicantID, AdminID, Name, Mobile, Cost, Sex, 
                        QnLightType, QnLightString, oversea, Birth, LeapMonth, 
                        BirthTime, BirthMonth, Age, Zodiac, sBirth, 
                        Count, Remark, Address, Addr, County, dist, ZipCode, CreateDate
                    )
                    VALUES
                    (
                        @ApplicantID, @AdminID, @Name, @Mobile, @Cost, @Sex, 
                        @QnLightType, @QnLightString, @oversea, @Birth, @LeapMonth, 
                        @BirthTime, @BirthMonth, @Age, @Zodiac, @sBirth, 
                        @Count, @Remark, @Address, @Addr, @County, @dist, @ZipCode, @CreateDate
                    )";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", 14); // 宮廟固定編號
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@Sex", Sex);
                    adapter.AddParameterToSelectCommand("@QnLightType", QnLightType);
                    adapter.AddParameterToSelectCommand("@QnLightString", QnLightString);
                    adapter.AddParameterToSelectCommand("@oversea", Oversea);
                    adapter.AddParameterToSelectCommand("@Birth", Birth);
                    adapter.AddParameterToSelectCommand("@LeapMonth", LeapMonth);
                    adapter.AddParameterToSelectCommand("@BirthTime", BirthTime);
                    adapter.AddParameterToSelectCommand("@BirthMonth", BirthMonth);
                    adapter.AddParameterToSelectCommand("@Age", Age);
                    adapter.AddParameterToSelectCommand("@Zodiac", Zodiac);
                    adapter.AddParameterToSelectCommand("@sBirth", sBirth);
                    adapter.AddParameterToSelectCommand("@Count", Count);
                    adapter.AddParameterToSelectCommand("@Remark", Remark);
                    adapter.AddParameterToSelectCommand("@Address", fullAddress);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@ZipCode", ZipCode);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    DataTable dtTemp = new DataTable();
                    adapter.SetSqlCommandBuilder();
                    adapter.Fill(dtTemp);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddQnLight_ty：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 建立交易流水表資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_EmperorGuansheng_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_EmperorGuansheng " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lingbaolidou_ma(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ma_Lingbaolidou " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_TaoistJiaoCeremony_da(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_da_TaoistJiaoCeremony " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lybc_dh(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_dh_Lybc " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lybc_dh：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 代燒金紙 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_BPO_jb(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_jb_BPO " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_BPO_jb：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Huaguo_wjsan(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_wjsan_Huaguo " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Huaguo_wjsan：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Lights_ty_mom(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_mom_Lights " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Lights_ty_mom：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_Blessing_st(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_st_Blessing " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_Blessing_st：\r\n" + detailedError);
            }

            return newId;
        }

        /// <summary>
        /// 建立交易流水表資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Amount">支付金額</param>
        /// <param name="ChargeType">支付方式</param>
        /// <param name="Status">狀態（0:待支付,1:成功,-1:錯誤,-2:已退款）</param>
        /// <param name="Description">支付說明</param>
        /// <param name="Comment">備註</param>
        /// <param name="PayChannelLog">支付介面日誌</param>
        /// <param name="IP">來源IP</param>
        /// <param name="Year">年度（資料庫分區）</param>
        /// <returns>回傳新增資料的自動編號（Identity）</returns>
        public long AddChargeLog_QnLight_ty(
            string OrderID,
            int ApplicantID,
            int Amount,
            string ChargeType,
            int Status,
            string Description,
            string Comment,
            string PayChannelLog,
            string IP,
            string Year)
        {
            long newId = 0;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"INSERT INTO Temple_{Year}..APPCharge_ty_QnLight " +
                             "(OrderID, ApplicantID, Amount, Status, Description, ChargeType, Comment, PayChannelLog, IP, CreateDate, CreateDateString) " +
                             "VALUES(@OrderID, @ApplicantID, @Amount, @Status, @Description, @ChargeType, @Comment, @PayChannelLog, @IP, @CreateDate, @CreateDateString)";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Amount", Amount);
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Description", Description);
                    adapter.AddParameterToSelectCommand("@ChargeType", ChargeType);
                    adapter.AddParameterToSelectCommand("@Comment", Comment);
                    adapter.AddParameterToSelectCommand("@PayChannelLog", PayChannelLog);
                    adapter.AddParameterToSelectCommand("@IP", IP);
                    adapter.AddParameterToSelectCommand("@CreateDate", dtNow);
                    adapter.AddParameterToSelectCommand("@CreateDateString", dtNow.ToString("yyyy-MM-dd"));

                    adapter.SetSqlCommandBuilder();
                    DataTable dtData = new DataTable();
                    adapter.Fill(dtData);

                    newId = adapter.GetLastIdentity();
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.AddChargeLog_QnLight_ty：\r\n" + detailedError);
            }

            return newId;
        }

        #endregion

        #endregion

        #endregion


        //==================================================
        #region 查詢 (Select / Query)
        //==================================================

        /// <summary>
        /// AdminID + Kind 對應 SQL 查詢語法的設定表
        /// </summary>
        private static readonly Dictionary<(int AdminID, int Kind), string> SqlMap =
            new Dictionary<(int, int), string>
        {
            // 大甲鎮瀾宮
            {(3, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_da_info Where ApplicantID = @aid"},
            {(3, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_da_info Where ApplicantID = @aid"},
            {(3, 13), "Select SUM(Cost) as Total from Temple_{0}..view_TaoistJiaoCeremony_da_info Where ApplicantID = @aid"},

            // 新港奉天宮
            {(4, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_h_info Where ApplicantID = @aid"},
            {(4, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_h_info Where ApplicantID = @aid"},

            // 商品販賣小舖
            {(5, 3), "Select SUM(Cost) as Total from Temple_{0}..view_ProductInfolist Where ApplicantID = @aid"},

            // 北港武德宮
            {(6, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_wu_info Where ApplicantID = @aid"},
            {(6, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_wu_info Where ApplicantID = @aid"},
            {(6, 4), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_wu_info Where ApplicantID = @aid"},
            {(6, 5), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_wu_info2 Where ApplicantID = @aid"},
            {(6, 6), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_wu_info3 Where ApplicantID = @aid"},

            // 西螺福興宮
            {(8, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_Fu_info Where ApplicantID = @aid"},
            {(8, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_Fu_info Where ApplicantID = @aid"},

            // 台南正統鹿耳門聖母廟
            {(10, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_Luer_info Where ApplicantID = @aid"},
            {(10, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_Luer_info Where ApplicantID = @aid"},

            // 桃園威天宮
            {(14, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_ty_info Where ApplicantID = @aid"},
            {(14, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_ty_info Where ApplicantID = @aid"},
            {(14, 7), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_ty_info Where ApplicantID = @aid"},         // 天赦日補運
            {(14, 9), "Select SUM(Cost) as Total from Temple_{0}..view_EmperorGuansheng_ty_info Where ApplicantID = @aid"}, // 關聖帝君聖誕
            {(14, 14), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies2_ty_info Where ApplicantID = @aid"},       // 九九重陽天赦日補運
            {(14, 18), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies3_ty_info Where ApplicantID = @aid"},       // 天公生招財補運
            {(14, 22), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_ty_mom_info Where ApplicantID = @aid"},      // 孝親祈福燈
            {(14, 25), "Select SUM(Cost) as Total from Temple_{0}..view_QnLight_ty_info Where ApplicantID = @aid"},         // 千手觀音千燈迎佛法會

            // 斗六五路財神宮
            {(15, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_Fw_info Where ApplicantID = @aid"},
            {(15, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_Fw_info Where ApplicantID = @aid"},
            {(15, 16), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_Fw_info Where ApplicantID = @aid"},        // 補財庫
            {(15, 20), "Select SUM(Cost) as Total from Temple_{0}..view_AnDou_Fw_info Where ApplicantID = @aid"},           // 安奉斗燈

            // 台東東海龍門天聖宮
            {(16, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_dh_info Where ApplicantID = @aid"},
            {(16, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_dh_info Where ApplicantID = @aid"},
            {(16, 11), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_dh_info Where ApplicantID = @aid"},        // 天貺納福添運法會
            {(16, 15), "Select SUM(Cost) as Total from Temple_{0}..view_Lybc_dh_info Where ApplicantID = @aid"},            // 護國息災梁皇大法會

            // 鹿港城隍廟
            {(21, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_Lk_info Where ApplicantID = @aid"},
            {(21, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_Lk_info Where ApplicantID = @aid"},
            {(21, 16), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_Lk_info Where ApplicantID = @aid"},        // 補財庫

            // 玉敕大樹朝天宮
            {(23, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_ma_info Where ApplicantID = @aid"},
            {(23, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_ma_info Where ApplicantID = @aid"},
            {(23, 7), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_ma_info Where ApplicantID = @aid"},         // 天赦日補運
            {(23, 12), "Select SUM(Cost) as Total from Temple_{0}..view_Lingbaolidou_ma_info Where ApplicantID = @aid"},    // 靈寶禮斗

            // 進寶財神廟
            {(29, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_jb_info Where ApplicantID = @aid"},
            {(29, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_jb_info Where ApplicantID = @aid"},
            {(29, 8), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_jb_info Where ApplicantID = @aid"},         // 天赦日祭改
            {(29, 10), "Select SUM(Cost) as Total from Temple_{0}..view_BPO_jb_info Where ApplicantID = @aid"},             // 代燒服務

            // 台灣道教總廟無極三清總道院
            {(31, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_wjsan_info Where ApplicantID = @aid"},
            {(31, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_wjsan_info Where ApplicantID = @aid"},
            {(31, 20), "Select SUM(Cost) as Total from Temple_{0}..view_AnDou_wjsan_info Where ApplicantID = @aid"},        // 安奉斗燈
            {(31, 21), "Select SUM(Cost) as Total from Temple_{0}..view_Huaguo_wjsan_info Where ApplicantID = @aid"},       // 供花供果

            // 桃園龍德宮
            {(32, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_ld_info Where ApplicantID = @aid"},
            {(32, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_ld_info Where ApplicantID = @aid"},

            // 神霄玉府財神會館
            {(33, 17), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies_sx_info Where ApplicantID = @aid"},        // 赦罪補庫 
            {(33, 19), "Select SUM(Cost) as Total from Temple_{0}..view_Supplies2_sx_info Where ApplicantID = @aid"},       // 供香轉運

            // 基隆悟玄宮
            {(34, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_wh_info Where ApplicantID = @aid"},
            {(34, 2), "Select SUM(Cost) as Total from Temple_{0}..view_Purdue_wh_info Where ApplicantID = @aid"},

            // 松柏嶺受天宮
            {(35, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_st_info Where ApplicantID = @aid"},
            {(35, 23), "Select SUM(Cost) as Total from Temple_{0}..view_Blessing_st_info Where ApplicantID = @aid"},        // 祈安植福
                
            // 池上北極玄天宮
            {(38, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_bj_info Where ApplicantID = @aid"},
            
            // 慈惠石壁部堂
            {(39, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_sbbt_info Where ApplicantID = @aid"},
            
            // 真武山受玄宮
            {(40, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_bpy_info Where ApplicantID = @aid"},
            
            // 壽山巖觀音寺
            {(41, 1), "Select SUM(Cost) as Total from Temple_{0}..view_Lights_ssy_info Where ApplicantID = @aid"}
        };


        #region 取得(GET)

        /// <summary>
        /// 取得目前台北時間。
        /// </summary>
        public static DateTime GetTaipeiNow()
        {
            TimeZoneInfo tz = TimeZoneInfo.FindSystemTimeZoneById("Taipei Standard Time");
            return TimeZoneInfo.ConvertTime(DateTime.Now, tz);
        }

        /// <summary>
        /// 取得宮廟列表 (Get admin list)
        /// </summary>
        /// <param name="Permission">權限等級。</param>
        /// <returns>回傳符合條件的宮廟資料表。</returns>
        public DataTable GetAdminList(int Permission)
        {
            try
            {
                DataTable dtGetData = new DataTable();
                string sql = "SELECT * FROM Admin WHERE Status = 0 AND Permission = @Permission";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Permission", Permission);
                    adapter.Fill(dtGetData);
                }

                return dtGetData;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAdminList：\r\n" + detailedError);
                throw;
            }
        }

        /// <summary>
        /// 取得 FET 對應商品編號資料 (Get FET mapped product code info)
        /// </summary>
        /// <returns>回傳符合條件的商品代碼資料表。</returns>
        public DataTable GetTempleCodeInfo()
        {
            try
            {
                DataTable dtGetData = new DataTable();
                string sql = "SELECT * FROM view_TempleCode WHERE Status = 0";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.Fill(dtGetData);
                }

                return dtGetData;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetTempleCodeInfo()：\r\n" + detailedError);
                throw;
            }
        }

        /// <summary>
        /// 取得 FET 對應商品編號資料 (Get FET mapped product code info)
        /// </summary>
        /// <param name="id">商品代碼（ProductCode）。</param>
        /// <returns>回傳符合條件的商品代碼資料表。</returns>
        public DataTable GetTempleCodeInfo(string id)
        {
            try
            {
                DataTable dtGetData = new DataTable();
                string sql = "SELECT * FROM view_TempleCode WHERE ProductCode = @Id";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Id", id);
                    adapter.Fill(dtGetData);
                }

                return dtGetData;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetTempleCodeInfo(id)：\r\n" + detailedError);
                throw;
            }
        }

        /// <summary>
        /// 從資料庫取得購買者的實際金額總和。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="Year">資料年度（例如："2025"）。</param>
        /// <returns>實際金額總和，若查無資料則回傳 0。</returns>
        public int GetApplicantTotal(
            int ApplicantID, 
            int AdminID, 
            int Kind, 
            string Year)
        {
            try
            {
                // 防止 SQL Injection：Year 只能是 4 位數
                if (!Regex.IsMatch(Year, @"^\d{4}$"))
                    throw new ArgumentException("Year format is invalid.");

                if (!SqlMap.TryGetValue((AdminID, Kind), out string sqlTemplate))
                    return 0;

                string sql = string.Format(sqlTemplate, Year);
                DataTable dtGetData = new DataTable();

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@aid", ApplicantID);
                    adapter.Fill(dtGetData);
                }

                if (dtGetData.Rows.Count > 0 &&
                    int.TryParse(dtGetData.Rows[0]["Total"].ToString(), out int dbTotal))
                {
                    return dbTotal;
                }

                return 0;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetApplicantTotal：\r\n" + detailedError);
                return 0;
            }
        }

        /// <summary>
        /// 依據宮廟代碼與活動種類，取得指定購買者最後建立資料時間。
        /// </summary>
        /// <param name="ApplicantID">購買人編號 (aid)。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="Type">類型代碼（例如威天宮有一般燈與活動燈）。</param>
        /// <param name="Year">資料年度（例如："2025"）。</param>
        /// <returns>回傳最後建立日期（若無資料則回傳當前時間）。</returns>
        public DateTime GetInfoLastDate(
            int ApplicantID, 
            int AdminID, 
            int Kind, 
            int Type, 
            string Year)
        {
            DateTime dtNow = GetTaipeiNow();

            try
            {
                string sql = GetApplicantInfoSql(ApplicantID, AdminID, Kind, Type, Year);

                if (string.IsNullOrWhiteSpace(sql))
                    return dtNow;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@aid", ApplicantID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && DateTime.TryParse(dt.Rows[0]["CreateDate"].ToString(), out DateTime parsed))
                        dtNow = parsed;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetInfoLastDate：\r\n" + detailedError);
            }

            return dtNow;
        }

        /// <summary>
        /// 依據宮廟編號與活動種類，產生對應的 SQL 查詢字串。
        /// </summary>
        /// <param name="ApplicantID">購買人編號 (aid)。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="Type">類型代碼（例如威天宮有一般燈與活動燈）。</param>
        /// <param name="Year">資料年度（例如："2025"）。</param>
        private string GetApplicantInfoSql(int ApplicantID, int AdminID, int Kind, int Type, string Year)
        {
            string sql = string.Empty;

            switch (AdminID)
            {
                case 3:
                    // 大甲鎮瀾宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_da_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_da_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 13:
                            // 七朝清醮
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_da_TaoistJiaoCeremony Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 4:
                    // 新港奉天宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_h_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_h_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 5:
                    // 商品販賣小舖
                    sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Product Where ApplicantID = @aid ORDER BY CreateDate DESC";
                    break;
                case 6:
                    // 北港武德宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wu_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wu_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 4:
                            // 下元補庫
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wu_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 5:
                            // 呈疏補庫(天官武財神聖誕補財庫) 
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wu_Supplies2 Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 6:
                            // 企業補財庫
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wu_Supplies3 Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 8:
                    // 西螺福興宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fu_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fu_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 10:
                    // 台南正統鹿耳門聖母廟
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Luer_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Luer_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 14:
                    // 桃園威天宮
                    switch (Kind)
                    {
                        case 1:
                            switch (Type)
                            {
                                case 1:
                                    // 一般點燈
                                    sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                                    break;
                                case 2:
                                    // 活動-孝親祈福燈
                                    sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_mom_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                                    break;
                            }
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 7:
                            // 天赦日補運
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 9:
                            // 關聖帝君聖誕
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_EmperorGuansheng Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 14:
                            // 九九重陽天赦日補運
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_Supplies2 Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 18:
                            // 天公生招財補運
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_Supplies3 Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 22:
                            // 孝親祈福燈
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_mom_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 25:
                            // 千手觀音千燈迎佛法會
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ty_QnLight Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 15:
                    // 斗六五路財神宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fw_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fw_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 16:
                            // 補財庫
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fw_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 20:
                            // 安斗
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Fw_AnDou Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 16:
                    // 台東東海龍門天聖宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_dh_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_dh_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 11:
                            // 天貺納福添運法會
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_dh_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 15:
                            // 護國息災梁皇大法會
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_dh_Lybc Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 17:
                    // 五股賀聖宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Hs_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 21:
                    // 鹿港城隍廟
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Lk_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Lk_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 16:
                            // 補財庫
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_Lk_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 23:
                    // 玉敕大樹朝天宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ma_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ma_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 7:
                            // 天赦日補運
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ma_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 12:
                            // 靈寶禮斗
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ma_Lingbaolidou Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 29:
                    // 進寶財神廟
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_jb_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_jb_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 8:
                            // 天赦日祭改
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_jb_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 31:
                    // 台灣道教總廟無極三清總道院
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wjsan_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wjsan_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 20:
                            // 安斗
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wjsan_AnDou Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 21:
                            // 供花供果
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wjsan_Huaguo Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 32:
                    // 桃園龍德宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ld_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ld_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 33:
                    // 神霄玉府財神會館
                    switch (Kind)
                    {
                        //case 1:
                        //    sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_sx_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                        //    break;
                        //case 2:
                        //    sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_sx_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                        //    break;
                        case 17:
                            // 赦罪補庫
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_sx_Supplies Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 19:
                            // 供香轉運
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_sx_Supplies2 Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 34:
                    // 基隆悟玄宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wh_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 2:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_wh_Purdue Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 35:
                    // 松柏嶺受天宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_st_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                        case 23:
                            // 祈安植福
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_st_Blessing Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 38:
                    // 池上北極玄天宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_bj_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 39:
                    // 慈惠石壁部堂
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_sbbt_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 40:
                    // 真武山受玄宮
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_bpy_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
                case 41:
                    // 壽山巖觀音寺
                    switch (Kind)
                    {
                        case 1:
                            sql = $"SELECT TOP 1 CreateDate FROM Temple_{Year}..ApplicantInfo_ssy_Lights Where ApplicantID = @aid ORDER BY CreateDate DESC";
                            break;
                    }
                    break;
            }

            return sql;
        }

        /// <summary>
        /// 計算新港奉天宮普度項目的總金額。
        /// </summary>
        /// <param name="Merit">功德主（1=是）。</param>
        /// <param name="Life">祝燈延壽消災（1=是）。</param>
        /// <param name="Redress">四十九願解冤釋結（1=是）。</param>
        /// <param name="Creditor">冤親債主（1=是）。</param>
        /// <param name="Ancestor">九玄七祖（1=是）。</param>
        /// <param name="Deceased">功德迴向往生者（1=是）。</param>
        /// <param name="Landlord">地祇主（1=是）。</param>
        /// <param name="LandlordNum">地祇主數量。</param>
        /// <param name="Baby">嬰靈（1=是）。</param>
        /// <param name="BabyNum">嬰靈數量。</param>
        /// <param name="Animal">動物靈（1=是）。</param>
        /// <param name="AnimalNum">動物靈數量。</param>
        /// <param name="PurdueNum">普頓品數量。</param>
        /// <param name="RiceNum">白米數量。</param>
        /// <param name="mMoneyNum">金紙數量。</param>
        /// <returns>回傳總金額。</returns>
        public int GetTotal_h(
            string Merit,
            string Life,
            string Redress,
            string Creditor,
            string Ancestor,
            string Deceased,
            string Landlord,
            string LandlordNum,
            string Baby,
            string BabyNum,
            string Animal,
            string AnimalNum,
            string PurdueNum,
            string RiceNum,
            string mMoneyNum)
        {
            int result = 0;

            try
            {
                // 功德主 $3000
                if (Merit == "1") result += 3000;

                // 祝燈延壽消災 $600
                if (Life == "1") result += 600;

                // 四十九願解冤釋結 $600
                if (Redress == "1") result += 600;

                // 冤親債主 $500
                if (Creditor == "1") result += 500;

                // 九玄七祖 $500
                if (Ancestor == "1") result += 500;

                // 功德迴向往生者 $500
                if (Deceased == "1") result += 500;

                // 地祇主 $500/位
                if (Landlord == "1" && int.TryParse(LandlordNum, out int landlordCount))
                    result += 500 * landlordCount;

                // 嬰靈 $500/位
                if (Baby == "1" && int.TryParse(BabyNum, out int babyCount))
                    result += 500 * babyCount;

                // 動物靈 $500/位
                if (Animal == "1" && int.TryParse(AnimalNum, out int animalCount))
                    result += 500 * animalCount;

                // 普頓品 $1000/份
                if (int.TryParse(PurdueNum, out int pCount))
                    result += 1000 * pCount;

                // 白米 $200/包
                if (int.TryParse(RiceNum, out int rCount))
                    result += 200 * rCount;

                // 金紙 $200/份
                if (int.TryParse(mMoneyNum, out int mCount))
                    result += 200 * mCount;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetTotal_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得付款資料 (安全版)
        /// </summary>
        /// <param name="Transaction_id">交易編號</param>
        /// <param name="AdminID">宮廟編號編號。</param>
        /// <param name="Kind">
        /// kind = 活動類別：
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// </param>
        /// <param name="Type">部分宮廟活動使用的分類型別 (例如桃園威天宮孝親祈福燈為 type = 2)</param>
        /// <param name="Year">年度 (資料表年度)</param>
        /// <returns>回傳符合條件的 DataTable，若查無資料則回傳空表</returns>
        public DataTable Getappcharge(
            string Transaction_id, 
            string AdminID, 
            string Kind, 
            int Type, 
            string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = string.Empty;

                switch (Kind)
                {
                    case "1":
                        // 點燈
                        switch (AdminID)
                        {
                            case "3":
                                // 大甲鎮瀾宮
                                sql = $"Select * from Temple_{Year}..view_Lights_da_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "4":
                                // 新港奉天宮
                                sql = $"Select * from Temple_{Year}..view_Lights_h_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "6":
                                // 北港武德宮
                                sql = $"Select * from Temple_{Year}..view_Lights_wu_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "8":
                                // 西螺福興宮
                                sql = $"Select * from Temple_{Year}..view_Lights_Fu_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "10":
                                // 台南正統鹿耳門聖母廟
                                sql = $"Select * from Temple_{Year}..view_Lights_Luer_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "14":
                                // 桃園威天宮
                                if (Type == 2)
                                    sql = $"Select * from Temple_{Year}..view_Lights_ty_mom_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                else
                                    sql = $"Select * from Temple_{Year}..view_Lights_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "15":
                                // 斗六五路財神宮
                                sql = $"Select * from Temple_{Year}..view_Lights_Fw_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "16":
                                // 台東東海龍門天聖宮
                                sql = $"Select * from Temple_{Year}..view_Lights_dh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "21":
                                // 鹿港城隍廟
                                sql = $"Select * from Temple_{Year}..view_Lights_Lk_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "23":
                                // 玉敕大樹朝天宮
                                sql = $"Select * from Temple_{Year}..view_Lights_ma_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "29":
                                // 進寶財神廟
                                sql = $"Select * from Temple_{Year}..view_Lights_jb_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "31":
                                // 台灣道教總廟無極三清總道院
                                sql = $"Select * from Temple_{Year}..view_Lights_wjsan_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "32":
                                // 桃園龍德宮
                                sql = $"Select * from Temple_{Year}..view_Lights_ld_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "34":
                                // 基隆悟玄宮
                                sql = $"Select * from Temple_{Year}..view_Lights_wh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "35":
                                // 松柏嶺受天宮
                                sql = $"Select * from Temple_{Year}..view_Lights_st_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "38":
                                // 池上北極玄天宮
                                sql = $"Select * from Temple_{Year}..view_Lights_bj_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "39":
                                // 慈惠石壁部堂
                                sql = $"Select * from Temple_{Year}..view_Lights_sbbt_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "40":
                                // 真武山受玄宮
                                sql = $"Select * from Temple_{Year}..view_Lights_bpy_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "41":
                                // 壽山巖觀音寺
                                sql = $"Select * from Temple_{Year}..view_Lights_ssy_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "2":
                        // 普度
                        switch (AdminID)
                        {
                            case "3":
                                // 大甲鎮瀾宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_da_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "4":
                                // 新港奉天宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_h_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "6":
                                // 北港武德宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_wu_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "8":
                                // 西螺福興宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_Fu_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "10":
                                // 台南正統鹿耳門聖母廟
                                sql = $"Select * from Temple_{Year}..view_Purdue_Luer_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "15":
                                // 斗六五路財神宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_Fw_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "16":
                                // 台東東海龍門天聖宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_dh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "21":
                                // 鹿港城隍廟
                                sql = $"Select * from Temple_{Year}..view_Purdue_Lk_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "23":
                                // 玉敕大樹朝天宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_ma_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "29":
                                // 進寶財神廟
                                sql = $"Select * from Temple_{Year}..view_Purdue_jb_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "31":
                                // 台灣道教總廟無極三清總道院
                                sql = $"Select * from Temple_{Year}..view_Purdue_wjsan_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "32":
                                // 桃園龍德宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_ld_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "34":
                                // 基隆悟玄宮
                                sql = $"Select * from Temple_{Year}..view_Purdue_wh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "3":
                        // 商品小舖
                        switch (AdminID)
                        {
                            case "5":
                                // 文創商品-新港奉天宮
                                sql = $"Select * from Temple_{Year}..view_ProductInfolistwithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "7":
                                // 繞境商品小舖
                                sql = $"Select * from Temple_{Year}..view_Product_PilgrimagewithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "11":
                                // 錢母商品小舖
                                sql = $"Select * from Temple_{Year}..view_Product_MoneymotherwithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "20":
                                // 文創商品-西螺福興宮
                                sql = $"Select * from Temple_{Year}..view_ProductInfolistwithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "22":
                                // 文創商品-流金富貴商品小舖
                                sql = $"Select * from Temple_{Year}..view_ProductInfolistwithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "28":
                                // 文創商品-財神小舖商品小舖
                                sql = $"Select * from Temple_{Year}..view_ProductInfolistwithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "4":
                        // 下元補庫
                        switch (AdminID)
                        {
                            case "6":
                                // 北港武德宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;

                        if (!string.IsNullOrEmpty(sql))
                        {
                            using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                            {
                                adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                                adapter.Fill(dtGetData);
                            }
                        }
                    case "5":
                        // 呈疏補庫(天官武財神聖誕補財庫)
                        switch (AdminID)
                        {
                            case "6":
                                // 北港武德宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge2 Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "6":
                        // 企業補財庫
                        switch (AdminID)
                        {
                            case "6":
                                // 北港武德宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge3 Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "7":
                        // 天赦日招財補運
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "23":
                                // 玉敕大樹朝天宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_ma_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "8":
                        // 天赦日祭改
                        switch (AdminID)
                        {
                            case "29":
                                // 進寶財神廟
                                sql = $"Select * from Temple_{Year}..view_Supplies_jb_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "9":
                        // 關聖帝君聖誕
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_EmperorGuansheng_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "10":
                        // 代燒金紙
                        switch (AdminID)
                        {
                            case "29":
                                // 進寶財神廟
                                sql = $"Select * from Temple_{Year}..view_BPO_jb_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "11":
                        // 天貺納福添運法會
                        switch (AdminID)
                        {
                            case "16":
                                // 台東東海龍門天聖宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_dh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "12":
                        // 靈寶禮斗
                        switch (AdminID)
                        {
                            case "23":
                                // 玉敕大樹朝天宮
                                sql = $"Select * from Temple_{Year}..view_Lingbaolidou_ma_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "13":
                        // 七朝清醮
                        switch (AdminID)
                        {
                            case "3":
                                // 大甲鎮瀾宮
                                sql = $"Select * from Temple_{Year}..view_TaoistJiaoCeremony_da_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "14":
                        // 九九重陽天赦日招財補運
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_Supplies2_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "15":
                        // 護國息災梁皇大法會
                        switch (AdminID)
                        {
                            case "16":
                                // 台東東海龍門天聖宮
                                sql = $"Select * from Temple_{Year}..view_Lybc_dh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "16":
                        // 補財庫
                        switch (AdminID)
                        {
                            case "15":
                                // 斗六五路財神宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_Fw_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "21":
                                // 鹿港城隍廟
                                sql = $"Select * from Temple_{Year}..view_Supplies_Lk_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "17":
                        // 赦罪補庫
                        switch (AdminID)
                        {
                            case "33":
                                // 神霄玉府財神會館
                                sql = $"Select * from Temple_{Year}..view_Supplies_sx_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "18":
                        // 天公生招財補運
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_Supplies3_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "19":
                        // 供香轉運
                        switch (AdminID)
                        {
                            case "33":
                                // 神霄玉府財神會館
                                sql = $"Select * from Temple_{Year}..view_Supplies2_sx_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "20":
                        // 安斗
                        switch (AdminID)
                        {
                            case "15":
                                // 斗六五路財神宮
                                sql = $"Select * from Temple_{Year}..view_AnDou_Fw_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                            case "31":
                                // 台灣道教總廟無極三清總道院
                                sql = $"Select * from Temple_{Year}..view_AnDou_wjsan_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "21":
                        // 供花供果
                        switch (AdminID)
                        {
                            case "31":
                                // 台灣道教總廟無極三清總道院
                                sql = $"Select * from Temple_{Year}..view_Huaguo_wjsan_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "22":
                        // 孝親祈福燈
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_Lights_ty_mom_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "23":
                        // 祈安植福
                        switch (AdminID)
                        {
                            case "35":
                                // 松柏嶺受天宮
                                sql = $"Select * from Temple_{Year}..view_Blessing_st_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "24":
                        // 祈安禮斗
                        switch (AdminID)
                        {
                            case "34":
                                // 基隆悟玄宮
                                sql = $"Select * from Temple_{Year}..view_Supplies_wh_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                    case "25":
                        // 千手觀音千燈迎佛法會
                        switch (AdminID)
                        {
                            case "14":
                                // 桃園威天宮
                                sql = $"Select * from Temple_{Year}..view_QnLight_ty_InfowithAPPCharge Where AppcStatus = 1 and Transaction_id = @Transaction_id";
                                break;
                        }
                        break;
                }

                if (!string.IsNullOrEmpty(sql))
                {
                    using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.Fill(dtGetData);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getappcharge：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得指定訂單對應的發票紀錄（ApplicantID + AdminID + Kind）
        /// </summary>
        /// <param name="ApplicantId">購買人編號。</param>
        /// <param name="AdminId">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// <param name="Year">年度資料表。</param>
        /// <returns>
        /// 回傳 DataTable（若有資料），否則回傳 null。
        /// </returns>
        public DataTable GetInvoiceDetail(
            int ApplicantId,
            int AdminId,
            int Kind,
            string Year)
        {
            DataTable dtResult = new DataTable();

            string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..InvoiceDetail
                        WHERE ApplicantID = @ApplicantID
                          AND AdminID = @AdminID
                          AND Kind = @Kind";


            using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
            {
                adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantId);
                adapter.AddParameterToSelectCommand("@AdminID", AdminId);
                adapter.AddParameterToSelectCommand("@Kind", Kind);
                adapter.Fill(dtResult);
            }

            return dtResult;
        }


        #region 點燈資料查詢 (Lights)

        #region 購買人資料查詢 (ApplicantInfo)

        /// <summary>
        /// 取得購買人資料 - 點燈
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_LightsInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = string.Empty;
                switch (AdminID)
                {
                    case 3:
                        // 大甲鎮瀾宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_da_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 4:
                        // 新港奉天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_h_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 6:
                        // 北港武德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_wu_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 8:
                        // 西螺福興宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_Fu_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 10:
                        // 台南正統鹿耳門聖母廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_Luer_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 14:
                        // 桃園威天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_ty_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 15:
                        // 斗六五路財神宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_Fw_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 16:
                        // 台東東海龍門天聖宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_dh_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 17:
                        // 五股賀聖宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_Hs_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 21:
                        // 鹿港城隍廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_Lk_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 23:
                        // 玉敕大樹朝天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_ma_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 29:
                        // 進寶財神廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_jb_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 31:
                        // 台灣道教總廟無極三清總道院
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_wjsan_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 32:
                        // 桃園龍德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_ld_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 34:
                        // 基隆悟玄宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_wh_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 35:
                        // 松柏嶺受天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_st_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 38:
                        // 池上北極玄天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_bj_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 39:
                        // 慈惠石壁部堂
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_sbbt_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 40:
                        // 真武山受玄宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_bpy_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 41:
                        // 壽山巖觀音寺
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Lights_ssy_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                }

                if (string.IsNullOrWhiteSpace(sql))
                    return dtResult;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_LightsInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        #endregion

        #region 祈福人資料查詢 (LightsInfo)

        /// <summary>
        /// 取得點燈資料 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_da_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_da_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_da_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_h_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_h_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_h_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_wu_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wu_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_wu_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_Fu_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Fu_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_Fu_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_Luer_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Luer_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_Luer_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_Fw_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Fw_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_Fw_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_dh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_dh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_dh_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_Hs_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Hs_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_Hs_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_Lk_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Lk_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_Lk_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_ma_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ma_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_ma_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_jb_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_jb_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_jb_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_wjsan_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wjsan_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_wjsan_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_ld_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ld_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_ld_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_wh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_wh_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_st_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_st_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_st_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_bj_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_bj_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_bj_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_sbbt_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_sbbt_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_sbbt_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_bpy_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_bpy_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_bpy_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_ssy_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ssy_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_ssy_Info：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 交易流水資料查詢 (APPChargeInfo)

        /// <summary>
        /// 取得點燈資料 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_da_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_da_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_da_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_h_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_h_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_h_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wu_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wu_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wu_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Fu_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Fu_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fu_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Luer_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Luer_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Luer_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ty_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ty_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Fw_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Fw_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fw_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_dh_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_dh_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_dh_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Hs_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Hs_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Hs_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Lk_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_Lk_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Lk_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ma_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ma_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ma_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_jb_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_jb_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_jb_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wjsan_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wjsan_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wjsan_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ld_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ld_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ld_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wh_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_wh_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wh_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_st_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_st_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_st_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_bj_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_bj_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_bj_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_sbbt_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_sbbt_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_sbbt_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_bpy_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_bpy_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_bpy_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得點燈資料 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ssy_Lights(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ssy_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ssy_Lights：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得 APPCharge_da_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_da(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_da：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_h_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_h(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_h_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_h：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wu_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_wu(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_wu：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Fu_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_Fu(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fu_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_Fu：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Luer_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_Luer(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Luer_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_Luer：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Fw_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_Fw(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_Fw：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_dh_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_dh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_dh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Hs_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_Hs(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Hs_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_Hs：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Lk_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_Lk(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_Lk：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ma_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_ma(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_ma：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_jb_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_jb(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_jb：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wjsan_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_wjsan(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_wjsan：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ld_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_ld(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ld_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_ld：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wh_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_wh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_wh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_st_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_st(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_st_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_st：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_bj_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_bj(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_bj_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_bj：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_sbbt_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_sbbt(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sbbt_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_sbbt：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_bpy_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_bpy(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_bpy_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_bpy：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ssy_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_ssy(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ssy_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_ssy：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得服務項目 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_da(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_da_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_h(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_h_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_wu(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_wu_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_Fu(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_Fu_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_Luer(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_Luer_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_ty(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_ty_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_Fw(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_Fw_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_dh(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_dh_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_Hs(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_Hs_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_Hs：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_Lk(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_Lk_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_ma(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_ma_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_jb(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_jb_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_jb：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_wjsan(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_wjsan_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_ld(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_ld_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_ld：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_wh(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_wh_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_wh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_st(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_st_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_bj(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_bj_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_bj：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_sbbt(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_sbbt_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_sbbt：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_bpy(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_bpy_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_bpy：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_ssy(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_ssy_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_ssy：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #endregion

        #region 普度資料查詢 (Purdue)

        #region 購買人資料查詢 (ApplicantInfo)

        /// <summary>
        /// 取得購買人資料 - 普度
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_PurdueInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = string.Empty;
                switch (AdminID)
                {
                    case 3:
                        // 大甲鎮瀾宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_da_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 4:
                        // 新港奉天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_h_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 6:
                        // 北港武德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_wu_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 8:
                        // 西螺福興宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_Fu_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 10:
                        // 台南正統鹿耳門聖母廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_Luer_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 14:
                        // 桃園威天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_ty_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 15:
                        // 斗六五路財神宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_Fw_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 16:
                        // 台東東海龍門天聖宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_dh_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 21:
                        // 鹿港城隍廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_Lk_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 23:
                        // 玉敕大樹朝天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_ma_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 31:
                        // 台灣道教總廟無極三清總道院
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_wjsan_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 32:
                        // 桃園龍德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_ld_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 34:
                        // 基隆悟玄宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Purdue_wh_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                }

                if (string.IsNullOrWhiteSpace(sql))
                    return dtResult;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_AnDouInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        #endregion

        #region 祈福人資料查詢 (PurdueInfo)

        /// <summary>
        /// 取得普度資料 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_da_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_da_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_da_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_h_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_h_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_h_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_wu_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wu_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_wu_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_Fu_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Fu_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_Fu_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_Luer_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Luer_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_Luer_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_Fw_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Fw_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_Fw_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_dh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_dh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_dh_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_Lk_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Lk_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_Lk_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_ma_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ma_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_ma_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_wjsan_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wjsan_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_wjsan_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_ld_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ld_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_ld_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getpurdue_wh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getpurdue_wh_Info：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 交易流水資料查詢 (APPChargeInfo)

        /// <summary>
        /// 取得普度資料 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_da_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_da_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_da_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_h_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_h_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_h_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wu_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wu_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wu_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Fu_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Fu_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fu_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Luer_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Luer_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Luer_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ty_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ty_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Fw_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Fw_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fw_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_dh_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_dh_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_dh_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Lk_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_Lk_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Lk_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ma_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ma_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ma_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_jb_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_jb_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_jb_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wjsan_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wjsan_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wjsan_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_ld_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_ld_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ld_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得普度資料 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於普度紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wh_Purdue(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Purdue_wh_InfowithAPPCharge WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0  AND Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wh_Purdue：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得 APPCharge_da_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_da(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_da：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_h_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_h(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_h_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_h：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wu_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_wu(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_wu：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Fu_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_Fu(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fu_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_Fu：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Luer_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_Luer(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Luer_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_Luer：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Fw_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_Fw(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_Fw：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_dh_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_dh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_dh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Lk_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_Lk(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_Lk：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ma_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_ma(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_ma：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_jb_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_jb(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_jb：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wjsan_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_wjsan(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_wjsan：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ld_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_ld(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ld_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_ld：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wh_Purdue 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Purdue_wh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Purdue_wh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得服務項目 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_da(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_da_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_h(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_h_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_wu(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_wu_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_Fu(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_Fu_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_Luer(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_Luer_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_ty(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_ty_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_Fw(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_Fw_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_dh(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_dh_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_Lk(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_Lk_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_ma(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_ma_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_jb(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_jb_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_jb：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_wjsan(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_wjsan_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_ld(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_ld_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_ld：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 PurdueType，若無資料則回傳 0。</returns>
        public int GetPurdueType_wh(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Purdue_wh_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["PurdueType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetPurdueType_wh：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #endregion

        #region 商品小舖資料查詢 (Product)

        /// <summary>
        /// 根據購買人編號取得錢母擺件商品小舖的有效資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含錢母擺件商品小舖資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable GetProduct_Moneymother(
            int ApplicantID, 
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Product_MoneymotherwithAPPCharge 
                    WHERE AppcStatus = 1 
                      AND AppStatus = 2 
                      AND Num > 0 
                      AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetProduct_Moneymother(ApplicantID)：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 根據購買人編號與商品種類，取得錢母擺件商品小舖的有效資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Type">商品種類代碼。<br/>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含指定購買人及商品種類的錢母擺件商品小舖資料 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable GetProduct_Moneymother(
            int ApplicantID, 
            int Type, 
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Product_MoneymotherwithAPPCharge 
                    WHERE AppcStatus = 1 
                      AND AppStatus = 2 
                      AND Num > 0 
                      AND ApplicantID = @ApplicantID 
                      AND Type = @Type";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@Type", Type);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetProduct_Moneymother(ApplicantID, Type)：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 根據購買人姓名、電話、宮廟編號，取得文創商品小舖的有效購買紀錄。
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買紀錄的 <see cref="DataTable"/>。
        /// 若查無資料，則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_Product(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_ProductInfolistwithAPPCharge 
                    WHERE AppStatus = 2 
                    AND AppcStatus = 1 
                    AND AdminID = @AdminID 
                    AND Mobile = @Mobile 
                    AND Name = @Name";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_Product(Name, Mobile, AdminID)：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 根據購買人姓名與電話，取得錢母擺件商品小舖的有效購買紀錄。
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買紀錄的 <see cref="DataTable"/>。
        /// 若查無資料，則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_Moneymother(
            string Name, 
            string Mobile, 
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Product_MoneymotherwithAPPCharge 
                    WHERE AppStatus = 2 
                    AND AppcStatus = 1 
                    AND AppMobile = @Mobile 
                    AND AppName = @Name";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_Moneymother(Name, Mobile)：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 根據購買人編號與宮廟編號，取得錢母擺件商品小舖的有效購買資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟（或廠商）編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含錢母擺件商品小舖購買資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空表。
        /// </returns>
        public DataTable Getapplicantinfo_Moneymother(
            int ApplicantID, 
            int AdminID, 
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT *
                    FROM Temple_{Year}..view_Product_MoneymotherwithAPPCharge
                    WHERE AppStatus = 2
                      AND Num > 0
                      AND AppcStatus = 1
                      AND ApplicantID = @ApplicantID
                      AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_Moneymother(ApplicantID, AdminID)：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得 APPCharge_Product 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Product(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Product
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Product：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Moneymother 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Moneymother(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Moneymother
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Moneymother：\r\n" + detailedError);
            }

            return dtDataList;
        }

        #endregion

        #region 法會資料查詢 (Supplies)

        #region 購買人資料建立 (ApplicantInfo)

        /// <summary>
        /// 取得購買人資料 - 法會
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="SuppliesType">法會類型。</param>
        /// 1-下元補庫 - 北港武德宮
        /// 2-呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// 3-企業補財庫 - 北港武德宮
        /// 4-天赦日招財補運 
        /// 5-天赦日祭改 
        /// 6-天貺納福添運法會
        /// 71-九九重陽天赦日補運 - 桃園威天宮
        /// 7-招財補運 
        /// 8-招財補運九九重陽升級版 
        /// 9-補財庫 
        /// 10-財神賜福-消災補庫法會 
        /// 111-赦罪補庫 - 神霄玉府財神會館
        /// 11-地母廟-赦罪解業
        /// 12-地母廟-補財庫 
        /// 13-地母廟-赦罪解業+補財庫 
        /// 14-草屯敦和宮-赦罪解業 
        /// 15-草屯敦和宮-補財庫 
        /// 16-草屯敦和宮-赦罪解業+補財庫 
        /// 17-紫南宮-赦罪解業 
        /// 18-紫南宮-補財庫
        /// 19-紫南宮-赦罪解業+補財庫 
        /// 20-天公生招財補運 - 桃園威天宮
        /// 21-補財庫(正財) 
        /// 22-補財庫(偏財) 
        /// 231-供香轉運 - 神霄玉府財神會館
        /// 23-烏日神霄玉府/沉香每台斤 
        /// 24-草屯敦和宮/沉香每台斤
        /// 25-竹山紫南宮/沉香每台斤
        /// 26-竹山金天宮（老袓廟）/沉香每台斤
        /// 27-埔里地母廟/沉香每台斤
        /// 28-松柏嶺受天宮/沉香每台斤
        /// 29-祈安禮斗
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_SuppliesInfo(
            string Name,
            string Mobile,
            int AdminID,
            int SuppliesType,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = string.Empty;
                switch (SuppliesType)
                {
                    case 1:
                        // 下元補庫-北港武德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 2:
                        // 呈疏補庫(天官武財神聖誕補財庫)-北港武德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge2 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 3:
                        // 企業補財庫-北港武德宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge3 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 4:
                        // 天赦日招財補運
                        switch (AdminID)
                        {
                            case 14:
                                // 桃園威天宮
                                sql = $@"
                                    SELECT * 
                                    FROM Temple_{Year}..view_Supplies_ty_InfowithAPPCharge 
                                    WHERE Num > 0 
                                      AND AppStatus = 2 
                                      AND AppcStatus = 1 
                                      AND Status = 0 
                                      AND AdminID = @AdminID 
                                      AND AppName = @Name 
                                      AND AppMobile = @Mobile";
                                break;
                            case 23:
                                // 玉敕大樹朝天宮
                                sql = $@"
                                    SELECT * 
                                    FROM Temple_{Year}..view_Supplies_ma_InfowithAPPCharge 
                                    WHERE Num > 0 
                                      AND AppStatus = 2 
                                      AND AppcStatus = 1 
                                      AND Status = 0 
                                      AND AdminID = @AdminID 
                                      AND AppName = @Name 
                                      AND AppMobile = @Mobile";
                                break;
                        }
                        break;
                    case 5:
                        // 天赦日祭改-進寶財神廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_jb_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND SuppliesType = 5 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 71:
                        // 九九重陽天赦日補運-桃園威天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies2_ty_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 9:
                        // 補財庫
                        switch (AdminID)
                        {
                            case 15:
                                // 斗六五路財神宮
                                sql = $@"
                                    SELECT * 
                                    FROM Temple_{Year}..view_Supplies_Fw_InfowithAPPCharge 
                                    WHERE Num > 0 
                                      AND AppStatus = 2 
                                      AND AppcStatus = 1 
                                      AND Status = 0 
                                      AND AdminID = @AdminID 
                                      AND AppName = @Name 
                                      AND AppMobile = @Mobile";
                                break;
                            case 21:
                                // 鹿港城隍廟
                                sql = $@"
                                    SELECT * 
                                    FROM Temple_{Year}..view_Supplies_Lk_InfowithAPPCharge 
                                    WHERE Num > 0 
                                      AND AppStatus = 2 
                                      AND AppcStatus = 1 
                                      AND Status = 0 
                                      AND AdminID = @AdminID 
                                      AND AppName = @Name 
                                      AND AppMobile = @Mobile";
                                break;
                        }
                        break;
                    case 10:
                        // 財神賜福-消災補庫法會-進寶財神廟
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_jb_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND SuppliesType = 10 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 111:
                        // 赦罪補庫-神霄玉府財神會館
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_sx_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 231:
                        // 供香轉運-神霄玉府財神會館
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies2_sx_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 20:
                        // 天公生招財補運-桃園威天宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies3_ty_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 29:
                        // 祈安禮斗-基隆悟玄宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_Supplies_wh_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                }

                if (string.IsNullOrWhiteSpace(sql))
                    return dtResult;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_SuppliesInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        #endregion

        #region 祈福人資料建立 (SuppliesInfo)

        /// <summary>
        /// 取得下元補庫資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_wu_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_wu_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得呈疏補庫(天官武財神聖誕補財庫)資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_wu_Info2(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_info2 WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_wu_Info2：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得企業補財庫資料 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_wu_Info3(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_info3 WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_wu_Info3：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得天赦日招財補運資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得九九重陽天赦日招財補運資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies2_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies2_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies2_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得天公生招財補運資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies3_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies3_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies3_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得補財庫資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_Fw_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_Fw_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_Fw_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得天貺納福添運法會資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_dh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_dh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_dh_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得補財庫資料 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_Lk_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_Lk_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_Lk_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得天赦日招財補運資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_ma_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_ma_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_ma_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得赦罪補庫資料 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies_sx_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_sx_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies_sx_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得供香轉運資料 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getsupplies2_sx_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies2_sx_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getsupplies2_sx_Info：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 交易流水資料建立 (APPChargeInfo)

        /// <summary>
        /// 取得付款資料 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_wu_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wu_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 呈疏補庫(天官武財神聖誕補財庫)  - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_wu_Supplies2(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge2 " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wu_Supplies2：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_wu_Supplies3(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_wu_InfowithAPPCharge3 " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wu_Supplies3：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_ty_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_Supplies2(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies2_ty_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_Supplies2：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_Supplies3(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies3_ty_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_Supplies3：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_Fw_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_Fw_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fw_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_dh_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_dh_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_dh_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_Lk_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_Lk_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Lk_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ma_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_ma_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ma_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_sx_Supplies(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies_sx_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_sx_Supplies：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_sx_Supplies2(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Supplies2_sx_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_sx_Supplies2：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得 APPCharge_wu_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_wu(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_wu：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wu_Supplies2 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_wu2(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_wu2：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wu_Supplies3 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_wu3(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies3
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_wu3：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_Supplies2 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies2_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies2_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_Supplies3 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies3_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies3
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies3_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Fw_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_Fw(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_Fw：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_dh_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_dh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_dh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_Lk_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_Lk(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_Lk：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ma_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_ma(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_ma：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_jb_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_jb(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_jb：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_sx_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_sx(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sx_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_sx：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_sx_Supplies2 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies2_sx(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sx_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies2_sx：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wh_Supplies 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Supplies_wh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Supplies_wh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        #endregion

        #endregion

        #region 安斗資料查詢 (AnDou)

        #region 購買人資料查詢 (ApplicantInfo)

        /// <summary>
        /// 取得購買人資料 - 安斗 - (斗六五路財神宮、台灣道教總廟無極三清總道院)
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_AnDouInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = string.Empty;
                switch (AdminID)
                {
                    case 15:
                        // 斗六五路財神宮
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_AnDou_Fw_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                    case 31:
                        // 台灣道教總廟無極三清總道院
                        sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_AnDou_wjsan_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND AdminID = @AdminID 
                              AND AppName = @Name 
                              AND AppMobile = @Mobile";
                        break;
                }

                if (string.IsNullOrWhiteSpace(sql))
                    return dtResult;

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_AnDouInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        #endregion

        #region 祈福人資料查詢 (AnDouInfo)

        /// <summary>
        /// 取得安斗資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getandou_Fw_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Andou_Fw_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getandou_Fw_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得安斗資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getandou_wjsan_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_AnDou_wjsan_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getandou_wjsan_Info：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 交易流水資料查詢 (APPChargeInfo)

        /// <summary>
        /// 取得安斗資料 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_Fw_AnDou(
            int ApplicantID, 
            string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_AnDou_Fw_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_Fw_AnDou：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得安斗資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetAPPCharge_wjsan_AnDou(
            int ApplicantID, 
            string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $@"
                            SELECT * 
                            FROM Temple_{Year}..view_AnDou_wjsan_InfowithAPPCharge 
                            WHERE Num > 0 
                              AND AppStatus = 2 
                              AND AppcStatus = 1 
                              AND Status = 0 
                              AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wjsan_AnDou：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得 APPCharge_Fw_AnDou 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_AnDou_Fw(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_AnDou
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_AnDou_Fw：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wjsan_AnDou 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_AnDou_wjsan(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_AnDou
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_AnDou_wjsan：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得服務項目 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 AnDouType，若無資料則回傳 0。</returns>
        public int GetAnDouType_Fw(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..AnDou_Fw_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["AnDouType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAnDouType_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 AnDouType，若無資料則回傳 0。</returns>
        public int GetAnDouType_wjsan(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..AnDou_wjsan_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["AnDouType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAnDouType_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #endregion

        #region 其他活動資料查詢 (Other)

        /// <summary>
        /// 取得服務項目 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLybcType_dh(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lybc_dh_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LybcType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLybcType_dh：\r\n" + detailedError);
            }

            return result;
        }

        #region 購買人資料查詢 (ApplicantInfo)

        /// <summary>
        /// 取得購買人資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_EmperorGuanshengInfo(
            string Name, 
            string Mobile, 
            int AdminID, 
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_EmperorGuansheng_ty_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_EmperorGuanshengInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_LingbaolidouInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Lingbaolidou_ma_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_LingbaolidouInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_TaoistJiaoCeremonyInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_TaoistJiaoCeremony_da_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_TaoistJiaoCeremonyInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_LybcInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Lybc_dh_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_LybcInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_HuaguoInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Huaguo_wjsan_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_HuaguoInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_Lights_mom_Info(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Lights_ty_mom_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_Lights_mom_Info：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_BlessingInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_Blessing_st_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_BlessingInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        /// <summary>
        /// 取得購買人資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 回傳包含購買人資料的 <see cref="DataTable"/>。
        /// 若查無資料則回傳空的資料表。
        /// </returns>
        public DataTable Getapplicantinfo_QnLightInfo(
            string Name,
            string Mobile,
            int AdminID,
            string Year)
        {
            DataTable dtResult = new DataTable();

            try
            {
                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..view_QnLight_ty_InfowithAPPCharge 
                    WHERE Num > 0 
                      AND AppStatus = 2 
                      AND AppcStatus = 1 
                      AND Status = 0 
                      AND AdminID = @AdminID 
                      AND AppName = @Name 
                      AND AppMobile = @Mobile";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.Fill(dtResult);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getapplicantinfo_QnLightInfo：\r\n" + detailedError);
            }

            return dtResult;
        }

        #endregion

        #region 祈福人資料查詢 (OtherInfo)

        /// <summary>
        /// 取得關聖帝君聖誕資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GetemperorGuansheng_ty_Info(
            int ApplicantID, 
            string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_EmperorGuansheng_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetemperorGuansheng_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得靈寶禮斗資料 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlingbaolidou_ma_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lingbaolidou_ma_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlingbaolidou_ma_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得七朝清醮資料 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable GettaoistJiaoCeremony_da_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_TaoistJiaoCeremony_da_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GettaoistJiaoCeremony_da_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得護國息災梁皇大法會資料 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlybc_dh_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lybc_dh_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlybc_dh_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得供花供果資料 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Gethuaguo_wjsan_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Huaguo_wjsan_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Gethuaguo_wjsan_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得孝親祈福燈資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getlights_ty_mom_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ty_mom_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getlights_ty_mom_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得祈安植福資料 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getblessing_st_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Blessing_st_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getblessing_st_Info：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得千手觀音千燈迎佛法會資料 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年份（例如："2025"）。</param>
        /// <returns>
        /// 回傳包含該購買人於點燈紀錄的 <see cref="DataTable"/>；
        /// 若查無資料則為空表。
        /// </returns>
        public DataTable Getqnlight_ty_Info(int ApplicantID, string Year)
        {
            DataTable result = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_QnLight_ty_info WHERE Status = 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(result);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Getqnlight_ty_Info：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 交易流水資料查詢 (APPChargeInfo)

        /// <summary>
        /// 取得付款資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_EmperorGuansheng(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_EmperorGuansheng_ty_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_EmperorGuansheng：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_da_TaoistJiaoCeremony(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_TaoistJiaoCeremony_da_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_da_TaoistJiaoCeremony：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ma_Lingbaolidou(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lingbaolidou_ma_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ma_Lingbaolidou：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_dh_Lybc(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lybc_dh_infowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_dh_Lybc：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_wjsan_Huaguo(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Huaguo_wjsan_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_wjsan_Huaguo：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_mom_Lights(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Lights_ty_mom_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_mom_Lights：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_st_Blessing(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_Blessing_st_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_st_Blessing：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得付款資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">年度（例如 "2025"）。</param>
        /// <returns>回傳付款資料的 DataTable。</returns>
        public DataTable GetAPPCharge_ty_QnLight(int ApplicantID, string Year)
        {
            DataTable dtGetData = new DataTable();

            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_QnLight_ty_InfowithAPPCharge " +
                             "WHERE AppcStatus = 1 AND AppStatus = 2 AND Num > 0 AND ApplicantID = @ApplicantID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.Fill(dtGetData);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetAPPCharge_ty_QnLight：\r\n" + detailedError);
            }

            return dtGetData;
        }

        /// <summary>
        /// 取得 APPCharge_ty_EmperorGuansheng 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_EmperorGuansheng_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_EmperorGuansheng
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_jb_BPO 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_BPO_jb(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_BPO
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_BPO_jb：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_da_TaoistJiaoCeremony 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_TaoistJiaoCeremony_da(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_TaoistJiaoCeremony
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ma_Lingbaolidou 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lingbaolidou_ma(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Lingbaolidou
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_dh_Lybc 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lybc_dh(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Lybc
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lybc_dh：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_wjsan_Huaguo 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Huaguo_wjsan(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Huaguo
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Huaguo_wjsan：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_mom_Lights 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Lights_ty_mom(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_mom_Lights
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Lights_ty_mom：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_st_Blessing 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_Blessing_st(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_st_Blessing
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_Blessing_st：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得 APPCharge_ty_QnLight 的付款紀錄（取最新一筆）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳符合條件的 DataTable，最多一筆資料。</returns>
        public DataTable GetChargeLog_QnLight_ty(string OrderID, string Year)
        {
            DataTable dtDataList = new DataTable();

            try
            {
                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_QnLight
                        WHERE OrderID = @OrderID;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetChargeLog_QnLight_ty：\r\n" + detailedError);
            }

            return dtDataList;
        }

        /// <summary>
        /// 取得服務項目 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 EmperorGuanshengType，若無資料則回傳 0。</returns>
        public int GetEmperorGuanshengType_ty(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..EmperorGuansheng_ty_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["EmperorGuanshengType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetEmperorGuanshengType_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 HuaguoType，若無資料則回傳 0。</returns>
        public int GetHuaguoType_wjsan(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Huaguo_wjsan_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["HuaguoType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetHuaguoType_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 LightsType，若無資料則回傳 0。</returns>
        public int GetLightsType_ty_mom(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Lights_ty_mom_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["LightsType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetLightsType_ty_mom：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 BlessingType，若無資料則回傳 0。</returns>
        public int GetBlessingType_st(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..Blessing_st_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["BlessingType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetBlessingType_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 取得服務項目 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 QnLightType，若無資料則回傳 0。</returns>
        public int GetQnLightType_ty(int ApplicantID, string Year)
        {
            int result = 0;
            string sql = string.Empty;

            try
            {
                sql = $@"
                SELECT *
                FROM Temple_{Year}..QnLight_ty_info
                WHERE Status = 0
                  AND ApplicantID = @ApplicantID;
               ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dtGetData = new DataTable();
                    adapter.Fill(dtGetData);

                    if (dtGetData.Rows.Count > 0)
                    {
                        int.TryParse(dtGetData.Rows[0]["QnLightType"].ToString(), out result);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.GetQnLightType_ty：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #endregion

        #endregion

        #region 檢查 (CHECKED)

        /// <summary>
        /// 檢查燈種餘額 (Check remaining light quota)
        /// </summary>
        /// <param name="LightsType">燈種代碼。<br/>
        /// 3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// 4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// 5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// 6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// 7-姻緣燈、桃花燈、月老桃花燈
        /// 8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// 9-財利燈 
        /// 10-貴人燈 、特別貴人燈(石壁部堂)
        /// 11-福祿燈、福壽燈 
        /// 12-寵物平安燈 
        /// 13-龍王燈 
        /// 14-虎爺燈 
        /// 15-轉運納福燈 
        /// 16-光明燈上層、玉皇燈(五股賀聖宮)
        /// 17-偏財旺旺燈 
        /// 18-廣進安財庫 
        /// 19-財庫燈 
        /// 20-月老姻緣燈 
        /// 21-孝親祈福燈 
        /// 22-事業燈、特別事業燈(石壁部堂)
        /// 23-全家光明燈 
        /// 24-觀音佛祖燈 
        /// 25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// 26-事業斗 
        /// 27-平安斗 
        /// 28-文昌斗 
        /// 29-藥師斗 
        /// 30-元神斗 
        /// 31-福祿壽斗 
        /// 32-觀音斗 
        /// 33-明心智慧燈
        /// 34-發財斗/一個月
        /// 35-姻緣斗/一個月
        /// 36-貴人斗/一個月
        /// 37-消災延壽斗/一個月
        /// 38-財神斗/三個月
        /// 39-發財斗/三個月
        /// 40-姻緣斗/三個月
        /// 41-貴人斗/三個月
        /// 42-消災延壽斗/三個月
        /// 43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// 44-求子燈
        /// 45-護子燈
        /// 46-添丁燈
        /// 47-婚姻燈
        /// 48-安太陰
        /// 49-安太陽
        /// </param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Count">數量。</param>
        /// <param name="Year">資料年份。</param>
        /// <returns>若該燈種已額滿或將超出上限，回傳 true，否則 false。</returns>
        public bool CheckLightsAvailability(
            string LightsType, 
            string AdminID, 
            int Count, 
            string Year)
        {
            try
            {
                bool result = false;
                string templeCode = string.Empty;
                DataTable dtGetData = new DataTable();

                //──────────────────────────────
                // 對應 AdminID → TempleCode
                //──────────────────────────────
                switch (AdminID)
                {
                    case "3": templeCode = "da"; break;     // 大甲鎮瀾宮
                    case "4": templeCode = "h"; break;      // 新港奉天宮
                    case "6": templeCode = "wu"; break;     // 北港武德宮
                    case "8": templeCode = "Fu"; break;     // 西螺福興宮
                    case "10": templeCode = "Luer"; break;  // 台南正統鹿耳門聖母廟
                    case "14": templeCode = "ty"; break;    // 桃園威天宮
                    case "15": templeCode = "Fw"; break;    // 斗六五路財神宮
                    case "16": templeCode = "dh"; break;    // 台東東海龍門天聖宮
                    case "21": templeCode = "Lk"; break;    // 鹿港城隍廟
                    case "23": templeCode = "ma"; break;    // 玉敕大樹朝天宮
                    case "29": templeCode = "jb"; break;    // 進寶財神廟
                    case "31": templeCode = "wjsan"; break; // 台灣道教總廟無極三清總道院
                    case "32": templeCode = "ld"; break;    // 桃園龍德宮
                    case "34": templeCode = "wh"; break;    // 基隆悟玄宮
                    case "35": templeCode = "st"; break;    // 松柏嶺受天宮
                    case "38": templeCode = "bj"; break;    // 池上北極玄天宮
                    case "39": templeCode = "sbbt"; break;  // 慈惠石壁部堂
                    case "40": templeCode = "bpy"; break;   // 真武山受玄宮
                    case "41": templeCode = "ssy"; break;   // 壽山巖觀音寺
                }

                if (string.IsNullOrWhiteSpace(templeCode) || string.IsNullOrWhiteSpace(Year))
                    return false;

                string sql = $@"
                    SELECT * FROM Temple_{Year}..view_Lights_{templeCode}_infowithAPPCharge
                    WHERE AdminID=@AdminID AND LightsType=@LightsType
                    AND AppStatus=2 AND Num>0 AND AppcStatus=1";

                using (var adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@LightsType", LightsType);
                    adapter.Fill(dtGetData);
                }

                if (dtGetData.Rows.Count == 0)
                    return false;

                //──────────────────────────────
                // 計算邏輯與告警通知
                //──────────────────────────────
                bool notify = true;
                int remainingCount = 0;
                string lightsName = dtGetData.Rows[0]["LightsString"].ToString();
                string msg = string.Empty;

                // 取得宮廟暱稱
                if (int.TryParse(AdminID, out int adminid))
                {
                    var adminDAC = new AdminDAC(new BasePage());
                    DataTable dtAdmin = adminDAC.GetAdminInfo(adminid);
                    if (dtAdmin.Rows.Count > 0)
                        msg = $"{dtAdmin.Rows[0]["Nickname"]} {lightsName} 快額滿了。";
                }

                //──────────────────────────────
                // 依宮廟及燈種判斷額度
                //──────────────────────────────
                switch (AdminID)
                {
                    case "3": // 大甲鎮瀾宮
                        switch (LightsType)
                        {
                            case "3": result = dtGetData.Rows.Count + Count > 4000; remainingCount = 4000 - dtGetData.Rows.Count; break;
                            case "4": result = dtGetData.Rows.Count + Count > 5000; remainingCount = 5000 - dtGetData.Rows.Count; break;
                            case "5": result = dtGetData.Rows.Count + Count > 500; remainingCount = 500 - dtGetData.Rows.Count; notify = false; break;
                        }
                        break;

                    case "6": // 北港武德宮
                        switch (LightsType)
                        {
                            case "3": result = dtGetData.Rows.Count + Count > 500; remainingCount = 500 - dtGetData.Rows.Count; notify = false; break;
                            case "4": result = dtGetData.Rows.Count + Count > 500; remainingCount = 500 - dtGetData.Rows.Count; notify = false; break;
                            case "6": result = dtGetData.Rows.Count + Count > 1000; remainingCount = 1000 - dtGetData.Rows.Count; notify = false; break;
                        }
                        break;

                    case "14": // 桃園威天宮
                        switch (LightsType)
                        {
                            case "3": result = dtGetData.Rows.Count + Count > 6000; remainingCount = 6000 - dtGetData.Rows.Count; break;
                            case "4": result = dtGetData.Rows.Count + Count > 3000; remainingCount = 3000 - dtGetData.Rows.Count; break;
                            case "6": result = dtGetData.Rows.Count + Count > 3000; remainingCount = 3000 - dtGetData.Rows.Count; break;
                            case "8": result = dtGetData.Rows.Count + Count > 1000; remainingCount = 1000 - dtGetData.Rows.Count; break;
                            case "10": result = dtGetData.Rows.Count + Count > 1000; remainingCount = 1000 - dtGetData.Rows.Count; notify = false; break;
                            case "11": result = dtGetData.Rows.Count + Count > 300; remainingCount = 300 - dtGetData.Rows.Count; break;
                            case "21": result = dtGetData.Rows.Count + Count > 3000; remainingCount = 3000 - dtGetData.Rows.Count; notify = false; break;
                            case "33": result = dtGetData.Rows.Count + Count > 3000; remainingCount = 3000 - dtGetData.Rows.Count; break;
                        }
                        break;

                    case "23": // 玉敕大樹朝天宮
                        switch (LightsType)
                        {
                            case "3": result = dtGetData.Rows.Count + Count > 350; remainingCount = 350 - dtGetData.Rows.Count; notify = false; break;
                            case "4": result = dtGetData.Rows.Count + Count > 250; remainingCount = 250 - dtGetData.Rows.Count; notify = false; break;
                            case "5": result = dtGetData.Rows.Count + Count > 300; remainingCount = 300 - dtGetData.Rows.Count; notify = false; break;
                            case "6": result = dtGetData.Rows.Count + Count > 250; remainingCount = 250 - dtGetData.Rows.Count; notify = false; break;
                        }
                        break;

                    case "39": // 慈惠石壁部堂
                        switch (LightsType)
                        {
                            case "3": result = dtGetData.Rows.Count + Count > 1500; remainingCount = 1500 - dtGetData.Rows.Count; notify = false; break;
                            case "4": result = dtGetData.Rows.Count + Count > 1000; remainingCount = 1000 - dtGetData.Rows.Count; notify = false; break;
                            case "5": result = dtGetData.Rows.Count + Count > 500; remainingCount = 500 - dtGetData.Rows.Count; notify = false; break;
                            case "6": result = dtGetData.Rows.Count + Count > 250; remainingCount = 250 - dtGetData.Rows.Count; notify = false; break;
                        }
                        break;
                }

                //──────────────────────────────
                // SMS 告警（僅在餘額小於等於 50 且尚未額滿時觸發）
                //──────────────────────────────
                if (remainingCount > 0 && remainingCount <= 50 && notify)
                {
                    var sms = new SMSHepler();
                    sms.SendMsg_SL("0934315020", msg);
                }

                return result;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckLightsAvailability：\r\n" + detailedError);
                throw;
            }
        }

        /// <summary>
        /// 檢查燈種剩餘數量，並記錄檢查狀態。
        /// </summary>
        /// <param name="LightsType">燈種代碼。
        /// 3-光明燈、元神光明燈(鹿港城隍廟)、貴人燈(斗六五路財神宮)、平安燈(北極玄天宮、壽山巖觀音寺)
        /// 4-安太歲、太歲燈、太歲平安符(鹿港城隍廟)、安奉太歲
        /// 5-文昌燈、五文昌燈、文魁智慧燈(鹿港城隍廟)、文昌功名燈(桃園龍德宮)
        /// 6-財神燈、發財燈、福財燈、正財福報燈(鹿港城隍廟)、招財燈(壽山巖觀音寺)、五路財神燈(桃園龍德宮)
        /// 7-姻緣燈、桃花燈、月老桃花燈
        /// 8-藥師燈 、藥師佛燈、消災延壽燈(斗六五路財神宮)、特別健康燈(石壁部堂)、健康延壽燈(桃園龍德宮)
        /// 9-財利燈 
        /// 10-貴人燈 、特別貴人燈(石壁部堂)
        /// 11-福祿燈、福壽燈 
        /// 12-寵物平安燈 
        /// 13-龍王燈 
        /// 14-虎爺燈 
        /// 15-轉運納福燈 
        /// 16-光明燈上層、玉皇燈(五股賀聖宮)
        /// 17-偏財旺旺燈 
        /// 18-廣進安財庫 
        /// 19-財庫燈 
        /// 20-月老姻緣燈 
        /// 21-孝親祈福燈 
        /// 22-事業燈、特別事業燈(石壁部堂)
        /// 23-全家光明燈 
        /// 24-觀音佛祖燈 
        /// 25-財神斗、財神斗/一個月(斗六五路財神宮)
        /// 26-事業斗 
        /// 27-平安斗 
        /// 28-文昌斗 
        /// 29-藥師斗 
        /// 30-元神斗 
        /// 31-福祿壽斗 
        /// 32-觀音斗 
        /// 33-明心智慧燈
        /// 34-發財斗/一個月
        /// 35-姻緣斗/一個月
        /// 36-貴人斗/一個月
        /// 37-消災延壽斗/一個月
        /// 38-財神斗/三個月
        /// 39-發財斗/三個月
        /// 40-姻緣斗/三個月
        /// 41-貴人斗/三個月
        /// 42-消災延壽斗/三個月
        /// 43-元辰斗燈、元辰燈(壽山巖觀音寺)
        /// 44-求子燈
        /// 45-護子燈
        /// 46-添丁燈
        /// 47-婚姻燈
        /// 48-安太陰
        /// 49-安太陽
        /// </param>
        /// <param name="AdminID">宮廟代號。</param>
        /// <param name="Count">本次欲新增數量。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <param name="_basePage">基底頁面物件。</param>
        /// <returns>回傳 true 表示燈數已滿或不可用；false 表示仍可新增。</returns>
        public bool CheckedLightsNum(
            string LightsType, 
            string AdminID, 
            int Count, 
            string Year, 
            BasePage _basePage)
        {
            // 取得台北標準時間
            DateTime dtNow = GetTaipeiNow();

            bool isFull = false;

            try
            {
                TempleHelper helper = new TempleHelper(_basePage);
                isFull = helper.CheckLightsCapacity(LightsType, AdminID, Count, Year, _basePage);

                string status = isFull ? "【已滿或下架】" : "【可用】";
                string logMsg = string.Format("{0} AdminID:{1}, LightsType:{2}, Count:{3}, Year:{4} {5}",
                    dtNow.ToString("yyyy-MM-dd HH:mm:ss"), AdminID, LightsType, Count, Year, status);

                // 可自行決定是否寫入檢查記錄檔
                //_basePage.SaveCheckLog(logMsg);
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                _basePage.SaveErrorLog("[CheckedLightsNum ERROR]：\r\n " + detailedError);
            }

            return isFull;
        }

        /// <summary>
        /// 檢查驗證碼是否有效且正確。
        /// </summary>
        /// <param name="Code">驗證碼字串。</param>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="CodeType">驗證碼方式 0-sms 1-email。</param>
        /// <param name="Year">年度資料表後綴（例如 "2025"）。</param>
        /// <param name="Codeerror">
        /// 錯誤代碼：
        /// <list type="bullet">
        /// <item><description>-2：查無有效驗證碼（可能已過期）</description></item>
        /// <item><description>-3：驗證碼錯誤</description></item>
        /// </list>
        /// </param>
        /// <returns>
        /// 回傳 <c>true</c> 表示驗證成功；
        /// 回傳 <c>false</c> 表示驗證失敗（並於 <paramref name="Codeerror"/> 記錄原因）。
        /// </returns>
        public bool CheckedCAPTCHACode(
            string Code,
            int ApplicantID,
            int AdminID,
            int Kind,
            int CodeType,
            string Year,
            ref string Codeerror)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                    SELECT TOP 1 *
                    FROM Temple_{Year}..CAPTCHACode
                    WHERE ApplicantID = @ApplicantID
                      AND AdminID = @AdminID
                      AND Kind = @Kind
                      AND CodeType = @CodeType 
                      AND ExpirationDate > @ExpirationDate
                    ORDER BY CreateDate DESC";

                DataTable dtGetData = new DataTable();

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);
                    adapter.AddParameterToSelectCommand("@CodeType", CodeType);
                    adapter.AddParameterToSelectCommand("@ExpirationDate", dtNow);
                    adapter.Fill(dtGetData);
                }

                if (dtGetData.Rows.Count > 0)
                {
                    string dbCode = dtGetData.Rows[0]["Code"].ToString().Trim();

                    if (string.Equals(Code.Trim(), dbCode, StringComparison.OrdinalIgnoreCase))
                    {
                        result = true;
                    }
                    else
                    {
                        // 驗證碼錯誤
                        Codeerror = "-3";
                    }
                }
                else
                {
                    // 無符合驗證碼（可能過期或不存在）
                    Codeerror = "-2";
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedCAPTCHACode：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查指定購買者於當日的驗證碼購買次數是否超出限制。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="CodeType">驗證碼方式 0-sms 1-email。</param>
        /// <param name="AppMobile">購買人電話。</param>
        /// <param name="Year">年度資料表名稱後綴，例如 "2025"。</param>
        /// <param name="Codeerror">若超出限制，回傳錯誤代碼（-5 表示超過上限）。</param>
        /// <returns>
        /// 回傳 <c>true</c> 表示允許繼續購買驗證碼；
        /// 回傳 <c>false</c> 表示不可再購買。
        /// </returns>
        public bool CheckedCAPTCHACodeCount(
            int ApplicantID,
            int AdminID,
            int Kind,
            int CodeType,
            string AppMobile,
            string Year,
            ref string Codeerror)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                    SELECT * 
                    FROM Temple_{Year}..CAPTCHACode 
                    WHERE ApplicantID = @ApplicantID 
                      AND AdminID = @AdminID 
                      AND Kind = @Kind 
                      AND CodeType = @CodeType 
                      AND AppMobile = @AppMobile
                      AND CreateDate BETWEEN @StartDate AND @EndDate
                    ORDER BY CreateDate DESC";

                DataTable dtGetData = new DataTable();

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);
                    adapter.AddParameterToSelectCommand("@CodeType", CodeType);
                    adapter.AddParameterToSelectCommand("@AppMobile", AppMobile);
                    adapter.AddParameterToSelectCommand("@StartDate", dtNow.ToString("yyyy-MM-dd 00:00:00"));
                    adapter.AddParameterToSelectCommand("@EndDate", dtNow.ToString("yyyy-MM-dd 23:59:59"));
                    adapter.Fill(dtGetData);
                }

                // 若當日已有紀錄
                if (dtGetData.Rows.Count > 0)
                {
                    // 超過三次禁止再送出
                    if (dtGetData.Rows.Count >= 3)
                    {
                        Codeerror = "-5"; // 超過上限
                        result = false;
                    }
                    else
                    {
                        result = true;
                    }
                }
                else
                {
                    // 當日首次送出允許
                    result = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedCAPTCHACodeCount：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 驗證前端傳入的金額與資料庫實際金額是否一致。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="TotalFromRequest">前端傳入的金額。</param>
        /// <param name="Year">資料年度（例如："2025"）。</param>
        /// <returns>
        /// 回傳 <c>true</c> 表示金額一致；
        /// 回傳 <c>false</c> 表示金額不符或查無資料。
        /// </returns>
        public bool CheckedTotalMatch(
            int ApplicantID, 
            int AdminID, 
            int Kind, 
            int TotalFromRequest, 
            string Year)
        {
            try
            {
                int dbTotal = GetApplicantTotal(ApplicantID, AdminID, Kind, Year);
                return dbTotal == TotalFromRequest;
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedTotalMatch：\r\n" + detailedError);
                return false;
            }
        }

        /// <summary>
        /// 檢查是否使用過 QrCode，並回傳 AppTag（含 ref 傳入）。 
        /// </summary>
        /// <param name="AdminID">廟宇編號。</param>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Kind">活動種類。</param>
        /// <param name="Year">西元年（例如 2025）。</param>
        /// <param name="AppTag">回傳的 APPTag。</param>
        /// <returns>若有資料則回傳 true。</returns>
        public bool CheckedCode(
            int AdminID, 
            int ApplicantID, 
            int Kind, 
            string Year, 
            ref string AppTag)
        {
            bool result = true;
            DataTable dtGetData = new DataTable();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = string.Empty;

                // 各宮廟對應表
                switch (AdminID)
                {
                    case 3:
                        // 大甲鎮瀾宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_da_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_da_Purdue Where ApplicantID = @aid"; break;
                            // 七朝清醮
                            case 13: sql = $"Select * from Temple_{Year}..APPCharge_da_TaoistJiaoCeremony Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 4:
                        // 新港奉天宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_h_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_h_Purdue Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 5:
                        // 商品販賣小舖
                        sql = $"Select * from Temple_{Year}..APPCharge_Product Where ApplicantID = @aid";
                        break;
                    case 6:
                        // 北港武德宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_wu_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_wu_Purdue Where ApplicantID = @aid"; break;
                            case 4: sql = $"Select * from Temple_{Year}..APPCharge_wu_Supplies Where ApplicantID = @aid"; break;
                            case 5: sql = $"Select * from Temple_{Year}..APPCharge_wu_Supplies2 Where ApplicantID = @aid"; break;
                            case 6: sql = $"Select * from Temple_{Year}..APPCharge_wu_Supplies3 Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 8:
                        // 西螺福興宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_Fu_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_Fu_Purdue Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 10:
                        // 台南正統鹿耳門聖母廟
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_Luer_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_Luer_Purdue Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 14:
                        // 桃園威天宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_ty_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_ty_Purdue Where ApplicantID = @aid"; break;
                            // 天赦日補運
                            case 7: sql = $"Select * from Temple_{Year}..APPCharge_ty_Supplies Where ApplicantID = @aid"; break;
                            // 關聖帝君聖誕
                            case 9: sql = $"Select * from Temple_{Year}..APPCharge_ty_EmperorGuansheng Where ApplicantID = @aid"; break;
                            // 九九重陽天赦日補運
                            case 14: sql = $"Select * from Temple_{Year}..APPCharge_ty_Supplies2 Where ApplicantID = @aid"; break;
                            // 天公生招財補運
                            case 18: sql = $"Select * from Temple_{Year}..APPCharge_ty_Supplies3 Where ApplicantID = @aid"; break;
                            // 孝親祈福燈
                            case 22: sql = $"Select * from Temple_{Year}..APPCharge_ty_mom_Lights Where ApplicantID = @aid"; break;
                            // 千手觀音千燈迎佛法會
                            case 25: sql = $"Select * from Temple_{Year}..APPCharge_ty_QnLight Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 15:
                        // 斗六五路財神宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_Fw_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_Fw_Purdue Where ApplicantID = @aid"; break;
                            // 補財庫
                            case 16: sql = $"Select * from Temple_{Year}..APPCharge_Fw_Supplies Where ApplicantID = @aid"; break;
                            // 安奉斗燈
                            case 20: sql = $"Select * from Temple_{Year}..APPCharge_Fw_AnDou Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 16:
                        // 台東東海龍門天聖宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_dh_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_dh_Purdue Where ApplicantID = @aid"; break;
                            // 天貺納福添運法會
                            case 11: sql = $"Select * from Temple_{Year}..APPCharge_dh_Supplies Where ApplicantID = @aid"; break;
                            // 護國息災梁皇大法會
                            case 15: sql = $"Select * from Temple_{Year}..APPCharge_dh_Lybc Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 21:
                        // 鹿港城隍廟
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_Lk_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_Lk_Purdue Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 23:
                        // 玉敕大樹朝天宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_ma_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_ma_Purdue Where ApplicantID = @aid"; break;
                            // 靈寶禮斗
                            case 12: sql = $"Select * from Temple_{Year}..APPCharge_ma_Lingbaolidou Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 29:
                        // 進寶財神廟
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_jb_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_jb_Purdue Where ApplicantID = @aid"; break;
                            // 天赦日祭改
                            case 8: sql = $"Select * from Temple_{Year}..APPCharge_jb_Supplies Where ApplicantID = @aid"; break;
                            // 代燒金紙
                            case 10: sql = $"Select * from Temple_{Year}..APPCharge_jb_BPO Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 31:
                        // 台灣道教總廟無極三清總道院
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_wjsan_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_wjsan_Purdue Where ApplicantID = @aid"; break;
                            // 補財庫
                            case 16: sql = $"Select * from Temple_{Year}..APPCharge_wjsan_Supplies Where ApplicantID = @aid"; break;
                            // 安奉斗燈
                            case 20: sql = $"Select * from Temple_{Year}..APPCharge_wjsan_AnDou Where ApplicantID = @aid"; break;
                            // 供花供果
                            case 21: sql = $"Select * from Temple_{Year}..APPCharge_wjsan_Huaguo Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 32:
                        // 桃園龍德宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_ld_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_ld_Purdue Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 33:
                        // 神霄玉府財神會館
                        switch (Kind)
                        {
                            // 赦罪補庫
                            case 17: sql = $"Select * from Temple_{Year}..APPCharge_sx_Supplies Where ApplicantID = @aid"; break;
                            // 供香轉運
                            case 19: sql = $"Select * from Temple_{Year}..APPCharge_sx_Supplies2 Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 34:
                        // 基隆悟玄宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_wh_Lights Where ApplicantID = @aid"; break;
                            case 2: sql = $"Select * from Temple_{Year}..APPCharge_wh_Purdue Where ApplicantID = @aid"; break;
                            // 祈安植福
                            case 24: sql = $"Select * from Temple_{Year}..APPCharge_wh_Supplies Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 35:
                        // 松柏嶺受天宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_st_Lights Where ApplicantID = @aid"; break;
                            // 祈安植福
                            case 23: sql = $"Select * from Temple_{Year}..APPCharge_st_Blessing Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 38:
                        // 池上北極玄天宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_bj_Lights Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 39:
                        // 慈惠石壁部堂
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_sbbt_Lights Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 40:
                        // 真武山受玄宮
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_bpy_Lights Where ApplicantID = @aid"; break;
                        }
                        break;
                    case 41:
                        // 壽山巖觀音寺
                        switch (Kind)
                        {
                            case 1: sql = $"Select * from Temple_{Year}..APPCharge_ssy_Lights Where ApplicantID = @aid"; break;
                        }
                        break;
                }

                if (!string.IsNullOrEmpty(sql))
                {
                    using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@aid", ApplicantID);
                        adapter.Fill(dtGetData);

                        if (dtGetData.Rows.Count > 0)
                        {
                            string[] AppTagArr = dtGetData.Rows[0]["APPTag"].ToString().Split(',');
                            AppTag = AppTagArr[0];
                        }
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedCode(含AppTag)：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人訂單是否已有待付款訂單
        /// </summary>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="AdminID">廟宇編號</param>
        /// <param name="Kind">活動種類：1-點燈、2-普度等</param>
        /// <param name="Year">年度資料表</param>
        /// <param name="Oid">回傳未付款訂單編號（若有）</param>
        /// <returns>true=無待付款訂單、false=已有</returns>
        public bool CheckedAPPChargeHaving(
            int ApplicantID, 
            int AdminID, 
            int Kind, 
            string Year, 
            ref string Oid)
        {
            bool result = true;
            string sql = string.Empty;

            try
            {
                switch (AdminID)
                {
                    case 3:
                        // 大甲鎮瀾宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_da_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_da_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 13:
                                // 七朝清醮
                                sql = $"Select * from Temple_{Year}..view_TaoistJiaoCeremony_da_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 4:
                        // 新港奉天宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 6:
                        // 北港武德宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 4:
                                // 下元補庫
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 5:
                                // 呈疏補庫(天官武財神聖誕補財庫)
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge2 Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 6:
                                // 企業補財庫
                                sql = $"Select * from Temple_{Year}..view_Supplies_wu_InfowithAPPCharge3 Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 8:
                        // 西螺福興宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_Fu_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_Fu_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 10:
                        // 台南正統鹿耳門聖母廟
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_Luer_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_Luer_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 11:
                        // 鎮宅錢母擺件文創小販部
                        switch (Kind)
                        {
                            case 3:
                                sql = $"Select * from Temple_{Year}..view_Product_MoneymotherwithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 14:
                        // 桃園威天宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 7:
                                // 天赦日招財補運
                                sql = $"Select * from Temple_{Year}..view_Supplies_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 9:
                                // 關聖帝君聖誕
                                sql = $"Select * from Temple_{Year}..view_EmperorGuansheng_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 14:
                                // 九九重陽天赦日招財補運
                                sql = $"Select * from Temple_{Year}..view_Supplies2_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 18:
                                // 天公生招財補運
                                sql = $"Select * from Temple_{Year}..view_Supplies3_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 22:
                                // 孝親祈福燈
                                sql = $"Select * from Temple_{Year}..view_Lights_ty_mom_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 25:
                                // 千手觀音千燈迎佛法會
                                sql = $"Select * from Temple_{Year}..view_QnLight_ty_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 15:
                        // 斗六五路財神宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_Fw_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_Fw_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 20:
                                // 安奉斗燈
                                sql = $"Select * from Temple_{Year}..view_AnDou_Fw_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 16:
                        // 台東東海龍門天聖宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_h_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 11:
                                // 天貺納福添運法會
                                sql = $"Select * from Temple_{Year}..view_Supplies_dh_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 15:
                                // 護國息災梁皇大法會
                                sql = $"Select * from Temple_{Year}..view_Lybc_dh_infowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 21:
                        // 鹿港城隍廟
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_Lk_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_Lk_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 16:
                                // 補財庫
                                sql = $"Select * from Temple_{Year}..view_Supplies_Lk_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 23:
                        // 玉敕大樹朝天宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_ma_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_ma_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 7:
                                // 天赦日招財補運
                                sql = $"Select * from Temple_{Year}..view_Supplies_ma_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 12:
                                // 靈寶禮斗
                                sql = $"Select * from Temple_{Year}..view_Lingbaolidou_ma_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 29:
                        // 進寶財神廟
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_jb_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_jb_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 8:
                                // 天赦日祭改
                                sql = $"Select * from Temple_{Year}..view_Supplies_jb_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 10:
                                // 代燒金紙
                                sql = $"Select * from Temple_{Year}..view_BPO_jb_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 31:
                        // 台灣道教總廟無極三清總道院
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_wjsan_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_wjsan_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 20:
                                // 安奉斗燈
                                sql = $"Select * from Temple_{Year}..view_AnDou_wjsan_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 21:
                                // 供花供果
                                sql = $"Select * from Temple_{Year}..view_Huaguo_wjsan_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 32:
                        // 桃園龍德宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_ld_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_ld_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 33:
                        // 神霄玉府財神會館
                        switch (Kind)
                        {
                            case 17:
                                sql = $"Select * from Temple_{Year}..view_Supplies_sx_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 19:
                                sql = $"Select * from Temple_{Year}..view_Supplies2_sx_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 34:
                        // 基隆悟玄宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_wh_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 2:
                                sql = $"Select * from Temple_{Year}..view_Purdue_wh_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 24:
                                // 祈安禮斗
                                sql = $"Select * from Temple_{Year}..view_Supplies_wh_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 35:
                        // 松柏嶺受天宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_st_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                            case 23:
                                // 祈安植福
                                sql = $"Select * from Temple_{Year}..view_Blessing_st_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 38:
                        // 池上北極玄天宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_bj_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 39:
                        // 慈惠石壁部堂
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_sbbt_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 40:
                        // 真武山受玄宮
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_bpy_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                    case 41:
                        // 壽山巖觀音寺
                        switch (Kind)
                        {
                            case 1:
                                sql = $"Select * from Temple_{Year}..view_Lights_ssy_InfowithAPPCharge Where Status = 0 and ApplicantID = @ApplicantID and AdminID = @AdminID Order by Num Desc";
                                break;
                        }
                        break;
                }

                if (!string.IsNullOrEmpty(sql))
                {
                    using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                        adapter.AddParameterToSelectCommand("@AdminID", AdminID);

                        DataTable dtGetData = new DataTable();
                        adapter.Fill(dtGetData);

                        if (dtGetData.Rows.Count > 0)
                        {
                            Oid = dtGetData.Rows[0]["OrderID"].ToString();
                            result = false;
                        }
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedAPPChargeHaving：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查此訂單是否已存在發票紀錄。
        /// ApplicantID + AdminID + Kind + Year 為唯一組合。
        /// </summary>
        /// <param name="ApplicantId">購買人編號。</param>
        /// <param name="AdminId">宮廟編號。</param>
        /// <param name="Kind">服務項目代碼。</param>
        /// <param name="Year">年度資料表。</param>
        /// <returns>若已存在發票資料則回傳 true。</returns>
        public bool CheckedInvoiceAlreadyExists(
            int ApplicantId, 
            int AdminId, 
            int Kind, 
            string Year)
        {
            string sql = $@"
                        SELECT TOP 1 1
                        FROM Temple_{Year}..InvoiceDetail
                        WHERE ApplicantID = @ApplicantID
                          AND AdminID = @AdminID
                          AND Kind = @Kind";

            using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
            {
                adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantId);
                adapter.AddParameterToSelectCommand("@AdminID", AdminId);
                adapter.AddParameterToSelectCommand("@Kind", Kind);

                DataTable dtGetData = new DataTable();
                adapter.Fill(dtGetData);

                return dtGetData.Rows.Count > 0;
            }
        }


        #region 檢查點燈資料 (Lights)

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_da(
            int ApplicantID, 
            int AdminID, 
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_da_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_h(
            int ApplicantID, 
            int AdminID, 
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_h_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_wu(
            int ApplicantID, 
            int AdminID, 
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wu_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_Fu(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fu_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_Luer(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Luer_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_Fw(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fw_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_dh(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_dh_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_Hs(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Hs_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_Hs：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_Lk(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Lk_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_ma(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ma_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_jb(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_jb_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_jb：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_wjsan(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wjsan_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_ld(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ld_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_ld：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_wh(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wh_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_wh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_st(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_st_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_bj(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_bj_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_bj：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_sbbt(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_sbbt_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_sbbt：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_bpy(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_bpy_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_bpy：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_ssy(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ssy_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_ssy：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 檢查普度資料 (Purdue)

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_da(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_da_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_h(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_h_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_wu(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wu_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_Fu(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fu_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_Luer(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Luer_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_Fw(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fw_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_dh(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_dh_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_Lk(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Lk_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_ma(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ma_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Purdue_wjsan(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wjsan_Purdue WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Purdue_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 檢查商品小舖資料 (Product)

        /// <summary>
        /// 檢查文創商品的剩餘庫存數量是否足夠。
        /// </summary>
        /// <param name="count">欲購買數量。</param>
        /// <param name="type">商品種類代號：1=擺件、2=（保留）、3=香火袋、4=黃金符令手鍊。</param>
        /// <param name="overStatus">
        /// 輸出參數：
        /// <list type="bullet">
        /// <item><description>0：庫存充足。</description></item>
        /// <item><description>-1：已額滿（UseCount ≥ Num）。</description></item>
        /// <item><description>-2：庫存不足（UseCount + count ＞ Num）。</description></item>
        /// </list>
        /// </param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若庫存不足或已額滿，回傳 <c>true</c>；
        /// 若庫存足夠，回傳 <c>false</c>。
        /// </returns>
        public bool CheckedProductstock(
            int count, 
            string type, 
            out int overStatus, 
            string Year)
        {
            bool result = false;
            overStatus = 0;

            try
            {
                // 無效數量直接返回
                if (count <= 0)
                    return false;

                string sql = "SELECT Num, UseCount FROM Product WHERE ProductID = @Type AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Type", type);

                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                    {
                        if (int.TryParse(dt.Rows[0]["Num"].ToString(), out int totalStock) &&
                            int.TryParse(dt.Rows[0]["UseCount"].ToString(), out int usedStock))
                        {
                            // 🧮 判斷庫存狀態
                            if (usedStock >= totalStock)
                            {
                                result = true;
                                overStatus = -1; // 已額滿
                            }
                            else if (usedStock + count > totalStock)
                            {
                                result = true;
                                overStatus = -2; // 庫存不足
                            }
                        }
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedProductstock：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 檢查法會資料 (Supplies)

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_wu(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wu_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_wu2(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wu_Supplies2 WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_wu2：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_wu3(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wu_Supplies3 WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_wu3：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查「北港武德宮 企業補財庫」是否已有相同購買資料，
        /// 若存在則將 <paramref name="NewUser"/> 設為 0，並取回舊的 AddDate / AddDateString，
        /// 最後自動執行 <see cref="Addapplicantinfo_supplies_wu3"/> 寫入流程。
        /// </summary>
        /// <param name="Name">購買人姓名。</param>
        /// <param name="Mobile">購買人電話。</param>
        /// <param name="Cost">金額。</param>
        /// <param name="Email">購買人信箱。</param>
        /// <param name="County">購買人地址縣市。</param>
        /// <param name="Dist">購買人地址區域。</param>
        /// <param name="Addr">購買人地址部分地址。</param>
        /// <param name="ZipCode">購買人地址郵遞區號。</param>
        /// <param name="Sendback">寄回設定。 Y-是 N-否</param>
        /// <param name="ReceiptName">收件人姓名。</param>
        /// <param name="ReceiptMobile">收件人電話。</param>
        /// <param name="NewUser">是否為新訂閱者 (1=新訂閱者, 0=舊訂閱者)。</param>
        /// <param name="AddDate">建立日期 (若為舊資料會被覆寫)。</param>
        /// <param name="AddDateString">建立日期字串 (若為舊資料會被覆寫)。</param>
        /// <param name="Status">狀態碼。</param>
        /// <param name="AdminID">宮廟代號。</param>
        /// <param name="PostURL">來源網址。</param>
        /// <param name="Year">資料年度 (例如 "2025")。</param>
        /// <returns>回傳新插入紀錄的 ApplicantInfo 主鍵編號。</returns>
        public int CheckedSupplies_wu_Info3(
            string Name,
            string Mobile,
            string Cost,
            string Email,
            string County,
            string Dist,
            string Addr,
            string ZipCode,
            string Sendback,
            string ReceiptName,
            string ReceiptMobile,
            int NewUser,
            string AddDate,
            string AddDateString,
            int Status,
            string AdminID,
            string PostURL,
            string Year)
        {
            try
            {
                // 1️⃣ 取得台北時區現在時間
                DateTime dtNow = GetTaipeiNow();

                // 2️⃣ 判斷是否已有相同購買資料
                string checkSql = $@"
                    SELECT AddDate, AddDateString
                    FROM Temple_{Year}..ApplicantInfo_wu_Supplies3
                    WHERE Name = @Name
                      AND Mobile = @Mobile
                      AND Email = @Email
                      AND County = @County
                      AND dist = @dist
                      AND Addr = @Addr";

                DataTable dtCheck = new DataTable();
                using (DatabaseAdapter adapter = new DatabaseAdapter(checkSql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Name", Name);
                    adapter.AddParameterToSelectCommand("@Mobile", Mobile);
                    adapter.AddParameterToSelectCommand("@Email", Email);
                    adapter.AddParameterToSelectCommand("@County", County);
                    adapter.AddParameterToSelectCommand("@dist", Dist);
                    adapter.AddParameterToSelectCommand("@Addr", Addr);
                    adapter.Fill(dtCheck);
                }

                if (dtCheck.Rows.Count > 0)
                {
                    // ⚙️ 若已存在，標記為舊使用者並覆寫日期
                    NewUser = 0;
                    AddDate = dtCheck.Rows[0]["AddDate"].ToString();
                    AddDateString = dtCheck.Rows[0]["AddDateString"].ToString();
                }

                // 3️⃣ 呼叫插入方法
                return this.Addapplicantinfo_supplies_wu3(
                    Name: Name,
                    Mobile: Mobile,
                    Cost: Cost,
                    County: County,
                    Dist: Dist,
                    Addr: Addr,
                    ZipCode: ZipCode,
                    Sendback: Sendback,
                    ReceiptName: ReceiptName,
                    ReceiptMobile: ReceiptMobile,
                    Email: Email,
                    NewUser: NewUser,
                    AddDate: AddDate,
                    AddDateString: AddDateString,
                    Status: Status,
                    AdminID: AdminID,
                    PostURL: PostURL,
                    Year: Year
                );
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.CheckedSupplies_wu_Info3：\r\n" + detailedError);
                return -1;
            }
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_Fw(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fw_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies2_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_Supplies2 WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies2_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies3_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_Supplies3 WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies3_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_Lk(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Lk_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_ma(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ma_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_ma：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 檢查安斗資料 (AnDou)

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_AnDou_Fw(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_Fw_AnDou WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_AnDou_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_AnDou_wjsan(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wjsan_AnDou WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_AnDou_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #region 檢查其他活動資料 (Other)

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_EmperorGuansheng_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_EmperorGuansheng WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lingbaolidou_ma(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ma_Lingbaolidou WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_TaoistJiaoCeremony_da(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_da_TaoistJiaoCeremony WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lybc_dh(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_dh_Lybc WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lybc_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies_sx(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_sx_Supplies WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies_sx：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Supplies2_sx(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_sx_Supplies2 WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Supplies2_sx：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Huaguo_wjsan(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_wjsan_Huaguo WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Huaguo_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Lights_ty_mom(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_mom_Lights WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Lights_ty_mom：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_Blessing_st(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_st_Blessing WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_Blessing_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 檢查購買人是否已有已付款訂單 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若購買人已有已付款紀錄（AppStatus=1 或 2），則回傳 <c>false</c>；
        /// 若無付款紀錄，則回傳 <c>true</c>。
        /// </returns>
        public bool Checkedappcharge_QnLight_ty(
            int ApplicantID,
            int AdminID,
            string Year)
        {
            bool result = true;
            try
            {
                string sql = $"SELECT * FROM Temple_{Year}..view_APPCharge_ty_QnLight WHERE (AppStatus = 1 OR AppStatus = 2) AND ApplicantID = @ApplicantID AND AdminID = @AdminID";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0)
                        result = false;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Checkedappcharge_QnLight_ty：\r\n" + detailedError);
            }

            return result;
        }

        #endregion

        #endregion

        #endregion


        //==================================================
        #region 更新 (UPDATE)
        //==================================================

        /// <summary>
        /// 更新指定購買人之驗證碼狀態，將其標記為已使用。
        /// </summary>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Kind">服務種類代碼。</param>
        /// 1-點燈 
        /// 2-普度 
        /// 4-下元補庫 
        /// 5-呈疏補庫(天官武財神聖誕補財庫) 
        /// 6-企業補財庫 
        /// 7-天赦日補運 
        /// 8-天赦日祭改 
        /// 9-關聖帝君聖誕 
        /// 10-代燒金紙 
        /// 11-天貺納福添運法會 
        /// 12-靈寶禮斗 
        /// 13-七朝清醮 
        /// 14-九九重陽天赦日補運 
        /// 15-護國息災梁皇大法會 
        /// 16-補財庫 
        /// 17-赦罪補庫 
        /// 18-天公生招財補運 
        /// 19-供香轉運 
        /// 20-安斗 
        /// 21-供花供果 
        /// 22-孝親祈福燈 
        /// 23-祈安植福
        /// 24-祈安禮斗
        /// 25-千手觀音千燈迎佛法會
        /// <param name="CodeType">驗證碼方式 0-sms 1-email。</param>
        /// <param name="Year">年度字串（例如："2025"）。</param>
        /// <returns>
        /// 回傳 <c>true</c> 表示更新成功；
        /// 回傳 <c>false</c> 表示更新失敗或查無資料。
        /// </returns>
        public bool UpdateCAPTCHACodeStatus(
            int AdminID, 
            int ApplicantID, 
            int Kind,
            int CodeType,
            string Year)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                    SELECT TOP 1 CodeID 
                    FROM Temple_{Year}..CAPTCHACode 
                    WHERE ApplicantID = @ApplicantID 
                      AND AdminID = @AdminID 
                      AND Kind = @Kind 
                      AND CodeType = @CodeType 
                    ORDER BY CreateDate DESC";

                DataTable dtGetData = new DataTable();

                // 查詢目前最新的驗證碼資料
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);
                    adapter.AddParameterToSelectCommand("@CodeType", CodeType);
                    adapter.Fill(dtGetData);
                }

                if (dtGetData.Rows.Count > 0 && int.TryParse(dtGetData.Rows[0]["CodeID"].ToString(), out int codeId))
                {
                    using (BasePage basePage = new BasePage())
                    {
                        if (UpdateCAPTCHACodeStatus(codeId, CodeType, Year))
                        {
                            result = true;
                        }
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateCAPTCHACodeStatus：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新指定驗證碼（CAPTCHACode）的使用狀態，並記錄使用時間。
        /// </summary>
        /// <param name="CodeID">驗證碼識別碼</param>
        /// <param name="CodeType">驗證碼方式 0-sms 1-email。</param>
        /// <param name="Year">資料庫年度</param>
        /// <returns>true=更新成功；false=更新失敗</returns>
        public bool UpdateCAPTCHACodeStatus(
            int CodeID,
            int CodeType,
            string Year)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                                UPDATE Temple_{Year}..CAPTCHACode
                                SET 
                                    CodeType = @CodeType,
                                    Status = 1,
                                    UseDate = @UseDate,
                                    UseDateString = @UseDateString
                                WHERE CodeID = @CodeID;
                            ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@UseDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@UseDateString", dtNow.ToString("yyyy-MM-dd"));
                    adapter.AddParameterToSelectCommand("@CodeID", CodeID);
                    adapter.AddParameterToSelectCommand("@CodeType", CodeType);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateCAPTCHACodeStatus：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_{TempleString}_Purdue 的 AppTag 欄位（含防呆）。
        /// </summary>
        /// <param name="UniqueID">交易流水表唯一識別碼。</param>
        /// <param name="TempleString">動態宮廟字串（如 da / ty / wjsan）。</param>
        /// <param name="KindString">動態活動項目字串（如 Lights / Purdue / Supplies）。</param>
        /// <param name="AppTag">要更新的 AppTag 值。</param>
        /// <param name="Year">年度字串。</param>
        /// <returns>true 表示更新成功；否則 false。</returns>
        public bool UpdateAppChargeAppTag(
            int UniqueID,
            string TempleString,
            string KindString,
            string AppTag,
            string Year)
        {
            bool bResult = false;

            try
            {
                // --------------------------------------------------------
                // 防呆 1：TempleString 白名單檢查（必要）
                // --------------------------------------------------------
                //string[] allowedTempleCodes = { "da", "ty", "fs", "lb", "ssy", "sbbt" };
                //// 依你的系統補上你用到的所有 TempleString
                //// 建議未來可集中管理

                //if (!allowedTempleCodes.Contains(TempleString.ToLower()))
                //{
                //    // 不合法的 table 名稱 → 防止 SQL Injection
                //    twbobibobi.Data.BasePage basePage2 = new twbobibobi.Data.BasePage();
                //    basePage2.SaveErrorLog("UpdateAppChargeAppTag：TempleString 非法 → " + TempleString);
                //    return false;
                //}

                // --------------------------------------------------------
                // 防呆 1：TempleString 不能為 null 或空
                // --------------------------------------------------------
                if (string.IsNullOrWhiteSpace(TempleString))
                    return false;

                // --------------------------------------------------------
                // 防呆 2：KindString 不能為 null 或空
                // --------------------------------------------------------
                if (string.IsNullOrWhiteSpace(KindString))
                    return false;

                // --------------------------------------------------------
                // 防呆 3：AppTag 不能為 null 或空
                // --------------------------------------------------------
                if (string.IsNullOrWhiteSpace(AppTag))
                    return false;

                // --------------------------------------------------------
                // 防呆 3：避免 AppTag 內含不當符號
                // （可視需求擴充，以下先過濾單引號）
                // --------------------------------------------------------
                AppTag = AppTag.Replace("'", ""); // 保護性寫法

                string sql = $@"
                        UPDATE Temple_{Year}..APPCharge_{TempleString}_{KindString}
                        SET AppTag = @AppTag
                        WHERE UniqueID = @UniqueID;
                       ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@AppTag", AppTag + ",1");
                    adapter.AddParameterToSelectCommand("@UniqueID", UniqueID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateAppChargeAppTag：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 InvoiceDetail 的發票資訊（安全參數化版）
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Kind">服務項目。</param>
        /// <param name="InvoiceNumber">發票號碼。</param>
        /// <param name="RawJson">原始 JSON 字串（發票詳細資訊）。</param>
        /// <param name="Status">更新狀態。</param>
        /// <param name="Year">資料庫年度。</param>
        /// <returns>true 表示更新成功；否則 false。</returns>
        public bool UpdateInvoiceDetail(
            int ApplicantID,
            int AdminID,
            int Kind,
            string InvoiceNumber,
            string RawJson,
            string Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                // --------------------------------------------------------
                // 防呆 1：InvoiceNumber 不能為 null 或空
                // --------------------------------------------------------
                if (string.IsNullOrWhiteSpace(InvoiceNumber))
                    return false;

                // --------------------------------------------------------
                // 防呆 1：RawJson 不能為 null 或空
                // --------------------------------------------------------
                if (string.IsNullOrWhiteSpace(RawJson))
                    return false;

                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $@"
                        UPDATE Temple_{Year}..InvoiceDetail
                        SET 
                            Status = @Status,
                            InvoiceNumber = @InvoiceNumber,
                            InvoiceInfo = @RawJson,
                            UpdateDate = @UpdateDate
                        WHERE ApplicantID = @ApplicantID
                          AND AdminID = @AdminID
                          AND Kind = @Kind;
                      ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@InvoiceNumber", InvoiceNumber);
                    adapter.AddParameterToSelectCommand("@RawJson", RawJson);
                    adapter.AddParameterToSelectCommand("@UpdateDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    adapter.AddParameterToSelectCommand("@Kind", Kind);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateInvoiceDetail：\r\n" + detailedError);
            }

            return bResult;
        }


        #region 點燈資料更新 (Lights)

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_da(
            int ApplicantID, 
            int AdminID, 
            int Cost, 
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_da_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_da(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_h(
            int ApplicantID, 
            int AdminID, 
            int Cost, 
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_h_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_h(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <summary>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_wu(
            int ApplicantID, 
            int AdminID, 
            int Cost, 
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wu_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_wu(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_Fu(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fu_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_Fu(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_Luer(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Luer_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_Luer(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_Fw(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fw_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_Fw(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_dh(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_dh_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_dh(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_Hs(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Hs_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_Hs(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_Hs：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_Lk(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Lk_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_Lk(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_ma(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ma_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_ma(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_jb(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_jb_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_jb(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_jb：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_wjsan(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wjsan_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_wjsan(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_ld(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ld_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_ld(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_ld：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_wh(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wh_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_wh(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_wh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_st(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_st_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_st(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_bj(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_bj_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_bj(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_bj：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_sbbt(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_sbbt_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_sbbt(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_sbbt：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_bpy(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_bpy_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_bpy(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_bpy：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_ssy(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ssy_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_ssy(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_ssy：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_da(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_da_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_da_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_da：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_h(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_h_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_h_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_h：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_wu(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wu_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wu_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_wu：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_Fu(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fu_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fu_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_Fu：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_Luer(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Luer_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Luer_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_Luer：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_Fw(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fw_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fw_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_Fw：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_dh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_dh_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_dh_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_dh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 五股賀聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_Hs(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Hs_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Hs_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_Hs：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_Lk(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Lk_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Lk_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_Lk：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_ma(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ma_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ma_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_ma：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_jb(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_jb_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_jb_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_jb：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_wjsan(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wjsan_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wjsan_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_wjsan：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_ld(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ld_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ld_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_ld：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_wh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wh_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wh_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_wh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_st(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_st_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_st_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_st：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_bj(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_bj_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_bj_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_bj：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_sbbt(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_sbbt_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_sbbt_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_sbbt：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_bpy(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_bpy_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_bpy_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_bpy：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_ssy(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ssy_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ssy_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_ssy：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_da_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_da(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_da_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_h_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_h(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_h_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_h：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wu_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_wu(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wu_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fu_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_Fu(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fu_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_Fu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Luer_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_Luer(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Luer_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_Luer：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fw_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_Fw(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fw_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_dh_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_dh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_dh_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Hs_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_Hs(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Hs_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_Hs：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Lk_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_Lk(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Lk_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ma_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_ma(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ma_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_jb_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_jb(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_jb_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wjsan_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_wjsan(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wjsan_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ld_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_ld(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ld_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_ld：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wh_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_wh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wh_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_st_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_st(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_st_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_st：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_bj_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_bj(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_bj_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_bj：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_sbbt_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_sbbt(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_sbbt_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_sbbt：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_bpy_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_bpy(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_bpy_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_bpy：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ssy_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_ssy(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ssy_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_ssy：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_da_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_da(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_da_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_h_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_h(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_h_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_h_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_h：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wu_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_wu(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wu_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fu_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_Fu(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fu_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fu_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_Fu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Luer_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_Luer(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Luer_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Luer_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_Luer：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fw_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_Fw(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fw_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_dh_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_dh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_dh_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Hs_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_Hs(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Hs_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Hs_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_Hs：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Lk_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_Lk(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Lk_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ma_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_ma(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ma_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_jb_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_jb(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_jb_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wjsan_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_wjsan(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wjsan_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ld_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_ld(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ld_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ld_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_ld：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wh_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_wh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wh_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_st_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_st(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_st_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_st_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_st：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_bj_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_bj(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_bj_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_bj_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_bj：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_sbbt_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_sbbt(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sbbt_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_sbbt_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_sbbt：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_bpy_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_bpy(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_bpy_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_bpy_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_bpy：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ssy_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_ssy(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ssy_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ssy_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_ssy：\r\n" + detailedError);
            }

            return bResult;
        }

        #region －－ 點燈 訂單編號更新 －－

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_da_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_da_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_da_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        HashSet<int> usedSet = usedNumsByType[dbLightsType];

                        // 找可用號碼（1 ~ 6000）
                        int nextNum = -1;
                        for (int cand = 1; cand <= 6000; cand++)
                        {
                            if (!usedSet.Contains(cand))
                            {
                                nextNum = cand;
                                break;
                            }
                        }

                        // 若已滿 → 從 5001 起找
                        //if (nextNum == -1)
                        //{
                        //    int cand = 5001;
                        //    while (usedSet.Contains(cand))
                        //        cand++;

                        //    nextNum = cand;
                        //}

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "光0"; break;  // 光明燈 → 「光0####」
                            case 4: prefix = "太0"; break;  // 安太歲 → 「太0####」
                            case 5: prefix = "文0"; break;  // 文昌燈 → 「文0####」
                        }

                        string numString = prefix + Num2String(nextNum);
                        Lightslist[i] = numString;          // 單純存編號字串

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_da_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_da_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 新港奉天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_h_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_h_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_h_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        int nextNum = 1001;
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "S"; break;  // 光明燈
                            case 4: prefix = "A"; break;  // 安太歲
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;          // 單純存編號字串

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_h_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_h_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 北港武德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_wu_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_wu_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_wu_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;
                        if (dbLightsType == 6) nextNum = 25001; // 財神燈

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "WLS"; break;  // 光明燈
                            case 4: prefix = "WLA"; break;  // 安太歲
                            case 6: prefix = ""; break;     // 財神燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 6: typeName = "財神燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_wu_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_wu_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 西螺福興宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_Fu_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_Fu_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_Fu_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "FUS"; break;      // 光明燈
                            case 4: prefix = "FUA"; break;      // 安太歲
                            case 5: prefix = "FUM"; break;      // 文昌燈
                            case 6: prefix = "FUT"; break;      // 財神燈
                            case 8: prefix = "FUY"; break;      // 藥師佛燈
                            case 24: prefix = "FUKY"; break;    // 觀音佛祖燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 6: typeName = "財神燈"; break;
                            case 8: typeName = "藥師佛燈"; break;
                            case 24: typeName = "觀音佛祖燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_Fu_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_Fu_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_Luer_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_Luer_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_Luer_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "LLS"; break;      // 光明燈
                            case 4: prefix = "LLA"; break;      // 安太歲
                            case 5: prefix = "LLW"; break;      // 文昌燈
                            case 7: prefix = "LLM"; break;      // 姻緣燈
                            case 9: prefix = "LLT"; break;      // 財利燈
                            case 11: prefix = "LLF"; break;     // 福壽燈
                            case 12: prefix = "LLP"; break;     // 寵物平安燈
                            case 20: prefix = "LLYM"; break;    // 月老姻緣燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 7: typeName = "姻緣燈"; break;
                            case 9: typeName = "財利燈"; break;
                            case 11: typeName = "福壽燈"; break;
                            case 12: typeName = "寵物平安燈"; break;
                            case 20: typeName = "月老姻緣燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_Luer_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_Luer_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_ty_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "TYS"; break;      // 光明燈
                            case 4: prefix = "TYA"; break;      // 安太歲
                            case 6: prefix = "TYT"; break;      // 財神燈
                            case 8: prefix = "TYY"; break;      // 藥師燈
                            case 10: prefix = "TYN"; break;     // 貴人燈
                            case 11: prefix = "TYL"; break;     // 福祿燈
                            case 21: prefix = "TYM"; break;     // 孝親祈福燈
                            case 33: prefix = "TYSM"; break;    // 智慧燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 6: typeName = "財神燈"; break;
                            case 8: typeName = "藥師燈"; break;
                            case 10: typeName = "貴人燈"; break;
                            case 11: typeName = "福祿燈"; break;
                            case 21: typeName = "孝親祈福燈"; break;
                            case 33: typeName = "智慧燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 斗六五路財神宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_Fw_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_Fw_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_Fw_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "FWS"; break;      // 貴人燈(光明燈)
                            case 4: prefix = "FWA"; break;      // 安太歲
                            case 6: prefix = "FWT"; break;      // 發財燈
                            case 7: prefix = "FWM"; break;      // 月老桃花燈
                            case 8: prefix = "FWY"; break;      // 消災延壽燈
                            case 12: prefix = "FWP"; break;     // 寵物平安燈
                            case 19: prefix = "FW2T"; break;    // 財庫燈
                            case 25: prefix = "FWTDL"; break;   // 財神斗/一個月
                            case 34: prefix = "FWFDL"; break;   // 發財斗/一個月
                            case 35: prefix = "FWMDL"; break;   // 姻緣斗/一個月
                            case 36: prefix = "FWBDL"; break;   // 貴人斗/一個月
                            case 37: prefix = "FWYDL"; break;   // 消災延壽斗/一個月
                            case 38: prefix = "FW3TDL"; break;  // 財神斗/三個月
                            case 39: prefix = "FW3FDL"; break;  // 發財斗/三個月
                            case 40: prefix = "FW3MDL"; break;  // 姻緣斗/三個月
                            case 41: prefix = "FW3BDL"; break;  // 貴人斗/三個月
                            case 42: prefix = "FW3YDL"; break;  // 消災延壽斗/三個月
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "貴人燈(光明燈)"; break;
                            case 4: typeName = "安太歲"; break;
                            case 6: typeName = "發財燈"; break;
                            case 7: typeName = "月老桃花燈"; break;
                            case 8: typeName = "消災延壽燈"; break;
                            case 12: typeName = "寵物平安燈"; break;
                            case 19: typeName = "財庫燈"; break;
                            case 25: typeName = "財神斗/一個月"; break;
                            case 34: typeName = "發財斗/一個月"; break;
                            case 35: typeName = "姻緣斗/一個月"; break;
                            case 36: typeName = "貴人斗/一個月"; break;
                            case 37: typeName = "消災延壽斗/一個月"; break;
                            case 38: typeName = "財神斗/三個月"; break;
                            case 39: typeName = "發財斗/三個月"; break;
                            case 40: typeName = "姻緣斗/三個月"; break;
                            case 41: typeName = "貴人斗/三個月"; break;
                            case 42: typeName = "消災延壽斗/三個月"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_Fw_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_Fw_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_dh_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_dh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_dh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "DHS"; break;      // 光明燈
                            case 4: prefix = "DHA"; break;      // 安太歲
                            case 5: prefix = "DHW"; break;      // 文昌燈
                            case 9: prefix = "DHT"; break;      // 財利燈
                            case 13: prefix = "DHD"; break;     // 龍王燈
                            case 14: prefix = "DHTI"; break;    // 虎爺燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 9: typeName = "財利燈"; break;
                            case 13: typeName = "龍王燈"; break;
                            case 14: typeName = "虎爺燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_dh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_dh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 五股賀勝宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_Hs_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_Hs_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_Hs_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "HSS"; break;      // 光明燈
                            case 4: prefix = "HSA"; break;      // 安太歲
                            case 5: prefix = "HSW"; break;      // 文昌燈
                            case 8: prefix = "HSY"; break;      // 藥師燈
                            case 9: prefix = "HST"; break;      // 財利燈
                            case 16: prefix = "HS2S"; break;    // 玉皇燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 8: typeName = "藥師燈"; break;
                            case 9: typeName = "財利燈"; break;
                            case 16: typeName = "玉皇燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_Hs_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_Hs_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 鹿港城隍廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_Lk_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_Lk_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_Lk_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "LKS"; break;      // 元神光明燈
                            case 4: prefix = "LKA"; break;      // 太歲平安符
                            case 5: prefix = "LKW"; break;      // 文魁智慧燈
                            case 6: prefix = "LKT"; break;      // 正財福報燈
                            case 15: prefix = "LKAA"; break;    // 轉運納福燈
                            case 16: prefix = "LKSS"; break;    // 光明燈上層
                            case 17: prefix = "LK2T"; break;    // 偏財旺旺燈
                            case 18: prefix = "LK3T"; break;    // 廣進安財庫
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "元神光明燈"; break;
                            case 4: typeName = "太歲平安符"; break;
                            case 5: typeName = "文魁智慧燈"; break;
                            case 6: typeName = "正財福報燈"; break;
                            case 15: typeName = "轉運納福燈"; break;
                            case 16: typeName = "光明燈上層"; break;
                            case 17: typeName = "偏財旺旺燈"; break;
                            case 18: typeName = "廣進安財庫"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_Lk_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_Lk_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_ma_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_ma_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_ma_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "MAS"; break;  // 光明燈
                            case 4: prefix = "MAA"; break;  // 安太歲
                            case 5: prefix = "MAW"; break;  // 五文昌燈
                            case 6: prefix = "MAT"; break;  // 福財燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 5: typeName = "五文昌燈"; break;
                            case 6: typeName = "福財燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_ma_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_ma_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 進寶財神廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_jb_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_jb_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_jb_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "JBS"; break;      // 光明燈
                            case 4: prefix = "JBA"; break;      // 安太歲
                            case 9: prefix = "JBT"; break;      // 財利燈
                            case 10: prefix = "JBN"; break;     // 貴人燈
                            case 12: prefix = "JBP"; break;     // 寵物平安燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 9: typeName = "財利燈"; break;
                            case 10: typeName = "貴人燈"; break;
                            case 12: typeName = "寵物平安燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_jb_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_jb_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_wjsan_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_wjsan_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_wjsan_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "WJSS"; break;     // 光明燈
                            case 4: prefix = "WJSA"; break;     // 安太歲
                            case 5: prefix = "WJSW"; break;     // 文昌燈
                            case 6: prefix = "WJST"; break;     // 財神燈
                            case 8: prefix = "WJSY"; break;     // 藥師燈
                            case 22: prefix = "WJSC"; break;    // 事業燈
                            case 23: prefix = "WJSFS"; break;   // 全家光明燈
                            case 25: prefix = "WJSTDL"; break;  // 財神斗
                            case 26: prefix = "WJSCDL"; break;  // 事業斗
                            case 27: prefix = "WJSPDL"; break;  // 平安斗
                            case 28: prefix = "WJSWDL"; break;  // 文昌斗
                            case 29: prefix = "WJSYDL"; break;  // 藥師斗
                            case 30: prefix = "WJSPSDL"; break; // 元神斗
                            case 31: prefix = "WJSLDL"; break;  // 福祿壽斗
                            case 32: prefix = "WJSKYDL"; break; // 觀音斗
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 6: typeName = "財神燈"; break;
                            case 8: typeName = "藥師燈"; break;
                            case 22: typeName = "事業燈"; break;
                            case 23: typeName = "全家光明燈"; break;
                            case 25: typeName = "財神斗"; break;
                            case 26: typeName = "事業斗"; break;
                            case 27: typeName = "平安斗"; break;
                            case 28: typeName = "文昌斗"; break;
                            case 29: typeName = "藥師斗"; break;
                            case 30: typeName = "元神斗"; break;
                            case 31: typeName = "福祿壽斗"; break;
                            case 32: typeName = "觀音斗"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_wjsan_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_wjsan_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 桃園龍德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_ld_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_ld_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_ld_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "LDS"; break;  // 元辰光明燈
                            case 4: prefix = "LDA"; break;  // 安太歲
                            case 5: prefix = "LDW"; break;  // 文昌功名燈
                            case 6: prefix = "LDT"; break;  // 五路財神燈
                            case 8: prefix = "LDY"; break;  // 健康延壽燈
                            case 20: prefix = "LDYM"; break;  // 月老姻緣燈
                            case 33: prefix = "LDSL"; break;  // 明心智慧燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "元辰光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 5: typeName = "文昌功名燈"; break;
                            case 6: typeName = "五路財神燈"; break;
                            case 8: typeName = "健康延壽燈"; break;
                            case 20: typeName = "月老姻緣燈"; break;
                            case 33: typeName = "明心智慧燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_ld_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_ld_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 基隆悟玄宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_wh_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_wh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_wh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "WHS"; break;      // 光明燈
                            case 5: prefix = "WHW"; break;      // 文昌燈
                            case 12: prefix = "WHP"; break;     // 寵物平安燈
                            case 50: prefix = "WHSP"; break;    // 光明燈+批流年
                            case 51: prefix = "WHWP"; break;    // 文昌燈+批流年
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 12: typeName = "寵物平安燈"; break;
                            case 50: typeName = "光明燈+批流年"; break;
                            case 51: typeName = "文昌燈+批流年"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_wh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_wh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 松柏嶺受天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_st_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_st_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_st_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "STS"; break;  // 光明燈
                            case 4: prefix = "STA"; break;  // 安奉太歲
                            case 5: prefix = "STW"; break;  // 文昌燈
                            case 6: prefix = "STT"; break;  // 財神燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安奉太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 6: typeName = "財神燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_st_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_st_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 池上北極玄天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_bj_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_bj_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_bj_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "BJS"; break;  // 平安燈(光明燈)
                            case 4: prefix = "BJA"; break;  // 太歲燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "平安燈"; break;
                            case 4: typeName = "太歲燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_bj_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_bj_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 慈惠石壁部堂
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_sbbt_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_sbbt_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_sbbt_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "SBBTS"; break;    // 光明燈
                            case 4: prefix = "SBBTA"; break;    // 太歲燈
                            case 5: prefix = "SBBTW"; break;    // 文昌燈
                            case 8: prefix = "SBBTY"; break;    // 特別健康燈
                            case 10: prefix = "SBBTN"; break;   // 特別貴人燈
                            case 22: prefix = "SBBTC"; break;   // 特別事業登
                            case 44: prefix = "SBBTB"; break;   // 求子燈
                            case 45: prefix = "SBBTP"; break;   // 護子燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "太歲燈"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 8: typeName = "特別健康燈"; break;
                            case 10: typeName = "特別貴人燈"; break;
                            case 22: typeName = "特別事業登"; break;
                            case 44: typeName = "求子燈"; break;
                            case 45: typeName = "護子燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_sbbt_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_sbbt_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 真武山受玄宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_bpy_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_bpy_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_bpy_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "BPYS"; break;  // 光明燈
                            case 4: prefix = "BPYA"; break;  // 安太歲
                            case 5: prefix = "BPYW"; break;  // 文昌燈
                            case 9: prefix = "BPYT"; break;  // 財利燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "光明燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 9: typeName = "財利燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_bpy_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_bpy_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 點燈 - 壽山巖觀音寺
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_ssy_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_ssy_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_ssy_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 3: prefix = "SSYS"; break;  // 平安燈(光明燈)
                            case 4: prefix = "SSYA"; break;  // 安太歲
                            case 5: prefix = "SSYW"; break;  // 文昌燈
                            case 6: prefix = "SSYT"; break;  // 招財燈
                            case 7: prefix = "SSYM"; break;  // 姻緣燈
                            case 10: prefix = "SSYN"; break;  // 貴人燈
                            case 43: prefix = "SSYY"; break;  // 元辰燈
                            case 46: prefix = "SSYB"; break;  // 添丁燈
                            case 47: prefix = "SSYH"; break;  // 婚姻燈
                            case 48: prefix = "SSYI"; break;  // 安太陰
                            case 49: prefix = "SSYO"; break;  // 安太陽
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 3: typeName = "平安燈"; break;
                            case 4: typeName = "安太歲"; break;
                            case 5: typeName = "文昌燈"; break;
                            case 6: typeName = "招財燈"; break;
                            case 7: typeName = "姻緣燈"; break;
                            case 10: typeName = "貴人燈"; break;
                            case 43: typeName = "元辰燈"; break;
                            case 46: typeName = "添丁燈"; break;
                            case 47: typeName = "婚姻燈"; break;
                            case 48: typeName = "安太陰"; break;
                            case 49: typeName = "安太陽"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_ssy_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_ssy_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #region 普度資料更新 (Purdue)

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_da(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_da_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_da(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_h(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_h_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_h(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_h：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_wu(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wu_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_wu(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_Fu(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fu_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_Fu(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_Fu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_Luer(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Luer_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_Luer(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_Luer：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_Fw(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fw_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_Fw(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_dh(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_dh_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_dh(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_Lk(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Lk_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_Lk(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_ma(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ma_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_ma(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Purdue_wjsan(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wjsan_Purdue WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Purdue_wjsan(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Purdue_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_da(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_da_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_da_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_da：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_h(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_h_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_h_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_h：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_wu(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wu_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wu_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_wu：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_Fu(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fu_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fu_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_Fu：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_Luer(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Luer_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Luer_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_Luer：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_Fw(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fw_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fw_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_Fw：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_dh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_dh_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_dh_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_dh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_Lk(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Lk_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Lk_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_Lk：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_ma(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ma_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ma_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_ma：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 進寶財神廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_jb(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_jb_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_jb_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_jb：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_wjsan(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wjsan_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wjsan_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_wjsan：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 桃園龍德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_ld(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ld_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ld_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_ld：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 普度 - 基隆悟玄宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Purdue_wh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wh_Purdue
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wh_Purdue
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Purdue_wh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_da_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_da(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_da_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_h_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_h(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_h_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_h：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wu_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_wu(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wu_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fu_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_Fu(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fu_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_Fu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Luer_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_Luer(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Luer_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_Luer：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fw_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_Fw(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fw_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_dh_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_dh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_dh_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Lk_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_Lk(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Lk_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ma_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_ma(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ma_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_jb_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_jb(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_jb_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wjsan_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_wjsan(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wjsan_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ld_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_ld(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ld_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_ld：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wh_Purdue 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Purdue_wh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wh_Purdue
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Purdue_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_da_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_da(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_da_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_h_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_h(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_h_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_h_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_h：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wu_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_wu(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wu_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fu_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_Fu(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fu_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fu_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_Fu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Luer_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_Luer(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Luer_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Luer_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_Luer：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fw_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_Fw(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fw_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_dh_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_dh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_dh_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Lk_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_Lk(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Lk_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ma_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_ma(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ma_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_jb_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_jb(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_jb_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wjsan_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_wjsan(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wjsan_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ld_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_ld(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ld_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ld_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_ld：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wh_Purdue 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Purdue_wh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Purdue
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wh_Purdue
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Purdue_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        #region －－ 普度 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="PurdueType">活動代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_da_Info(
            int applicantID,
            int PurdueType,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                // 分別蒐集「超拔」與「贊普」已用號碼
                var existingFNums = new HashSet<int>();
                var existingZNums = new HashSet<int>();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT PurdueType, Num
                                                FROM Temple_{Year}..Purdue_da_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";


                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        // 把所有 Num 值放入 existingNums
                        foreach (DataRow row in dtExisting.Rows)
                        {
                            if (row["Num"] != DBNull.Value)
                            {
                                int num = Convert.ToInt32(row["Num"]);
                                int type = Convert.ToInt32(row["PurdueType"]);
                                if (type == 1)
                                    existingZNums.Add(num);
                                else
                                    existingFNums.Add(num);
                            }
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID, PurdueType
                                                FROM Temple_{Year}..Purdue_da_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);
                        int dbPurdueType = Convert.ToInt32(row["PurdueType"]);

                        // 嘗試在 1～5000 區段找缺口
                        var existingNums = dbPurdueType == 1 ? existingZNums : existingFNums;
                        int nextNum = -1;
                        for (int cand = 1; cand <= 5000; cand++)
                        {
                            if (!existingNums.Contains(cand))
                            {
                                nextNum = cand;
                                break;
                            }
                        }

                        // 根據活動項目決定前綴字串
                        string prefix = dbPurdueType == 1 ? "Z" : "F";

                        string numString = prefix + Num2String(nextNum);
                        Purduelist[i] = numString;          // 單純存編號字串

                        // 組成要返回前端的「活動項目:編號」
                        string typeName = "";
                        switch (dbPurdueType)
                        {
                            case 1: typeName = "贊普"; break;
                            default: typeName = "超拔"; break;
                        }

                        purduelist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把剛分配的 nextNum 加到 existingNums，避免下次迴圈重複
                        existingNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", Purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_da_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_da_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 新港奉天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_h_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_h_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_h_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "H";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;          // 單純存編號字串
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_h_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_h_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 北港武德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="PurdueType">活動代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_wu_Info(
            int applicantID,
            int PurdueType,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_wu_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_wu_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "WUPU";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_wu_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_wu_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 西螺福興宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_Fu_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_Fu_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_Fu_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "F";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_Fu_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_Fu_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 台南正統鹿耳門聖母廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_Luer_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_Luer_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_Luer_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "L";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_Luer_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_Luer_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_ty_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "TY";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 斗六五路財神宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_Fw_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_Fw_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_Fw_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "FW";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_Fw_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_Fw_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_dh_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_dh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_dh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "DH";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_dh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_dh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 鹿港城隍廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_Lk_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_Lk_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_Lk_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "LK";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_Lk_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_Lk_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_ma_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_ma_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_ma_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "MA";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_ma_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_ma_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 進寶財神廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_jb_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_jb_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_jb_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "JB";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_jb_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_jb_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_wjsan_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_wjsan_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_wjsan_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "WJP";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_wjsan_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_wjsan_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 桃園龍德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_ld_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_ld_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_ld_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "LD";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_ld_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_ld_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 普度 - 基隆悟玄宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息</param>
        /// <param name="purduelist">回傳訂單陣列</param>
        /// <param name="Purduelist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdatePurdue_wh_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] purduelist,
            ref string[] Purduelist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Purdue_wh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的活動項目，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT PurdueID
                                                FROM Temple_{Year}..Purdue_wh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY PurdueID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    purduelist = new string[rowCount];
                    Purduelist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int PurdueID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbPurdueID = Convert.ToInt32(row["PurdueID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 根據活動項目決定前綴字串
                        string prefix = "WH";
                        string numString = prefix + nextNum.ToString();
                        Purduelist[i] = numString;
                        purduelist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbPurdueID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNums，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg = "您已完成中元普渡線上報名！訂單編號" + string.Join(",", purduelist) + "。廟方將於農曆七月期間舉辦法會，屆時由專人代為誦經超薦。感謝您的參與與功德發心。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Purdue_wh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE PurdueID = @PurdueID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@PurdueID", rec.PurdueID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdatePurdue_wh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #region 商品小舖資料更新 (Product)

        /// <summary>
        /// 更新錢母擺件商品小舖購買人資料的金額與狀態。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">更新後的金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若更新成功則回傳 <c>true</c>；
        /// 若找不到資料或更新失敗則回傳 <c>false</c>。
        /// </returns>
        public bool Updatecost2applicantinfo_Moneymother(
            int ApplicantID, 
            int AdminID, 
            int Cost, 
            string Year)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Moneymother " +
                             "WHERE ApplicantID = @ApplicantID AND AdminID = @AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.SetSqlCommandBuilder();
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);

                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Moneymother(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Moneymother：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Moneymother 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Moneymother(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Moneymother
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Moneymother：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新商品小舖購買人資料的金額與狀態。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">更新後的金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>
        /// 若更新成功則回傳 <c>true</c>；
        /// 若找不到資料或更新失敗則回傳 <c>false</c>。
        /// </returns>
        public bool Updatecost2applicantinfo_Product(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Product " +
                             "WHERE ApplicantID = @ApplicantID AND AdminID = @AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.SetSqlCommandBuilder();
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);

                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Moneymother(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Product：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Product 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Product(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Product
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Product：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 依據 ApplicantID 更新商品小舖所有商品使用次數
        /// </summary>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Year">年度字串</param>
        /// <returns>true 表示成功更新至少一筆</returns>
        public bool UpdateCount2Product(
            int ApplicantID,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                string sql = $@"
                                SELECT *
                                FROM Temple_{Year}..view_ProductInfolist
                                WHERE ApplicantID = @ApplicantID
                                  AND Status = 0
                            ";

                using (DatabaseAdapter da = new DatabaseAdapter(sql, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dt = new DataTable();
                    da.Fill(dt);

                    for (int i = 0; i < dt.Rows.Count; i++)
                    {
                        int productID = Convert.ToInt32(dt.Rows[i]["ProductID"]);
                        int typeID = Convert.ToInt32(dt.Rows[i]["TypeID"]);
                        int count = Convert.ToInt32(dt.Rows[i]["Count"]);

                        bool updated = UpdateCount2Product(productID, typeID, count);
                        if (updated)
                            bResult = true; // 只要有一筆成功就算成功
                    }
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateCount2Product(ApplicantID)：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新錢母商品小舖商品使用次數（view_Product_MoneymotherwithAPPCharge）
        /// </summary>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Year">年度字串</param>
        /// <returns>true 表示成功更新至少一筆</returns>
        public bool UpdateMontherCount2Product(
            int ApplicantID,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                string sql = $@"
                                SELECT *
                                FROM Temple_{Year}..view_Product_MoneymotherwithAPPCharge
                                WHERE ApplicantID = @ApplicantID
                                  AND Status = 0
                            ";

                using (DatabaseAdapter da = new DatabaseAdapter(sql, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dt = new DataTable();
                    da.Fill(dt);

                    for (int i = 0; i < dt.Rows.Count; i++)
                    {
                        int productID = 0;
                        int count = Convert.ToInt32(dt.Rows[i]["Count"]);
                        string type = dt.Rows[i]["Type"].ToString();
                        int typeID = 0; // 固定 0（你的邏輯）

                        switch (type)
                        {
                            case "1":
                                // 鎮宅、開運錢母擺件
                                productID = 19;
                                break;

                            case "5":
                                // 招財大嘴貓(白色)
                                productID = 72;
                                break;

                            case "6":
                                // 招財大嘴貓(藍色)
                                productID = 70;
                                break;

                            case "7":
                                // 招財大嘴貓(粉色)
                                productID = 73;
                                break;

                            case "8":
                                // 招財大嘴貓(橘色)
                                productID = 71;
                                break;

                            case "9":
                                // 午時水 / 1罐
                                productID = 91;
                                count = count * 1;
                                break;

                            case "10":
                                // 午時水 / 3罐
                                productID = 91;
                                count = count * 3;
                                break;

                            case "11":
                                // 午時水 / 6罐
                                productID = 91;
                                count = count * 6;
                                break;
                        }

                        if (productID > 0)
                        {
                            bool updated = UpdateCount2Product(productID, typeID, count);
                            if (updated)
                                bResult = true;  // 只要有一筆成功就算成功
                        }
                    }
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateMontherCount2Product：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新商品使用次數（Item_Product 或 Product）
        /// </summary>
        /// <param name="ProductID">產品編號</param>
        /// <param name="TypeID">細部產品編號（>0 使用 Item_Product）</param>
        /// <param name="Count">要增加的數量</param>
        /// <returns>true 表示更新成功</returns>
        public bool UpdateCount2Product(
            int ProductID,
            int TypeID,
            int Count)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                string sql = string.Empty;

                if (TypeID > 0)
                {
                    // 更新 Item_Product
                    sql = @"
                            UPDATE Item_Product
                            SET 
                                Usecount = Usecount + @AddCount,
                                UpdateinfoDate = @Date
                            WHERE TypeID = @TypeID
                              AND Status = 0
                        ";
                }
                else
                {
                    // 更新 Product
                    sql = @"
                            UPDATE Product
                            SET 
                                Usecount = Usecount + @AddCount,
                                UpdateinfoDate = @Date
                            WHERE ProductID = @ProductID
                              AND Status = 0
                        ";
                }

                using (DatabaseAdapter da = new DatabaseAdapter(sql, this.DBSource))
                {
                    da.AddParameterToSelectCommand("@AddCount", Count);
                    da.AddParameterToSelectCommand("@Date", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));

                    if (TypeID > 0)
                        da.AddParameterToSelectCommand("@TypeID", TypeID);
                    else
                        da.AddParameterToSelectCommand("@ProductID", ProductID);

                    int affected = da.ExecuteSql();
                    bResult = affected > 0;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateCount2Product(ProductID,TypeID)：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Product 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Product(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Product
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Product
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Product：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Moneymother 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Moneymother(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Moneymother
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Moneymother
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Moneymother：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 取得商品小舖的 AdminID（依 ApplicantID 取最新一筆）
        /// </summary>
        /// <param name="ApplicantID">購買人編號</param>
        /// <param name="Year">年度字串</param>
        /// <returns>AdminID，若無資料則回傳 0</returns>
        public int GetAdminID_Product(
            int ApplicantID,
            string Year)
        {
            int result = 0;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                string sql = $@"
                                SELECT TOP 1 *
                                FROM Temple_{Year}..view_ProductInfolist
                                WHERE Status = 0
                                  AND ApplicantID = @ApplicantID
                                ORDER BY CreateDate DESC
                            ";

                using (DatabaseAdapter da = new DatabaseAdapter(sql, this.DBSource))
                {
                    da.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    DataTable dt = new DataTable();
                    da.Fill(dt);

                    if (dt.Rows.Count > 0)
                    {
                        result = Convert.ToInt32(dt.Rows[0]["AdminID"]);
                    }
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.GetAdminID_Product：\r\n" + detail);
            }

            return result;
        }

        /// <summary>
        /// 更新商品小舖付費資訊（APPCharge_Product）
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Product(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Product
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Product
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Product：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新錢母商品小舖付費資訊（APPCharge_Moneymother）
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Moneymother(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Moneymother
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Moneymother
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Moneymother：\r\n" + detail);
            }

            return bResult;
        }



        #region －－ 商品小舖 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 商品小舖
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="adminID">商品小舖編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="productlist">回傳活動陣列</param>
        /// <param name="Productlist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateProductInfo(
            int applicantID,
            int adminID,
            string Year,
            ref string msg,
            ref string[] productlist,
            ref string[] Productlist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT AdminID, Num
                                                FROM Temple_{Year}..ProductInfo
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各商品小舖對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int aid = Convert.ToInt32(row["AdminID"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(aid))
                                usedNumsByType[aid] = new HashSet<int>();

                            usedNumsByType[aid].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的名單，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT BuyID, AdminID
                                                FROM Temple_{Year}..ProductInfo
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY BuyID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    productlist = new string[rowCount];
                    Productlist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int BuyID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbBuyID = Convert.ToInt32(row["BuyID"]);
                        int dbAdminID = Convert.ToInt32(row["AdminID"]);

                        if (!usedNumsByType.ContainsKey(dbAdminID))
                            usedNumsByType[dbAdminID] = new HashSet<int>();

                        int nextNum = 3001;

                        // 找下一個可用編號 (從 3001 開始往上搜尋)
                        HashSet<int> usedSet = usedNumsByType[dbAdminID];
                        while (usedSet.Contains(nextNum))
                            nextNum++;

                        // 根據商品小舖編號決定前綴字串
                        string prefix = "";
                        switch (adminID)
                        {
                            case 5: prefix = "P"; break; // 新港奉天宮文創小販部
                            case 20: prefix = "FP"; break; // 西螺福興宮文創小販部
                            case 22: prefix = "FG"; break; // 流金富貴商品小舖
                            case 28: prefix = "GOD"; break; // 財神小舖商品小舖
                        }

                        string numString = prefix + nextNum.ToString();
                        Productlist[i] = numString;
                        productlist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbBuyID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", productlist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..ProductInfo
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE BuyID = @BuyID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@BuyID", rec.BuyID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateProductInfo：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 錢母擺件商品小舖 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 錢母擺件商品小舖
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="moneymotherlist">回傳活動陣列（如「祈安植福:STBL1001」）</param>
        /// <param name="Moneymotherlist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateMoneymother_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] moneymotherlist,
            ref string[] Moneymotherlist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..ApplicantInfo_Moneymother
                                                WHERE Status = 2
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT ApplicantID
                                                FROM Temple_{Year}..ApplicantInfo_Moneymother
                                                WHERE ApplicantID = @ApplicantID
                                                  AND (Num = 0 OR Num IS NULL)
                                                ORDER BY ApplicantID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    moneymotherlist = new string[rowCount];
                    Moneymotherlist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int ApplicantID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbApplicantID = Convert.ToInt32(row["ApplicantID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 祈安植福的固定前綴
                        string prefix = "PML";
                        string numString = prefix + nextNum.ToString();

                        Moneymotherlist[i] = numString;
                        moneymotherlist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbApplicantID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", moneymotherlist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..ApplicantInfo_Moneymother
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE ApplicantID = @ApplicantID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@ApplicantID", rec.ApplicantID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateMoneymother_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #region 法會資料更新 (Supplies)

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_wu(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wu_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_wu(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_wu：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_wu2(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wu_Supplies2 WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_wu2(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_wu2：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_wu3(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wu_Supplies3 WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_wu3(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_wu3：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies2_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_Supplies2 WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies2_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies2_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies3_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_Supplies3 WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies3_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies3_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_Fw(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fw_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_Fw(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_dh(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_dh_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_dh(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_Lk(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Lk_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_Lk(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_Lk：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_ma(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ma_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_ma(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies_sx(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_sx_Supplies WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies_sx(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies_sx：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Supplies2_sx(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_sx_Supplies2 WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Supplies2_sx(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Supplies2_sx：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新付費資訊 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_wu(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wu_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wu_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_wu：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 呈疏補庫(天官武財神聖誕補財庫) - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_wu2(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wu_Supplies2
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wu_Supplies2
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_wu2：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_wu3(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wu_Supplies3
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wu_Supplies3
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_wu3：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies2_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_Supplies2
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_Supplies2
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies2_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies3_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_Supplies3
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_Supplies3
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies3_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_Fw(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fw_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fw_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_Fw：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_dh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_dh_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_dh_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_dh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_Lk(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Lk_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Lk_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_Lk：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_ma(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ma_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ma_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_ma：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies_sx(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_sx_Supplies
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_sx_Supplies
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies_sx：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Supplies2_sx(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_sx_Supplies2
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_sx_Supplies2
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Supplies2_sx：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wu_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_wu(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wu_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wu_Supplies2 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_wu2(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wu_Supplies2
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_wu2：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wu_Supplies3 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_wu3(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wu_Supplies3
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_wu3：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_Supplies2 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies2_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_Supplies2
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies2_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_Supplies3 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies3_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_Supplies3
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies3_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fw_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_Fw(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fw_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_dh_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_dh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_dh_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Lk_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_Lk(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Lk_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ma_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_ma(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ma_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_jb_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_jb(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_jb_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ld_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_ld(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ld_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_ld：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wh_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_wh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wh_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_sx_Supplies 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies_sx(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_sx_Supplies
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies_sx：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_sx_Supplies2 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Supplies2_sx(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_sx_Supplies2
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Supplies2_sx：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wu_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_wu(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wu_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_wu：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wu_Supplies2 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_wu2(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wu_Supplies2
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_wu2：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wu_Supplies3 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_wu3(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wu_Supplies3
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wu_Supplies3
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_wu3：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_Supplies2 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies2_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_Supplies2
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies2_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_Supplies3 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies3_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_Supplies3
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_Supplies3
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies3_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fw_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_Fw(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fw_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_dh_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_dh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_dh_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Lk_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_Lk(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Lk_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Lk_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_Lk：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ma_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_ma(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ma_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_jb_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_jb(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_jb_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wh_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_wh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wh_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wh_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_wh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_sx_Supplies 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies_sx(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sx_Supplies
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_sx_Supplies
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies_sx：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_sx_Supplies2 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Supplies2_sx(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_sx_Supplies2
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_sx_Supplies2
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Supplies2_sx：\r\n" + detailedError);
            }

            return bResult;
        }

        #region －－ 下元補庫 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 下元補庫 - 北港武德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「WU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_wu_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_wu_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_wu_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "WU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"下元補庫:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_wu_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_wu_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 呈疏補庫(天官武財神聖誕補財庫)  訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 呈疏補庫(天官武財神聖誕補財庫)  - 北港武德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「W2S1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_wu_Info2(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_wu_info2
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_wu_info2
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "W2S";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_wu_info2
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_wu_Info2：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 企業補財庫 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 企業補財庫 - 北港武德宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「WU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_wu_Info3(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_wu_info3
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_wu_info3
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 2001;

                        // 找下一個可用編號 (從 2001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "W3S";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"企業補財庫:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_wu_info3
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_wu_Info3：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 天赦日招財補運 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「TYSU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_ty_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "TYSU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 天赦日招財補運 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「MASU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_ma_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_ma_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_ma_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "MASU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_ma_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_ma_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 天赦日祭改 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 天赦日祭改 - 進寶財神廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「JB1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_jb_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_jb_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_jb_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "JB";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_jb_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_jb_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 天貺納福添運法會 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 天貺納福添運法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「DHSU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_dh_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_dh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_dh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "DHSU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_dh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_dh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 九九重陽天赦日招財補運 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 九九重陽天赦日招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「TY2SU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies2_ty_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies2_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies2_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "TY2SU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies2_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies2_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 補財庫 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 補財庫 - 斗六五路財神宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「FWBF1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_Fw_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_Fw_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_Fw_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "FWBF";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_Fw_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_Fw_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得訂單資料 - 補財庫 - 鹿港城隍廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「LKBF1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_Lk_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_Lk_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_Lk_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "LKBF";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_Lk_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_Lk_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 赦罪補庫 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 赦罪補庫 - 神霄玉府財神會館
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「SXBF1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_sx_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_sx_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_sx_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "SXBF";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"赦罪補庫:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_sx_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_sx_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 天公生招財補運 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 天公生招財補運 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「TY3SU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies3_ty_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies3_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies3_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "TY3SU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies3_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies3_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 供香轉運 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 供香轉運 - 神霄玉府財神會館
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「SX2BF1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies2_sx_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies2_sx_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies2_sx_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "SX2BF";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"供香轉運:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies2_sx_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies2_sx_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 祈安禮斗 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 祈安禮斗 - 基隆悟玄宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="supplieslist">回傳活動陣列（如「WHSU1001」）</param>
        /// <param name="Supplieslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateSupplies_wh_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] supplieslist,
            ref string[] Supplieslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Supplies_wh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT SuppliesID
                                                FROM Temple_{Year}..Supplies_wh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY SuppliesID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    supplieslist = new string[rowCount];
                    Supplieslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int SuppliesID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbSuppliesID = Convert.ToInt32(row["SuppliesID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "WHSU";
                        string numString = prefix + nextNum.ToString();

                        Supplieslist[i] = numString;
                        supplieslist[i] = $"祈安禮斗:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbSuppliesID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", supplieslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Supplies_wh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE SuppliesID = @SuppliesID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@SuppliesID", rec.SuppliesID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateSupplies_wh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #region 安斗資料更新 (AnDou)

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_AnDou_Fw(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_Fw_AnDou WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_AnDou_Fw(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_AnDou_Fw：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_AnDou_wjsan(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wjsan_AnDou WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_AnDou_wjsan(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_AnDou_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新付費資訊 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_AnDou_Fw(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_Fw_AnDou
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_Fw_AnDou
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_AnDou_Fw：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_AnDou_wjsan(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wjsan_AnDou
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wjsan_AnDou
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_AnDou_wjsan：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_Fw_AnDou 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_AnDou_Fw(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_Fw_AnDou
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_AnDou_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wjsan_AnDou 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_AnDou_wjsan(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wjsan_AnDou
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_AnDou_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_Fw_AnDou 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_AnDou_Fw(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_Fw_AnDou
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_Fw_AnDou
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_AnDou_Fw：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wjsan_AnDou 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_AnDou_wjsan(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_AnDou
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wjsan_AnDou
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_AnDou_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        #region －－ 安斗 訂單編號更新 －－

        /// <summary>
        /// 更新並取得燈號資料 - 安斗 - 斗六五路財神宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="AnDouType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="andoulist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="AnDoulist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateAnDou_Fw_Info(
            int applicantID,
            int AnDouType,
            string Year,
            ref string msg,
            ref string[] andoulist,
            ref string[] AnDoulist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT AnDouType, Num
                                                FROM Temple_{Year}..AnDou_Fw_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["AnDouType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT AnDouID, AnDouType
                                                FROM Temple_{Year}..AnDou_Fw_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY AnDouID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    andoulist = new string[rowCount];
                    AnDoulist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int AnDouID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbAnDouID = Convert.ToInt32(row["AnDouID"]);
                        int dbAnDouType = Convert.ToInt32(row["AnDouType"]);

                        if (!usedNumsByType.ContainsKey(dbAnDouType))
                            usedNumsByType[dbAnDouType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbAnDouType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbAnDouType)
                        {
                            case 25: prefix = "FWTDL"; break;   // 財神斗/一個月
                            case 34: prefix = "FWFDL"; break;   // 發財斗/一個月
                            case 35: prefix = "FWMDL"; break;   // 姻緣斗/一個月
                            case 36: prefix = "FWBDL"; break;   // 貴人斗/一個月
                            case 37: prefix = "FWYDL"; break;   // 消災延壽斗/一個月
                            case 38: prefix = "FW3TDL"; break;  // 財神斗/三個月
                            case 39: prefix = "FW3FDL"; break;  // 發財斗/三個月
                            case 40: prefix = "FW3MDL"; break;  // 姻緣斗/三個月
                            case 41: prefix = "FW3BDL"; break;  // 貴人斗/三個月
                            case 42: prefix = "FW3YDL"; break;  // 消災延壽斗/三個月
                        }

                        string numString = prefix + nextNum.ToString();
                        AnDoulist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbAnDouType)
                        {
                            case 25: typeName = "財神斗/一個月"; break;
                            case 34: typeName = "發財斗/一個月"; break;
                            case 35: typeName = "姻緣斗/一個月"; break;
                            case 36: typeName = "貴人斗/一個月"; break;
                            case 37: typeName = "消災延壽斗/一個月"; break;
                            case 38: typeName = "財神斗/三個月"; break;
                            case 39: typeName = "發財斗/三個月"; break;
                            case 40: typeName = "姻緣斗/三個月"; break;
                            case 41: typeName = "貴人斗/三個月"; break;
                            case 42: typeName = "消災延壽斗/三個月"; break;
                        }

                        andoulist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbAnDouID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", andoulist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..AnDou_Fw_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE AnDouID = @AnDouID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@AnDouID", rec.AnDouID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateAnDou_Fw_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        /// <summary>
        /// 更新並取得燈號資料 - 安斗 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="AnDouType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="andoulist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="AnDoulist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateAnDou_wjsan_Info(
            int applicantID,
            int AnDouType,
            string Year,
            ref string msg,
            ref string[] andoulist,
            ref string[] AnDoulist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT AnDouType, Num
                                                FROM Temple_{Year}..AnDou_wjsan_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["AnDouType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT AnDouID, AnDouType
                                                FROM Temple_{Year}..AnDou_wjsan_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY AnDouID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    andoulist = new string[rowCount];
                    AnDoulist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int AnDouID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbAnDouID = Convert.ToInt32(row["AnDouID"]);
                        int dbAnDouType = Convert.ToInt32(row["AnDouType"]);

                        if (!usedNumsByType.ContainsKey(dbAnDouType))
                            usedNumsByType[dbAnDouType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbAnDouType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbAnDouType)
                        {
                            case 25: prefix = "WJSTDL"; break;  // 財神斗
                            case 26: prefix = "WJSCDL"; break;  // 事業斗
                            case 27: prefix = "WJSPDL"; break;  // 平安斗
                            case 28: prefix = "WJSWDL"; break;  // 文昌斗
                            case 29: prefix = "WJSYDL"; break;  // 藥師斗
                            case 30: prefix = "WJSPSDL"; break; // 元神斗
                            case 31: prefix = "WJSLDL"; break;  // 福祿壽斗
                            case 32: prefix = "WJSKYDL"; break; // 觀音斗
                        }

                        string numString = prefix + nextNum.ToString();
                        AnDoulist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbAnDouType)
                        {
                            case 25: typeName = "財神斗"; break;
                            case 26: typeName = "事業斗"; break;
                            case 27: typeName = "平安斗"; break;
                            case 28: typeName = "文昌斗"; break;
                            case 29: typeName = "藥師斗"; break;
                            case 30: typeName = "元神斗"; break;
                            case 31: typeName = "福祿壽斗"; break;
                            case 32: typeName = "觀音斗"; break;
                        }

                        andoulist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbAnDouID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", andoulist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..AnDou_wjsan_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE AnDouID = @AnDouID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@AnDouID", rec.AnDouID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateAnDou_wjsan_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #region 其他活動資料更新 (Other)

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_EmperorGuansheng_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_EmperorGuansheng WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_EmperorGuansheng_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lingbaolidou_ma(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ma_Lingbaolidou WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lingbaolidou_ma(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_TaoistJiaoCeremony_da(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_da_TaoistJiaoCeremony WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_TaoistJiaoCeremony_da(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lybc_dh(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_dh_Lybc WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lybc_dh(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lybc_dh：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Huaguo_wjsan(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_wjsan_Huaguo WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Huaguo_wjsan(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Huaguo_wjsan：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Lights_ty_mom(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_mom_Lights WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Lights_ty_mom(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Lights_ty_mom：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_Blessing_st(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_st_Blessing WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_Blessing_st(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_Blessing_st：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新購買人資料的費用與狀態 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="AdminID">宮廟編號。</param>
        /// <param name="Cost">實際金額。</param>
        /// <param name="Year">資料年份（例如 "2025"）。</param>
        /// <returns>若更新成功回傳 <c>true</c>，否則回傳 <c>false</c>。</returns>
        public bool Updatecost2applicantinfo_QnLight_ty(
            int ApplicantID,
            int AdminID,
            int Cost,
            string Year)
        {
            bool result = false;
            try
            {
                string sql = $"SELECT TOP 1 * FROM Temple_{Year}..ApplicantInfo_ty_QnLight WHERE ApplicantID=@ApplicantID AND AdminID=@AdminID AND Status = 0";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);
                    adapter.AddParameterToSelectCommand("@AdminID", AdminID);
                    DataTable dt = new DataTable();
                    adapter.Fill(dt);

                    if (dt.Rows.Count > 0 && Convert.ToInt32(dt.Rows[0]["Status"]) == 0)
                    {
                        result = Updateapplicantinfo_QnLight_ty(ApplicantID, Cost, 1, Year);
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updatecost2applicantinfo_QnLight_ty：\r\n" + detailedError);
            }

            return result;
        }

        /// <summary>
        /// 更新付費資訊 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_EmperorGuansheng_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_EmperorGuansheng
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_EmperorGuansheng
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_EmperorGuansheng_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lingbaolidou_ma(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ma_Lingbaolidou
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ma_Lingbaolidou
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lingbaolidou_ma：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_TaoistJiaoCeremony_da(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_da_TaoistJiaoCeremony
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_da_TaoistJiaoCeremony
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_TaoistJiaoCeremony_da：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lybc_dh(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_dh_Lybc
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_dh_Lybc
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lybc_dh：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Huaguo_wjsan(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_wjsan_Huaguo
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_wjsan_Huaguo
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Huaguo_wjsan：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 孝親祈福燈 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Lights_ty_mom(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_mom_Lights
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_mom_Lights
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Lights_ty_mom：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_Blessing_st(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_st_Blessing
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_st_Blessing
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_Blessing_st：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新付費資訊 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="OrderID">訂單編號</param>
        /// <param name="Status">要更新的狀態</param>
        /// <param name="BillIP">付款端 IP</param>
        /// <param name="CallbackLog">回傳紀錄</param>
        /// <param name="Year">年度</param>
        /// <returns>true 表示更新成功；否則 false</returns>
        public bool UpdateChargeStatus_QnLight_ty(
            string OrderID,
            int Status,
            string BillIP,
            string CallbackLog,
            string Year)
        {
            bool bResult = false;
            twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                // ------------------------------------------------------------------
                // 1. 取得現有資料
                // ------------------------------------------------------------------
                string sqlSelect = $@"
                                        SELECT TOP 1 *
                                        FROM Temple_{Year}..APPCharge_ty_QnLight
                                        WHERE OrderID = @OrderID
                                    ";

                DataTable dtDataList = new DataTable();

                using (DatabaseAdapter da = new DatabaseAdapter(sqlSelect, this.DBSource))
                {
                    da.SetSqlCommandBuilder();
                    da.AddParameterToSelectCommand("@OrderID", OrderID);
                    da.Fill(dtDataList);
                }

                // 若沒有資料 → 不更新，直接 return false
                if (dtDataList.Rows.Count == 0)
                    return false;

                // ------------------------------------------------------------------
                // 2. 僅 Status = 0 才能更新（保留你的業務規則）
                // ------------------------------------------------------------------
                int currentStatus = Convert.ToInt32(dtDataList.Rows[0]["Status"]);
                if (currentStatus != 0)
                    return false;

                // ------------------------------------------------------------------
                // 3. 進行更新（參數化）
                // ------------------------------------------------------------------
                string sqlUpdate = $@"
                                        UPDATE Temple_{Year}..APPCharge_ty_QnLight
                                        SET 
                                            Status = @Status,
                                            BillIP = @BillIP,
                                            CallbackLog = @CallbackLog,
                                            ChargeDate = @ChargeDate,
                                            ChargeDateString = @ChargeDateString
                                        WHERE OrderID = @OrderID
                                    ";

                using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                {
                    daUpdate.AddParameterToSelectCommand("@Status", Status);
                    daUpdate.AddParameterToSelectCommand("@BillIP", BillIP ?? "");
                    daUpdate.AddParameterToSelectCommand("@CallbackLog", CallbackLog ?? "");
                    daUpdate.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                    daUpdate.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                    daUpdate.AddParameterToSelectCommand("@OrderID", OrderID);

                    int res = daUpdate.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detail = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                basePage.SaveErrorLog("LightDAC.UpdateChargeStatus_QnLight_ty：\r\n" + detail);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_EmperorGuansheng 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_EmperorGuansheng_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_EmperorGuansheng
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ma_Lingbaolidou 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lingbaolidou_ma(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ma_Lingbaolidou
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_da_TaoistJiaoCeremony 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_TaoistJiaoCeremony_da(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_da_TaoistJiaoCeremony
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_dh_Lybc 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lybc_dh(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_dh_Lybc
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lybc_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_wjsan_Huaguo 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Huaguo_wjsan(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_wjsan_Huaguo
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Huaguo_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_mom_Lights 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Lights_ty_mom(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_mom_Lights
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Lights_ty_mom：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_st_Blessing 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_Blessing_st(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_st_Blessing
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_Blessing_st：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 ApplicantInfo_ty_QnLight 的 Status 與 Cost 欄位資料。
        /// </summary>
        /// <param name="ApplicantID">購買人編號。</param>
        /// <param name="Cost">費用欄位。</param>
        /// <param name="Status">狀態欄位。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <returns>回傳 true 表示更新成功；false 表示未更新任何資料。</returns>
        public bool Updateapplicantinfo_QnLight_ty(
            int ApplicantID,
            int Cost,
            int Status,
            string Year)
        {
            bool bResult = false;

            try
            {
                string sql = $@"
                        UPDATE Temple_{Year}..ApplicantInfo_ty_QnLight
                        SET 
                            Status = @Status,
                            Cost = @Cost
                        WHERE ApplicantID = @ApplicantID;
                    ";

                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@Status", Status);
                    adapter.AddParameterToSelectCommand("@Cost", Cost);
                    adapter.AddParameterToSelectCommand("@ApplicantID", ApplicantID);

                    int res = adapter.ExecuteSql();
                    if (res > 0)
                        bResult = true;
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.Updateapplicantinfo_QnLight_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_EmperorGuansheng 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_EmperorGuansheng_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_EmperorGuansheng
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_EmperorGuansheng
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_EmperorGuansheng_ty：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_jb_BPO 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_BPO_jb(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_jb_BPO
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_jb_BPO
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_BPO_jb：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ma_Lingbaolidou 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lingbaolidou_ma(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ma_Lingbaolidou
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ma_Lingbaolidou
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lingbaolidou_ma：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_da_TaoistJiaoCeremony 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_TaoistJiaoCeremony_da(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_da_TaoistJiaoCeremony
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_da_TaoistJiaoCeremony
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_TaoistJiaoCeremony_da：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_dh_Lybc 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lybc_dh(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_dh_Lybc
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_dh_Lybc
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lybc_dh：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_wjsan_Huaguo 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Huaguo_wjsan(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_wjsan_Huaguo
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_wjsan_Huaguo
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Huaguo_wjsan：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_mom_Lights 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Lights_ty_mom(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_mom_Lights
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_mom_Lights
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Lights_ty_mom：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_st_Blessing 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_Blessing_st(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_st_Blessing
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_st_Blessing
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_Blessing_st：\r\n" + detailedError);
            }

            return bResult;
        }

        /// <summary>
        /// 更新 APPCharge_ty_QnLight 的付款紀錄（更新狀態、交易資料、Callback 記錄等）。
        /// </summary>
        /// <param name="OrderID">訂單編號。</param>
        /// <param name="Transaction_id">金流交易編號。</param>
        /// <param name="Comment">備註。</param>
        /// <param name="BillIP">付款者 IP。</param>
        /// <param name="CallbackLog">回傳紀錄。</param>
        /// <param name="Year">資料年度（例如 2026）。</param>
        /// <param name="ChargeType">回填付款方式。</param>
        /// <param name="Status">回填付款狀態。</param>
        /// <returns>成功更新時回傳 true。</returns>
        public bool UpdateChargeLog_QnLight_ty(
            string OrderID,
            string Transaction_id,
            string Comment,
            string BillIP,
            string CallbackLog,
            string Year,
            ref string ChargeType,
            ref int Status)
        {
            bool bResult = false;

            try
            {
                // 取得台北標準時間
                DateTime dtNow = GetTaipeiNow();

                DataTable dtDataList = new DataTable();

                string sql = $@"
                        SELECT TOP 1 *
                        FROM Temple_{Year}..APPCharge_ty_QnLight
                        WHERE OrderID = @OrderID;
                      ";

                // 查詢付款紀錄
                using (DatabaseAdapter adapter = new DatabaseAdapter(sql, this.DBSource))
                {
                    adapter.AddParameterToSelectCommand("@OrderID", OrderID);
                    adapter.Fill(dtDataList);
                }

                if (dtDataList.Rows.Count == 0)
                    return false;

                // 取出狀態與付款方式
                Status = (int)dtDataList.Rows[0]["Status"];

                if (Status == 0)
                {
                    ChargeType = dtDataList.Rows[0]["ChargeType"].ToString();

                    string updateSql = $@"
                                UPDATE Temple_{Year}..APPCharge_ty_QnLight
                                SET 
                                    Status = 1,
                                    BillIP = @BillIP,
                                    Transaction_id = @Transaction_id,
                                    CallbackLog = @CallbackLog,
                                    Comment = @Comment,
                                    ChargeDate = @ChargeDate,
                                    ChargeDateString = @ChargeDateString
                                WHERE OrderID = @OrderID;
                                ";

                    using (DatabaseAdapter adapter = new DatabaseAdapter(updateSql, this.DBSource))
                    {
                        adapter.AddParameterToSelectCommand("@BillIP", BillIP);
                        adapter.AddParameterToSelectCommand("@Transaction_id", Transaction_id);
                        adapter.AddParameterToSelectCommand("@CallbackLog", CallbackLog);
                        adapter.AddParameterToSelectCommand("@Comment", Comment);
                        adapter.AddParameterToSelectCommand("@ChargeDate", dtNow.ToString("yyyy-MM-dd HH:mm:ss"));
                        adapter.AddParameterToSelectCommand("@ChargeDateString", dtNow.ToString("yyyy-MM-dd"));
                        adapter.AddParameterToSelectCommand("@OrderID", OrderID);

                        int res = adapter.ExecuteSql();
                        if (res > 0)
                            bResult = true;
                    }
                }
            }
            catch (Exception error)
            {
                string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();
                basePage.SaveErrorLog("LightDAC.UpdateChargeLog_QnLight_ty：\r\n" + detailedError);
            }

            return bResult;
        }


        #region －－ 關聖帝君聖誕 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 關聖帝君聖誕 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="emperorguanshenglist">回傳活動陣列（如「TYEG1001」）</param>
        /// <param name="EmperorGuanshenglist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateEmperorGuansheng_ty_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] emperorguanshenglist,
            ref string[] EmperorGuanshenglist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..EmperorGuansheng_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT EmperorGuanshengID
                                                FROM Temple_{Year}..EmperorGuansheng_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY EmperorGuanshengID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    emperorguanshenglist = new string[rowCount];
                    EmperorGuanshenglist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int EmperorGuanshengID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbEmperorGuanshengID = Convert.ToInt32(row["EmperorGuanshengID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "TYEG";
                        string numString = prefix + nextNum.ToString();

                        EmperorGuanshenglist[i] = numString;
                        emperorguanshenglist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbEmperorGuanshengID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", emperorguanshenglist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..EmperorGuansheng_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE EmperorGuanshengID = @EmperorGuanshengID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@EmperorGuanshengID", rec.EmperorGuanshengID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateEmperorGuansheng_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 代燒金紙 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 代燒金紙 - 進寶財神廟
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="bpolist">回傳活動陣列（如「BPO1001」）</param>
        /// <param name="BPOlist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateBPO_jb_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] bpolist,
            ref string[] BPOlist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..BPO_jb_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT BPOID
                                                FROM Temple_{Year}..BPO_jb_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY BPOID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    bpolist = new string[rowCount];
                    BPOlist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int BPOID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbBPOID = Convert.ToInt32(row["BPOID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "BPO";
                        string numString = prefix + nextNum.ToString();

                        BPOlist[i] = numString;
                        bpolist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbBPOID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", bpolist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..BPO_jb_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE BPOID = @BPOID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@BPOID", rec.BPOID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateBPO_jb_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 靈寶禮斗 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 靈寶禮斗 - 玉敕大樹朝天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="lingbaolidoulist">回傳活動陣列（如「MALB1001」）</param>
        /// <param name="Lingbaolidoulist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLingbaolidou_ma_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] lingbaolidoulist,
            ref string[] Lingbaolidoulist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Lingbaolidou_ma_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LingbaolidouID
                                                FROM Temple_{Year}..Lingbaolidou_ma_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LingbaolidouID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lingbaolidoulist = new string[rowCount];
                    Lingbaolidoulist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LingbaolidouID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLingbaolidouID = Convert.ToInt32(row["LingbaolidouID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "MALB";
                        string numString = prefix + nextNum.ToString();

                        Lingbaolidoulist[i] = numString;
                        lingbaolidoulist[i] = $"靈寶禮斗:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLingbaolidouID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lingbaolidoulist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lingbaolidou_ma_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LingbaolidouID = @LingbaolidouID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LingbaolidouID", rec.LingbaolidouID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLingbaolidou_ma_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 七朝清醮 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 七朝清醮 - 大甲鎮瀾宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="taoistJiaoceremonylist">回傳活動陣列（如「DATJC1001」）</param>
        /// <param name="TaoistJiaoCeremonylist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateTaoistJiaoCeremony_da_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] taoistJiaoceremonylist,
            ref string[] TaoistJiaoCeremonylist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..TaoistJiaoCeremony_da_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT TaoistJiaoCeremonyID
                                                FROM Temple_{Year}..TaoistJiaoCeremony_da_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY TaoistJiaoCeremonyID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    taoistJiaoceremonylist = new string[rowCount];
                    TaoistJiaoCeremonylist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int TaoistJiaoCeremonyID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbTaoistJiaoCeremonyID = Convert.ToInt32(row["TaoistJiaoCeremonyID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 固定前綴
                        string prefix = "DATJC";
                        string numString = prefix + nextNum.ToString();

                        TaoistJiaoCeremonylist[i] = numString;
                        taoistJiaoceremonylist[i] = $"{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbTaoistJiaoCeremonyID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", taoistJiaoceremonylist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..TaoistJiaoCeremony_da_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE TaoistJiaoCeremonyID = @TaoistJiaoCeremonyID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@TaoistJiaoCeremonyID", rec.TaoistJiaoCeremonyID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateTaoistJiaoCeremony_da_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 護國息災梁皇大法會 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單資料 - 護國息災梁皇大法會 - 台東東海龍門天聖宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LybcType">
        /// 活動代碼：
        /// 1－財寶袋;2－普度供桌;3－福慧水晶燈；4－重建募款-伍佰；5－重建募款-壹仟；6－重建募款-貳仟；
        /// </param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="lybclist">回傳活動陣列（如「財寶袋:DHTB1001」）</param>
        /// <param name="Lybclist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLybc_dh_Info(
            int applicantID,
            int LybcType,
            string Year,
            ref string msg,
            ref string[] lybclist,
            ref string[] Lybclist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LybcType, Num
                                                FROM Temple_{Year}..Lybc_dh_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LybcType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LybcID, LybcType
                                                FROM Temple_{Year}..Lybc_dh_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LybcID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lybclist = new string[rowCount];
                    Lybclist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LybcID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLybcID = Convert.ToInt32(row["LybcID"]);
                        int dbLybcType = Convert.ToInt32(row["LybcType"]);

                        if (!usedNumsByType.ContainsKey(dbLybcType))
                            usedNumsByType[dbLybcType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLybcType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據活動代碼決定前綴字串
                        string prefix = "";
                        switch (dbLybcType)
                        {
                            case 1: prefix = "DHTB"; break;     // 財寶袋 → 「DHTB####」
                            case 2: prefix = "DHP"; break;      // 普度供桌 → 「DHP####」
                            case 3: prefix = "DHBW"; break;     // 福慧水晶燈 → 「DHBW####」
                            case 4: prefix = "DH5RF"; break;    // 重建募款-伍佰 → 「DH5RF####」
                            case 5: prefix = "DH10RF"; break;   // 重建募款-壹仟 → 「DH10RF####」
                            case 6: prefix = "DH20RF"; break;   // 重建募款-貳仟 → 「DH20RF####」
                        }

                        string numString = prefix + nextNum.ToString();
                        Lybclist[i] = numString;

                        // 組成要返回前端的「活動名稱:編號」
                        string typeName = "";
                        switch (dbLybcType)
                        {
                            case 1: typeName = "財寶袋"; break;
                            case 2: typeName = "普度供桌"; break;
                            case 3: typeName = "福慧水晶燈"; break;
                            case 4: typeName = "重建募款-伍佰"; break;
                            case 5: typeName = "重建募款-壹仟"; break;
                            case 6: typeName = "重建募款-貳仟"; break;
                        }

                        lybclist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLybcID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lybclist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lybc_dh_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LybcID = @LybcID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LybcID", rec.LybcID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLybc_dh_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 供花供果 訂單編號更新 －－

        /// <summary>
        /// 更新並取得訂單編號資料 - 供花供果 - 台灣道教總廟無極三清總道院
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="HuaguoType">
        /// 活動代碼：
        /// 1－供花/次;2－供果/次;3－供花/月；4－供果/月；5－供花/半年；6－供果/半年
        /// </param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="huaguolist">回傳活動陣列（如「供花/次:WJSH1001」）</param>
        /// <param name="Huaguolist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateHuaguo_wjsan_Info(
            int applicantID,
            int HuaguoType,
            string Year,
            ref string msg,
            ref string[] huaguolist,
            ref string[] Huaguolist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT HuaguoType, Num
                                                FROM Temple_{Year}..Huaguo_wjsan_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["HuaguoType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT HuaguoID, HuaguoType
                                                FROM Temple_{Year}..Huaguo_wjsan_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY HuaguoID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    huaguolist = new string[rowCount];
                    Huaguolist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int HuaguoID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbHuaguoID = Convert.ToInt32(row["HuaguoID"]);
                        int dbHuaguoType = Convert.ToInt32(row["HuaguoType"]);

                        if (!usedNumsByType.ContainsKey(dbHuaguoType))
                            usedNumsByType[dbHuaguoType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbHuaguoType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據活動代碼決定前綴字串
                        string prefix = "";
                        switch (dbHuaguoType)
                        {
                            case 1: prefix = "WJSH"; break;  // 供花/次
                            case 2: prefix = "WJSG"; break;  // 供果/次
                            case 3: prefix = "WJS3H"; break;  // 供花/月
                            case 4: prefix = "WJS3G"; break;  // 供果/月
                            case 5: prefix = "WJS18H"; break;  // 供花/半年
                            case 6: prefix = "WJS18G"; break;  // 供果/半年
                        }

                        string numString = prefix + nextNum.ToString();
                        Huaguolist[i] = numString;

                        // 組成要返回前端的「活動名稱:編號」
                        string typeName = "";
                        switch (dbHuaguoType)
                        {
                            case 1: typeName = "供花/次"; break;
                            case 2: typeName = "供果/次"; break;
                            case 3: typeName = "供花/月"; break;
                            case 4: typeName = "供果/月"; break;
                            case 5: typeName = "供花/半年"; break;
                            case 6: typeName = "供果/半年"; break;
                        }

                        huaguolist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbHuaguoID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", huaguolist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Huaguo_wjsan_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE HuaguoID = @HuaguoID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@HuaguoID", rec.HuaguoID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateHuaguo_wjsan_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 孝親祈福感恩活動 訂單編號更新 －－

        /// <summary>
        /// 更新並取得燈號資料 - 孝親祈福感恩活動 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="LightsType">燈種代碼</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（燈種＋編號＋客服電話）</param>
        /// <param name="lightslist">回傳燈號陣列（如「光明燈:光05001」）</param>
        /// <param name="Lightslist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateLights_ty_mom_Info(
            int applicantID,
            int LightsType,
            string Year,
            ref string msg,
            ref string[] lightslist,
            ref string[] Lightslist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT LightsType, Num
                                                FROM Temple_{Year}..Lights_ty_mom_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["LightsType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT LightsID, LightsType
                                                FROM Temple_{Year}..Lights_ty_mom_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY LightsID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    lightslist = new string[rowCount];
                    Lightslist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int LightsID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbLightsID = Convert.ToInt32(row["LightsID"]);
                        int dbLightsType = Convert.ToInt32(row["LightsType"]);

                        if (!usedNumsByType.ContainsKey(dbLightsType))
                            usedNumsByType[dbLightsType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbLightsType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據燈種決定前綴字串
                        string prefix = "";
                        switch (dbLightsType)
                        {
                            case 21: prefix = "TYM"; break;  // 孝親祈福燈
                        }

                        string numString = prefix + nextNum.ToString();
                        Lightslist[i] = numString;

                        // 組成要返回前端的「燈種:編號」
                        string typeName = "";
                        switch (dbLightsType)
                        {
                            case 21: typeName = "孝親祈福燈"; break;
                        }

                        lightslist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbLightsID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", lightslist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Lights_ty_mom_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE LightsID = @LightsID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@LightsID", rec.LightsID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateLights_ty_mom_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 祈安植福 訂單編號更新 －－

        /// <summary>
        /// 更新並取得祈安植福資料 - 祈安植福 - 松柏嶺受天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="blessinglist">回傳活動陣列（如「祈安植福:STBL1001」）</param>
        /// <param name="Blessinglist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateBlessing_st_Info(
            int applicantID,
            string Year,
            ref string msg,
            ref string[] blessinglist,
            ref string[] Blessinglist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT Num
                                                FROM Temple_{Year}..Blessing_st_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立已用號碼集合
                    HashSet<int> usedNums = new HashSet<int>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                            usedNums.Add(Convert.ToInt32(row["Num"]));
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT BlessingID
                                                FROM Temple_{Year}..Blessing_st_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY BlessingID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    blessinglist = new string[rowCount];
                    Blessinglist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int BlessingID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbBlessingID = Convert.ToInt32(row["BlessingID"]);

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        while (usedNums.Contains(nextNum))
                            nextNum++;

                        // 祈安植福的固定前綴
                        string prefix = "STBL";
                        string numString = prefix + nextNum.ToString();

                        Blessinglist[i] = numString;
                        blessinglist[i] = $"祈安植福:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbBlessingID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedNums.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", blessinglist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..Blessing_st_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE BlessingID = @BlessingID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@BlessingID", rec.BlessingID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateBlessing_st_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #region －－ 千手觀音千燈迎佛法會 訂單編號更新 －－

        /// <summary>
        /// 更新並取得燈號資料 - 千手觀音千燈迎佛法會 - 桃園威天宮
        /// </summary>
        /// <param name="applicantID">購買人編號</param>
        /// <param name="QnLightType">
        /// 活動代碼：
        /// 1－蓮花燈;2－八吉祥燈;3－闔家甘露燈；4－藥師琉璃燈；5－八吉祥花；
        /// </param>
        /// <param name="Year">資料庫年度</param>
        /// <param name="msg">回傳訊息（活動名稱＋編號＋客服電話）</param>
        /// <param name="qnlightlist">回傳活動陣列（如「蓮花燈:QNLH1001」）</param>
        /// <param name="QnLightlist">備用字串陣列</param>
        /// <returns>true 表示補號成功；否則 false</returns>
        public bool UpdateQnLight_ty_Info(
            int applicantID,
            int QnLightType,
            string Year,
            ref string msg,
            ref string[] qnlightlist,
            ref string[] QnLightlist)
        {
            lock (_thisLock)
            {
                bool bResult = false;
                twbobibobi.Data.BasePage basePage = new twbobibobi.Data.BasePage();

                try
                {
                    // --------------------------------------------------------------------------------------
                    // 1. 一次性取得所有已分配的編號 (Num > 0 且 Num2String 有值)
                    // --------------------------------------------------------------------------------------
                    string sqlFetchExisting = $@"
                                                SELECT QnLightType, Num
                                                FROM Temple_{Year}..QnLight_ty_info
                                                WHERE Status = 0
                                                  AND Num <> 0
                                                  AND Num2String IS NOT NULL
                                                  AND Num2String <> ''
                                            ";

                    // 建立各燈種對應的已用號碼集合
                    Dictionary<int, HashSet<int>> usedNumsByType = new Dictionary<int, HashSet<int>>();
                    using (DatabaseAdapter da = new DatabaseAdapter(sqlFetchExisting, this.DBSource))
                    {
                        DataTable dtExisting = new DataTable();
                        da.Fill(dtExisting);

                        foreach (DataRow row in dtExisting.Rows)
                        {
                            int type = Convert.ToInt32(row["QnLightType"]);
                            int num = Convert.ToInt32(row["Num"]);

                            if (!usedNumsByType.ContainsKey(type))
                                usedNumsByType[type] = new HashSet<int>();

                            usedNumsByType[type].Add(num);
                        }
                    }

                    // --------------------------------------------------------------------------------------
                    // 2. 找出所有 Num = 0 的燈種，需要補號
                    // --------------------------------------------------------------------------------------
                    string sqlFetchToAssign = $@"
                                                SELECT QnLightID, QnLightType
                                                FROM Temple_{Year}..QnLight_ty_info
                                                WHERE ApplicantID = @ApplicantID
                                                  AND Status = 0
                                                  AND Num = 0
                                                ORDER BY QnLightID
                                            ";

                    DataTable dtToAssign = new DataTable();
                    using (DatabaseAdapter daAssign = new DatabaseAdapter(sqlFetchToAssign, this.DBSource))
                    {
                        daAssign.AddParameterToSelectCommand("@ApplicantID", applicantID);
                        daAssign.Fill(dtToAssign);
                    }

                    int rowCount = dtToAssign.Rows.Count;
                    if (rowCount == 0)
                        return false;

                    qnlightlist = new string[rowCount];
                    QnLightlist = new string[rowCount];

                    // 暫存待更新資料
                    List<(int QnLightID, int Num, string NumString)> updatedRecords =
                        new List<(int, int, string)>();

                    // --------------------------------------------------------------------------------------
                    // 3. 分配最小可用號碼
                    // --------------------------------------------------------------------------------------
                    for (int i = 0; i < rowCount; i++)
                    {
                        DataRow row = dtToAssign.Rows[i];
                        int dbQnLightID = Convert.ToInt32(row["QnLightID"]);
                        int dbQnLightType = Convert.ToInt32(row["QnLightType"]);

                        if (!usedNumsByType.ContainsKey(dbQnLightType))
                            usedNumsByType[dbQnLightType] = new HashSet<int>();

                        int nextNum = 1001;

                        // 找下一個可用編號 (從 1001 開始往上搜尋)
                        var usedSet = usedNumsByType[dbQnLightType];
                        while (usedSet.Contains(nextNum))
                        {
                            nextNum++;
                        }

                        // 根據活動代碼決定前綴字串
                        string prefix = "";
                        switch (dbQnLightType)
                        {
                            case 1: prefix = "QNLH"; break;     // 蓮花燈
                            case 2: prefix = "QNBJX"; break;    // 八吉祥燈
                            case 3: prefix = "QNGL"; break;     // 闔家甘露燈
                            case 4: prefix = "QNYSL"; break;    // 藥師琉璃燈
                            case 5: prefix = "QNH"; break;      // 八吉祥花
                        }

                        string numString = prefix + nextNum.ToString();
                        QnLightlist[i] = numString;

                        // 組成要返回前端的「活動名稱:編號」
                        string typeName = "";
                        switch (dbQnLightType)
                        {
                            case 1: typeName = "蓮花燈"; break;
                            case 2: typeName = "八吉祥燈"; break;
                            case 3: typeName = "闔家甘露燈"; break;
                            case 4: typeName = "藥師琉璃燈"; break;
                            case 5: typeName = "八吉祥花"; break;
                        }

                        qnlightlist[i] = $"{typeName}:{numString}";

                        // 把這筆資料記錄到暫存待更新資料中
                        updatedRecords.Add((dbQnLightID, nextNum, numString));

                        // 把已分配的 nextNum 加入 usedNumsByType，避免重複
                        usedSet.Add(nextNum);
                    }

                    // --------------------------------------------------------------------------------------
                    // 4. 回傳訊息組裝
                    // --------------------------------------------------------------------------------------
                    msg += string.Join(",", qnlightlist) + "。客服電話：04-36092299。";

                    // --------------------------------------------------------------------------------------
                    // 5. 批次 UPDATE（安全參數化）
                    // --------------------------------------------------------------------------------------
                    foreach (var rec in updatedRecords)
                    {
                        string sqlUpdate = $@"
                                                UPDATE Temple_{Year}..QnLight_ty_info
                                                SET 
                                                    Num = @Num,
                                                    Num2String = @Num2String
                                                WHERE QnLightID = @QnLightID;
                                            ";

                        using (DatabaseAdapter daUpdate = new DatabaseAdapter(sqlUpdate, this.DBSource))
                        {
                            daUpdate.AddParameterToSelectCommand("@Num", rec.Num);
                            daUpdate.AddParameterToSelectCommand("@Num2String", rec.NumString);
                            daUpdate.AddParameterToSelectCommand("@QnLightID", rec.QnLightID);

                            int res = daUpdate.ExecuteSql();
                            if (res > 0)
                                bResult = true;
                        }
                    }
                }
                catch (Exception error)
                {
                    string detailedError = ErrorLogger.FormatError(error, typeof(LightDAC).FullName);
                    basePage.SaveErrorLog("LightDAC.UpdateQnLight_ty_Info：\r\n" + detailedError);
                }

                return bResult;
            }
        }

        #endregion

        #endregion

        #endregion


        //==================================================
        #region 刪除 (Delete)
        //==================================================

        #endregion
    }
}